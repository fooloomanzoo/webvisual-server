<script>
  window.WebvisualBehaviors = window.WebvisualBehaviors || {};

    /**
     * Behavior that adds fullscrren behavior
     *
     * @polymerBehavior
     */

  WebvisualBehaviors.FullscreenBehavior = {

    properties: {

      fullscreen: {
        type: Boolean,
        value: false,
        reflectToAttribute: true
      }

    },

    get isFullscreen() {
      return document.fullscreen
          || document.webkitIsFullScreen
          || document.mozFullScreen
          || document.msFullscreenElement;
    },

    attached: function() {
      // fullscreen
      if (this.requestFullscreen) {
        this.exitFullscreen = document.exitFullscreen;
        this.addEventListener('fullscreenchange', this.fullScreenChanged.bind(this), false);
      } else if (this.webkitRequestFullScreen) {
        this.requestFullscreen = this.webkitRequestFullScreen;
        this.exitFullscreen = document.webkitCancelFullScreen.bind(this);
        this.addEventListener('webkitfullscreenchange', this.fullScreenChanged.bind(this), false);
      } else if (this.mozRequestFullScreen) {
        this.requestFullscreen = this.mozRequestFullScreen;
        this.exitFullscreen = document.mozCancelFullScreen.bind(this);
        this.addEventListener('mozfullscreenchange', this.fullScreenChanged.bind(this), false);
      } else if (this.msRequestFullscreen) {
        this.requestFullscreen = this.msRequestFullscreen;
        this.exitFullscreen = document.msExitFullscreen.bind(this);
        this.addEventListener('msfullscreenchange', this.fullScreenChanged.bind(this), false);
      }
    },

    detached: function() {
      this.removeEventListener('fullscreenchange', this.fullScreenChanged.bind(this), false);
      this.removeEventListener('webkitfullscreenchange', this.fullScreenChanged.bind(this), false);
      this.removeEventListener('mozfullscreenchange', this.fullScreenChanged.bind(this), false);
      this.removeEventListener('msfullscreenchange', this.fullScreenChanged.bind(this), false);
    },

    toggleFullscreen: function(e) {
      e.stopPropagation()
      if (this.isFullscreen) {
        this.exitFullscreen();
      }
      this.requestFullscreen();
    },

    fullScreenChanged: function() {
      requestAnimationFrame( function() {
        if (this.isFullscreen) {
          this.fullscreen = true;
          this.style.position = 'absolute';
          this.style.top = '0';
          this.style.left = '0';
          this.style.right = '0';
          this.style.bottom = '0';
          this.style['border-radius'] = '0px';
          document.body.style.overflow = 'hidden';
        } else {
          this.fullscreen = false;
          this.style.position = '';
          this.style.top = '';
          this.style.left = '';
          this.style.right = '';
          this.style.bottom = '';
          this.style['border-radius'] = '';
          document.body.style.overflow = '';
        }
      }.bind(this));
    },

    computeFullscreenIcon: function(fullscreen) {
      return fullscreen ? 'fullscreen-exit' : 'fullscreen';
    }
  };
</script>
