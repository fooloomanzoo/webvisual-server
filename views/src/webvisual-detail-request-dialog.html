<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">

<link rel="import" href="style/webvisual-dialog-styles.html">

<link rel="import" href="style/webvisual-button.html">

<link rel="import" href="components/webvisual-icon-button.html"/>

<link rel="import" href="webvisual-element-caption.html"/>
<link rel="import" href="webvisual-element-chart.html"/>

<link rel="import" href="../bower_components/datetime-picker/datetime-picker.html">

<dom-module id="webvisual-detail-request-dialog">
  <template>
    <style include="webvisual-dialog-styles webvisual-button">
      :host {
        height: 100%;
        width: 100%;
        --caption-background: transparent;
        --caption-color: currentColor;
      }
      webvisual-element-caption {
        align-items: baseline;
      }
      datetime-picker {
        --datetime-picker-input: {
          padding: 0.5em 0.1em;
          width: 50%;
          text-align: center;
          border: none;
          outline: none;
          border-bottom: thin solid currentColor;
        }
      }
      #chart {
        color: inherit;
      }
      #bottom {
        font-size: 0.9em;
      }
      .webvisual-button {
        flex: 0;
      }
      #exitButton {
        position: absolute;
        right: 0;
        top: 0;
        margin: 0.5em;
      }
      #dates {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      #dates > * {
        margin: 0 0.25em;
      }
    </style>

    <div id="title">
      <webvisual-element-caption keys="[[item.keys]]"></webvisual-element-caption>
    </div>

    <webvisual-icon-button id="exitButton" icon="close" on-tap="close"></webvisual-icon-button>

    <div id="content">
      <webvisual-element-chart id="chart" opened="[[opened]]" item="[[item]]" no-link></webvisual-element-chart>
    </div>

    <section id="bottom">
      <div id="dates">
        <span>From: </span>
        <datetime-picker id="dateFrom" value="{{fromDate}}" date-string="{{_minDate}}" max-date="[[_maxDate]]"></datetime-picker>
        <span>To: </span>
        <datetime-picker id="dateTo" value="{{toDate}}" date-string="{{_maxDate}}" min-date="[[_minDate]]"></datetime-picker>
      </div>

      <div class="webvisual-button" on-tap="requestFromSocket">
        <paper-ripple></paper-ripple>
        <iron-icon class="left" icon="juelich:logo"></iron-icon>
        <span>Request</span>
      </div>
    </section>
  </template>

</dom-module>

<script>
(function() {
  Polymer({
    is: 'webvisual-detail-request-dialog',

    behaviors: [
      Polymer.PaperDialogBehavior
    ],

    properties: {

      item: {
        type: Object,
        value: function() {
          return {};
        }
      },

      opened: {
        type: Boolean,
        reflectToAttribute: true
      },

      fromDate: {
        type: Number,
        value: +(new Date() - 3600000)
      },

      toDate: {
        type: Number,
        value: +(new Date())
      },

    },

    listeners: {
      'iron-overlay-closed': 'reset'
    },

    requestFromSocket: function() {

    },

    reset: function(e) {
      console.log(e);
    }
  });
})();
</script>
