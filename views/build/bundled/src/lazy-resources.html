<html><head></head><body><div hidden="" by-polymer-bundler=""><script>Polymer.IronSelection=function(a){this.selection=[],this.selectCallback=a},Polymer.IronSelection.prototype={get:function(){return this.multi?this.selection.slice():this.selection[0]},clear:function(a){this.selection.slice().forEach(function(b){(!a||0>a.indexOf(b))&&this.setItemSelected(b,!1)},this)},isSelected:function(a){return 0<=this.selection.indexOf(a)},setItemSelected:function(a,b){if(null!=a&&b!==this.isSelected(a)){if(b)this.selection.push(a);else{var c=this.selection.indexOf(a);0<=c&&this.selection.splice(c,1)}this.selectCallback&&this.selectCallback(a,b)}},select:function(a){this.multi?this.toggle(a):this.get()!==a&&(this.setItemSelected(this.get(),!1),this.setItemSelected(a,!0))},toggle:function(a){this.setItemSelected(a,!this.isSelected(a))}};</script><script>Polymer.IronSelectableBehavior={properties:{attrForSelected:{type:String,value:null},selected:{type:String,notify:!0},selectedItem:{type:Object,readOnly:!0,notify:!0},activateEvent:{type:String,value:'tap',observer:'_activateEventChanged'},selectable:String,selectedClass:{type:String,value:'iron-selected'},selectedAttribute:{type:String,value:null},fallbackSelection:{type:String,value:null},items:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}},_excludedLocalNames:{type:Object,value:function(){return{template:1,"dom-bind":1,"dom-if":1,"dom-repeat":1}}}},observers:['_updateAttrForSelected(attrForSelected)','_updateSelected(selected)','_checkFallback(fallbackSelection)'],created:function(){this._bindFilterItem=this._filterItem.bind(this),this._selection=new Polymer.IronSelection(this._applySelection.bind(this))},attached:function(){this._observer=this._observeItems(this),this._addListener(this.activateEvent)},detached:function(){this._observer&&Polymer.dom(this).unobserveNodes(this._observer),this._removeListener(this.activateEvent)},indexOf:function(a){return this.items.indexOf(a)},select:function(a){this.selected=a},selectPrevious:function(){var a=this.items.length,b=(+this._valueToIndex(this.selected)-1+a)%a;this.selected=this._indexToValue(b)},selectNext:function(){var a=(+this._valueToIndex(this.selected)+1)%this.items.length;this.selected=this._indexToValue(a)},selectIndex:function(a){this.select(this._indexToValue(a))},forceSynchronousItemUpdate:function(){this._observer&&'function'===typeof this._observer.flush?this._observer.flush():this._updateItems()},get _shouldUpdateSelection(){return null!=this.selected},_checkFallback:function(){this._updateSelected()},_addListener:function(a){this.listen(this,a,'_activateHandler')},_removeListener:function(a){this.unlisten(this,a,'_activateHandler')},_activateEventChanged:function(a,b){this._removeListener(b),this._addListener(a)},_updateItems:function(){var a=Polymer.dom(this).queryDistributedElements(this.selectable||'*');a=Array.prototype.filter.call(a,this._bindFilterItem),this._setItems(a)},_updateAttrForSelected:function(){this.selectedItem&&(this.selected=this._valueForItem(this.selectedItem))},_updateSelected:function(){this._selectSelected(this.selected)},_selectSelected:function(){if(this.items){var a=this._valueToItem(this.selected);a?this._selection.select(a):this._selection.clear(),this.fallbackSelection&&this.items.length&&void 0===this._selection.get()&&(this.selected=this.fallbackSelection)}},_filterItem:function(a){return!this._excludedLocalNames[a.localName]},_valueToItem:function(a){return null==a?null:this.items[this._valueToIndex(a)]},_valueToIndex:function(a){if(this.attrForSelected){for(var b,c=0;b=this.items[c];c++)if(this._valueForItem(b)==a)return c;}else return+a},_indexToValue:function(a){if(this.attrForSelected){var b=this.items[a];if(b)return this._valueForItem(b)}else return a},_valueForItem:function(a){if(!a)return null;var b=a[Polymer.CaseMap.dashToCamelCase(this.attrForSelected)];return b==void 0?a.getAttribute(this.attrForSelected):b},_applySelection:function(a,b){this.selectedClass&&this.toggleClass(this.selectedClass,b,a),this.selectedAttribute&&this.toggleAttribute(this.selectedAttribute,b,a),this._selectionChange(),this.fire('iron-'+(b?'select':'deselect'),{item:a})},_selectionChange:function(){this._setSelectedItem(this._selection.get())},_observeItems:function(a){return Polymer.dom(a).observeNodes(function(a){this._updateItems(),this._updateSelected(),this.fire('iron-items-changed',a,{bubbles:!1,cancelable:!1})})},_activateHandler:function(a){for(var b=a.target,c=this.items;b&&b!=this;){var d=c.indexOf(b);if(0<=d){var e=this._indexToValue(d);return void this._itemActivate(e,b)}b=b.parentNode}},_itemActivate:function(a,b){this.fire('iron-activate',{selected:a,item:b},{cancelable:!0}).defaultPrevented||this.select(a)}};</script><dom-module id="iron-pages" assetpath="../bower_components/iron-pages/"><template><style>:host{display:block;}:host > ::slotted(:not(.iron-selected)){display:none !important;}</style><slot></slot></template><script>Polymer({is:'iron-pages',behaviors:[Polymer.IronResizableBehavior,Polymer.IronSelectableBehavior],properties:{activateEvent:{type:String,value:null}},observers:['_selectedPageChanged(selected)'],_selectedPageChanged:function(){this.async(this.notifyResize)}});</script></dom-module><script>Polymer.IronMultiSelectableBehaviorImpl={properties:{multi:{type:Boolean,value:!1,observer:'multiChanged'},selectedValues:{type:Array,notify:!0,value:function(){return[]}},selectedItems:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}}},observers:['_updateSelected(selectedValues.splices)'],select:function(a){this.multi?this._toggleSelected(a):this.selected=a},multiChanged:function(a){this._selection.multi=a,this._updateSelected()},get _shouldUpdateSelection(){return null!=this.selected||null!=this.selectedValues&&this.selectedValues.length},_updateAttrForSelected:function(){this.multi?this.selectedItems&&0<this.selectedItems.length&&(this.selectedValues=this.selectedItems.map(function(a){return this._indexToValue(this.indexOf(a))},this).filter(function(a){return null!=a},this)):Polymer.IronSelectableBehavior._updateAttrForSelected.apply(this)},_updateSelected:function(){this.multi?this._selectMulti(this.selectedValues):this._selectSelected(this.selected)},_selectMulti:function(a){a=a||[];var b=(this._valuesToItems(a)||[]).filter(function(a){return null!==a&&a!==void 0});this._selection.clear(b);for(var c=0;c<b.length;c++)this._selection.setItemSelected(b[c],!0);if(this.fallbackSelection&&!this._selection.get().length){var d=this._valueToItem(this.fallbackSelection);d&&this.select(this.fallbackSelection)}},_selectionChange:function(){var a=this._selection.get();this.multi?(this._setSelectedItems(a),this._setSelectedItem(a.length?a[0]:null)):null!==a&&a!==void 0?(this._setSelectedItems([a]),this._setSelectedItem(a)):(this._setSelectedItems([]),this._setSelectedItem(null))},_toggleSelected:function(a){var b=this.selectedValues.indexOf(a);0>b?this.push('selectedValues',a):this.splice('selectedValues',b,1)},_valuesToItems:function(a){return null==a?null:a.map(function(a){return this._valueToItem(a)},this)}},Polymer.IronMultiSelectableBehavior=[Polymer.IronSelectableBehavior,Polymer.IronMultiSelectableBehaviorImpl];</script><script>Polymer({is:'iron-selector',behaviors:[Polymer.IronMultiSelectableBehavior]});</script><script>Polymer({is:'iron-media-query',properties:{queryMatches:{type:Boolean,value:!1,readOnly:!0,notify:!0},query:{type:String,observer:'queryChanged'},full:{type:Boolean,value:!1},_boundMQHandler:{value:function(){return this.queryHandler.bind(this)}},_mq:{value:null}},attached:function(){this.style.display='none',this.queryChanged()},detached:function(){this._remove()},_add:function(){this._mq&&this._mq.addListener(this._boundMQHandler)},_remove:function(){this._mq&&this._mq.removeListener(this._boundMQHandler),this._mq=null},queryChanged:function(){this._remove();var a=this.query;a&&(!this.full&&'('!==a[0]&&(a='('+a+')'),this._mq=window.matchMedia(a),this._add(),this.queryHandler(this._mq))},queryHandler:function(a){this._setQueryMatches(a.matches)}});</script><dom-module id="tabs-overlay" assetpath="components/"><template strip-whitespace=""><style>:host{position:absolute;display:none;pointer-events:none;opacity:0;top:0;right:0;bottom:0;left:0;transition-property:top, right, bottom, left, opacity;}:host([persistent]){display:block !important;}[hidden]{display:none !important;}</style><slot></slot></template><script>class TabsOverlay extends Polymer.Element{static get is(){return'tabs-overlay'}static get properties(){return{target:{type:Object,observer:'_targetChanged'}}}constructor(){super(),this._lastTarget=void 0,this._transitionsInFlight=[]}ready(){super.ready(),this.addEventListener('transitionend',(a)=>this._onTransitionend(a))}_targetChanged(a,b){this._transitionsInFlight.length||(this._lastTarget&&this._lastTarget.classList.remove('tabs-overlay-static-above'),this.style.display='block',this._move(b,a),this._lastTarget=this.target)}_onTransitionend(a){let b=this._transitionsInFlight.indexOf(a.propertyName);0<=b&&this._transitionsInFlight.splice(b,1),this._transitionsInFlight.length||this._moveComplete()}_moveComplete(){this._lastTarget===this.target?(this._lastTarget&&this._lastTarget.classList.add('tabs-overlay-static-above'),this.style.display='none'):(this._move(this._lastTarget,this.target),this._lastTarget=this.target)}_move(a,b){const c=a||b,d=b||a;if(!c&&!d)return;const e=a?1:0,f=b?1:0;Polymer.dom.flush();const g=this.getBoundingClientRect(),h=window.getComputedStyle(this),i=c.getBoundingClientRect(),j=d.getBoundingClientRect();if(0===j.top&&0===j.right&&0===j.bottom&&0===j.left&&0===j.width&&0===j.height)return this.style.transitionProperty='none',this.style.opacity=f,this._transitionsInFlight=[],void Polymer.Async.microTask.run(this._moveComplete.bind(this));this.style.transitionProperty='';let k=parseFloat(h.top||'0')+(i.top-g.top),l=parseFloat(h.right||'0')-(i.right-g.right),m=parseFloat(h.bottom||'0')-(i.bottom-g.bottom),n=parseFloat(h.left||'0')+(i.left-g.left);this.style.transitionDuration='0s',this.style.transitionDelay='0s';let o=[this.style.top=k+'px',this.style.right=l+'px',this.style.bottom=m+'px',this.style.left=n+'px',this.style.opacity=e+''];k+=j.top-i.top,l-=j.right-i.right,m-=j.bottom-i.bottom,n+=j.left-i.left;const p=[0.2,0.2,0.2,0.2,0.2],q=[0,0,0,0,0];i.left<j.left&&i.right<j.right?q[3]=0.1:i.left>j.left&&i.right>j.right&&(q[1]=0.1),i.top<j.top&&i.bottom<j.bottom?q[0]=0.1:i.top>j.top&&i.bottom>j.bottom&&(q[2]=0.1);const r=[k+'px',l+'px',m+'px',n+'px',f+''],s=['top','right','bottom','left','opacity'];for(let c=0;c<o.length;c++)o[c]!==r[c]&&(0===p[c]&&0===q[c]||this._transitionsInFlight.push(s[c]));setTimeout(()=>{this.style.transitionDuration=p.map((a)=>a+'s').join(', '),this.style.transitionDelay=q.map((a)=>a+'s').join(', '),this.style.top=k+'px',this.style.right=l+'px',this.style.bottom=m+'px',this.style.left=n+'px',this.style.opacity=f+''},0)}}customElements.define(TabsOverlay.is,TabsOverlay);</script></dom-module><dom-module id="tabs-container" assetpath="components/"><template strip-whitespace=""><style>:host{@apply --layout;@apply --layout-start-justified;@apply --layout-center;box-sizing:border-box;position:relative;white-space:nowrap;overflow:hidden;-webkit-overflow-scrolling:touch;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}[hidden]{display:none !important;}#container{-webkit-overflow-scrolling:touch;position:relative;height:100%;display:flex;flex-direction:row;white-space:nowrap;overflow:hidden;pointer-events:all;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}#overlay{@apply --tab-overlay;}:host([vertical]){@apply --layout-center-center;}:host([reverse]) #container{flex-direction:row-reverse;}:host([vertical]) #container{flex-direction:column;width:100%;}:host([reverse][vertical]) #container{flex-direction:column-reverse;}:host([vertical]) ::slotted(*){width:100%;}:host(:not([vertical])) ::slotted(*){height:100%;}</style><nav id="container" on-track="_onScroll"><tabs-overlay id="overlay"></tabs-overlay><slot></slot></nav></template><script>class TabsContainer extends Polymer.mixinBehaviors([Polymer.IronMultiSelectableBehavior],Polymer.Element){static get is(){return'tabs-container'}static get properties(){return{vertical:{type:Boolean,value:!1,reflectToAttribute:!0},multi:{type:Boolean,value:!1}}}static get observers(){return['_onSelectedItemChanged(selectedItem)']}connectedCallback(){super.connectedCallback(),this._addScrollListeners()}_addScrollListeners(){this.$.container.addEventListener('scroll',(a)=>this._onScroll(a),{passive:!0}),this.$.container.addEventListener('wheel',(a)=>this._onWheel(a),{passive:!0})}_onSelectedItemChanged(a){a&&(!this.multi&&(this.$.overlay.target=a),setTimeout(()=>{this.vertical?this.$.container.scrollTop=a.offsetTop-this.$.container.offsetTop-this.$.container.clientHeight/2+a.clientHeight/2:this.$.container.scrollLeft=a.offsetLeft-this.$.container.offsetLeft-this.$.container.clientWidth/2+a.clientWidth/2},0))}_onWheel(a){if(!a)return;let b,c;switch(a.deltaMode){case 0:c=0.2;break;case 1:c=20;break;case 2:c=this.$.container.offsetHeight;break;default:c=1;}this.vertical?(b=a.deltaY||0,this.$.container.scrollTop+=b*c):(b=a.deltaX||0,this.$.container.scrollLeft+=b*c)}_onScroll(a,b){a.stopImmediatePropagation();let c;this.vertical?(c=b&&-b.ddy||0,this.$.container.scrollTop+=c):(c=b&&-b.ddx||0,this.$.container.scrollLeft+=c)}reset(){this.set('selectedItem',null),this.set('selectedItems',[]),this.set('selectedValues',[])}}customElements.define(TabsContainer.is,TabsContainer);</script></dom-module><script>Polymer.PaperRippleBehavior={properties:{noink:{type:Boolean,observer:'_noinkChanged'},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(a){Polymer.IronButtonStateImpl._downHandler.call(this,a),this.pressed&&this.ensureRipple(a)},ensureRipple:function(a){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var b=this._rippleContainer||this.root;if(b&&Polymer.dom(b).appendChild(this._ripple),a){var c=Polymer.dom(this._rippleContainer||this),d=Polymer.dom(a).rootTarget;c.deepContains(d)&&this._ripple.uiDownAction(a)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return!!this._ripple},_createRipple:function(){return document.createElement('paper-ripple')},_noinkChanged:function(a){this.hasRipple()&&(this._ripple.noink=a)}};</script><dom-module id="ripple-container" assetpath="components/"><template strip-whitespace=""><style>:host{display:inline-block;position:relative;}paper-ripple{color:var(--highlight-color, currentColor);}</style><slot></slot></template><script>class RippleContainer extends Polymer.mixinBehaviors([Polymer.PaperRippleBehavior],Polymer.Element){static get is(){return'ripple-container'}constructor(){super(),this._isDown=!1}ready(){super.ready(),this.addEventListener('focus',(a)=>this._onFocus(a),!0),this.addEventListener('blur',(a)=>this._onBlur(a),!0),this.addEventListener('down',(a)=>this._rippleDown(a)),this.addEventListener('up',(a)=>this._rippleUp(a))}_onFocus(a){this._isDown||this._rippleDown(a)}_onBlur(a){this._rippleUp(a)}_rippleDown(a){this._isDown=!0,this.getRipple().downAction(a)}_rippleUp(a){this._isDown=!1,this.getRipple().upAction(a)}}customElements.define(RippleContainer.is,RippleContainer);</script></dom-module><dom-module id="tab-element" assetpath="components/"><template strip-whitespace=""><style>:host{display:inline-block;position:relative;cursor:pointer;}[hidden]{display:none !important;}#overlay{pointer-events:none;display:none;position:absolute;top:0;right:0;bottom:0;left:0;@apply --tab-overlay;}#container{height:100%;width:100%;position:relative;}:host(.tabs-overlay-static-above) #overlay{display:block;}</style><div id="overlay"></div><ripple-container id="container"><slot></slot></ripple-container></template><script>class TabElement extends Polymer.Element{static get is(){return'tab-element'}}customElements.define(TabElement.is,TabElement);</script></dom-module><dom-module id="iron-collapse" assetpath="../bower_components/iron-collapse/"><template><style>:host{display:block;transition-duration:var(--iron-collapse-transition-duration, 300ms);-webkit-transition-duration:var(--iron-collapse-transition-duration, 300ms);overflow:visible;}:host(.iron-collapse-closed){display:none;}:host(:not(.iron-collapse-opened)){overflow:hidden;}</style><slot></slot></template></dom-module><script>Polymer({is:'iron-collapse',behaviors:[Polymer.IronResizableBehavior],properties:{horizontal:{type:Boolean,value:!1,observer:'_horizontalChanged'},opened:{type:Boolean,value:!1,notify:!0,observer:'_openedChanged'},transitioning:{type:Boolean,notify:!0,readOnly:!0},noAnimation:{type:Boolean},_desiredSize:{type:String,value:''}},get dimension(){return this.horizontal?'width':'height'},get _dimensionMax(){return this.horizontal?'maxWidth':'maxHeight'},get _dimensionMaxCss(){return this.horizontal?'max-width':'max-height'},hostAttributes:{role:'group',"aria-hidden":'true',"aria-expanded":'false'},listeners:{transitionend:'_onTransitionEnd'},toggle:function(){this.opened=!this.opened},show:function(){this.opened=!0},hide:function(){this.opened=!1},updateSize:function(a,b){a='auto'===a?'':a;var c=b&&!this.noAnimation&&this.isAttached&&this._desiredSize!==a;if(this._desiredSize=a,this._updateTransition(!1),c){var d=this._calcSize();''===a&&(this.style[this._dimensionMax]='',a=this._calcSize()),this.style[this._dimensionMax]=d,this.scrollTop=this.scrollTop,this._updateTransition(!0),c=a!==d}this.style[this._dimensionMax]=a,c||this._transitionEnd()},enableTransition:function(a){Polymer.Base._warn('`enableTransition()` is deprecated, use `noAnimation` instead.'),this.noAnimation=!a},_updateTransition:function(a){this.style.transitionDuration=a&&!this.noAnimation?'':'0s'},_horizontalChanged:function(){this.style.transitionProperty=this._dimensionMaxCss;var a='maxWidth'===this._dimensionMax?'maxHeight':'maxWidth';this.style[a]='',this.updateSize(this.opened?'auto':'0px',!1)},_openedChanged:function(){this.setAttribute('aria-expanded',this.opened),this.setAttribute('aria-hidden',!this.opened),this._setTransitioning(!0),this.toggleClass('iron-collapse-closed',!1),this.toggleClass('iron-collapse-opened',!1),this.updateSize(this.opened?'auto':'0px',!0),this.opened&&this.focus()},_transitionEnd:function(){this.style[this._dimensionMax]=this._desiredSize,this.toggleClass('iron-collapse-closed',!this.opened),this.toggleClass('iron-collapse-opened',this.opened),this._updateTransition(!1),this.notifyResize(),this._setTransitioning(!1)},_onTransitionEnd:function(a){Polymer.dom(a).rootTarget===this&&this._transitionEnd()},_calcSize:function(){return this.getBoundingClientRect()[this.dimension]+'px'}});</script><dom-module id="collapse-button" assetpath="components/"><template strip-whitespace=""><style include="button-style">:host{display:block;}.content{display:flex;box-sizing:border-box;@apply --collapse-content;}:host([horizontal]) .content{flex-direction:row;}:host(:not([horizontal])) .content{flex-direction:column;}:host([horizontal]) .button,
      :host([horizontal]) ::slotted(*){height:100%;}:host(:not([horizontal])) .button,
      :host(:not([horizontal])) ::slotted(*){width:100%;}::slotted(*){box-sizing:border-box;font-size:0.8em;}[hidden]{display:hidden !important;}</style><div class="button" on-click="toggle"><paper-ripple id="ink" recenters=""></paper-ripple><iron-icon class="left" icon="[[icon]]" hidden$="[[!icon]]"></iron-icon><span>[[title]]</span><iron-icon class="right" icon="[[_expandIcon]]"></iron-icon></div><iron-collapse opened$="[[opened]]"><div class="content"><slot></slot></div></iron-collapse></template><script>class CollapseElement extends Polymer.Element{static get is(){return'collapse-button'}static get properties(){return{opened:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},horizontal:{type:Boolean,value:!1,reflectToAttribute:!0},title:{type:String},icon:{type:String},_expandIcon:{type:String,computed:'_computeExpandIcon(opened)'}}}_computeExpandIcon(a){return a?'expand-less':'expand-more'}open(){this.opened=!0}close(){this.opened=!1}toggle(){this.opened=!this.opened}}customElements.define(CollapseElement.is,CollapseElement);</script></dom-module><dom-module id="toggle-button" assetpath="components/"><template strip-whitespace=""><style>:host{@apply --layout-inline;@apply --layout-start-justified;@apply --layout-center;position:relative;outline:none;margin:0em;box-sizing:border-box;text-align:center;float:left;clear:both;padding:0.75em 1.5em;cursor:pointer;}:host([disabled]){pointer-events:none;}.bar{position:absolute;height:100%;width:100%;border-radius:0.5em;pointer-events:none;opacity:0.75;transition:background-color linear 100ms;background-color:var(--toggle-button-unchecked-bar-color, #000000);@apply --toggle-button-unchecked-bar);}.button{position:absolute;top:-0.125em;left:0;height:1.25em;width:1.25em;border-radius:50%;box-shadow:0 1px 5px 0 rgba(0, 0, 0, 0.6);transition:-webkit-transform linear 100ms, background-color linear 100ms;transition:transform linear 100ms, background-color linear 100ms;will-change:transform;background-color:var(--toggle-button-unchecked-button-color, --paper-grey-50);@apply --toggle-button-unchecked-button;}.button.dragging{-webkit-transition:none;transition:none;}:host([checked]:not([disabled])) .bar{opacity:0.5;background-color:var(--toggle-button-checked-bar-color, --primary-color);@apply --toggle-button-checked-bar;}:host([disabled]) .bar{background-color:#000;opacity:0.2;}:host([checked]) .button{-webkit-transform:translate(1.25em, 0);transform:translate(1.25em, 0);}:host([checked]:not([disabled])) .button{background-color:var(--toggle-button-checked-button-color, --primary-color);@apply --toggle-button-checked-button;}:host([disabled]) .button{background-color:var(--disabled-text-color);opacity:1;}#ink{position:absolute;top:-1.125em;left:-1.125em;right:auto;bottom:auto;width:3.5em;height:3.5em;opacity:0.8;pointer-events:none;color:var(--toggle-button-unchecked-ink-color, --primary-text-color);}:host([checked]) #ink{color:var(--toggle-button-checked-ink-color, --primary-color);}.container{display:inline-block;position:relative;width:2.5em;height:1em;margin:0.25em 1px;}.content{position:relative;display:inline-block;vertical-align:middle;padding-left:0.75em;pointer-events:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:inherit;}::slotted(iron-icon){margin-right:0.75em;}[hidden]{display:none !important;}</style><slot name="icon"></slot><section class="container"><paper-ripple id="ink" class="circle"></paper-ripple><section id="toggleBar" class="bar"></section><section id="toggleButton" class="button"></section></section><section class="content"><slot></slot></section></template><script>class ToggleButton extends Polymer.Element{static get is(){return'toggle-button'}static get properties(){return{checked:{type:Boolean,notify:!0,reflectToAttribute:!0},role:{type:String,reflectToAttribute:!0,readOnly:!0,value:'button'},tabindex:{type:Number,reflectToAttribute:!0,value:0}}}connectedCallback(){super.connectedCallback(),Polymer.Gestures.addListener(this,'tap',(a)=>this._onclicked(a)),Polymer.Gestures.addListener(this,'track',(a)=>this._ontrack(a))}disconnectedCallback(){super.disconnectedCallback(),Polymer.Gestures.removeListener(this,'tap',(a)=>this._onclicked(a)),Polymer.Gestures.removeListener(this,'track',(a)=>this._ontrack(a))}_ontrack(a){const b=a.detail;'start'===b.state?this._trackStart(b):'track'===b.state?this._trackMove(b):'end'===b.state&&this._trackEnd(b)}_trackStart(){this._width=this.$.toggleBar.offsetWidth/2,this._trackChecked=this.checked,this.$.toggleButton.classList.add('dragging')}_trackMove(a){const b=a.dx;this._x=Math.min(this._width,Math.max(0,this._trackChecked?this._width+b:b)),this.translate3d(this._x+'px',0,0,this.$.toggleButton)}_trackEnd(){this.$.toggleButton.classList.remove('dragging'),this.transform('',this.$.toggleButton)}_onclicked(){this.checked=!this.checked}}customElements.define(ToggleButton.is,ToggleButton);</script></dom-module><script>function WebvisualClient(){this.nodes=new Map,this.mobile=this._testMobile(),this.locationHost='',this.nameSpace='',this.socketRoom='',this.messageId=0,this.messageMap={},this.forcedRequests=[]}WebvisualClient.prototype={createSocketConnection:function(a,b){a&&(this.locationHost!==a||this.nameSpace!==b)&&(this.locationHost=a,this.nameSpace=b,!this.webworker&&(this.webworker=new Worker('/scripts/worker.js'),this.webworker.onmessage=function(a){if(a.data){if(a.data.messageId){const b=this.messageMap[a.data.messageId];if(b)return b(a.data.response),void delete this.messageMap[a.data.messageId]}switch(a.data.type){case'initial':this.resetNodes(),this.updateNodes(a.data.values,a.data.splices);for(let a=0;a<this.forcedRequests.length;a++)this.webworker.postMessage(this.forcedRequests[a]);this.forcedRequests.length=0;break;case'update':this.updateNodes(a.data.values,a.data.splices);break;case'status':this.updateStatus(a.data.status);break;case'reload':this.reloadJob&&(clearTimeout(this.reloadJob),this.reloadJob=null),this.reloadJob=setTimeout(()=>{window.location.reload()},1500);}}}.bind(this)),this.webworker.postMessage({target:'socket',operation:'connect',args:{locationHost:this.locationHost,nameSpace:this.nameSpace}}))},setupConnection:function(a){if(a){if(this.socketRoom=a,!this.webworker)return;this.webworker.postMessage({target:'socket',operation:'setup',args:{socketRoom:this.socketRoom,mobile:this.mobile}})}},disconnect:function(){this.webworker&&this.webworker.postMessage({target:'socket',operation:'disconnect'})},assignConnector:function(a){this.connector=a},request:function(a,b){this.messageId++,this.messageMap[this.messageId]=b,a.args=a.args||{},a.args.messageId=this.messageId,this.webworker?this.webworker.postMessage(a):a.forced&&this.forcedRequests.push(a)},updateStatus:function(a){this.connector&&'sync-disabled'!==this.connector.socketStatus&&this.connector.set('socketStatus',a)},assignElement:function(a){const b=a.item.mount;b&&(!this.nodes.has(b)&&this.nodes.set(b,new Set),this.nodes.get(b).add(a))},retractElement:function(a,b){if(a&&b&&b.mount){const c=b.mount;this.nodes.has(c)&&this.nodes.get(c).delete(a)}},updateNodes:function(a,b){setTimeout(()=>{for(const c in a)this.nodes.has(c)&&this.nodes.get(c).forEach(function(d){d.spliceValues(b[c]),d.insertValues(a[c])}),delete b[c]},0)},resetNodes:function(){},_testMobile:function(){const a=window.navigator.userAgent;return /[mM]obi/i.test(a)||/[tT]ablet/i.test(a)||/[aA]ndroid/i.test(a)}},window.Webvisual=new WebvisualClient;</script><dom-module id="socket-connnector" assetpath="data/"><script>class SocketConnector extends WebvisualMixins.AccessibilityMixin(Polymer.Element){static get is(){return'socket-connector'}static get properties(){return{locationHost:{type:String,value:window.location.origin},nameSpace:{type:String},socketRoom:{type:String,observer:'connect'},socketStatus:{type:String,notify:!0}}}_load(){super._load();this.offline||!this.loggedIn||'sync-disabled'!==this.socketStatus&&this._createSocketConnection(this.locationHost,this.nameSpace)}_createSocketConnection(a,b){a&&'sync-disabled'!==this.socketStatus&&Webvisual&&(Webvisual.assignConnector(this),Webvisual.createSocketConnection(a,b),this.socketRoom&&this.connect(this.socketRoom))}connect(a){return a?void('/'===a.substring(0,1)&&(a=a.slice(1,a.length)),this.socketStatus='connect',Webvisual.setupConnection(a)):void(this.socketStatus='sync-problem')}disconnect(){this.socketStatus='sync-disabled',Webvisual.disconnect()}}customElements.define(SocketConnector.is,SocketConnector);</script></dom-module><dom-module id="device-caption" unresolved=""><template strip-whitespace=""><style>:host{font-family:"Fira Sans", sans-serif;@apply --layout-horizontal;@apply --layout-wrap;@apply --layout-center;@apply --layout-self-stretch;box-sizing:border-box;height:auto;width:auto;min-width:4em;font-size:1em;line-height:1.4;position:relative;background-color:var(--caption-background, white);color:var(--caption-color, #252525);padding:var(--caption-padding, 0.4em 0.5em);margin:0;}:host([vertical]){@apply --layout-vertical;@apply --layout-center-justified;@apply --layout-start;}.captions{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0;margin:0;font-size:0.6em;word-break:break-all;text-overflow:clip;font-weight:400;}.captions:after{content:attr(title);}:host(:not([vertical])) .captions{margin-left:0.35em;@apply --layout-self-baseline;}:host([vertical]) .captions{width:100%;@apply --layout-self-start;}:host .captions:first-of-type{font-weight:500;font-size:0.9em;margin-left:0;}:host .captions:nth-of-type(2){font-size:0.8em;}:host .captions:nth-of-type(3){font-size:0.7em;}:host([unresolved]){min-width:6em;min-height:initial;}:host([unresolved][vertical]){min-width:initial;min-height:4em;}[hidden]{display:none !important;}</style><template is="dom-if" if="[[title]]"><section class="captions">[[title]]</section></template><template is="dom-repeat" items="[[reducedCaptionKeys]]" as="captionKey"><section class="captions" hidden$="[[isEmptyCaption(captionKey, groupBy)]]">[[getKey(captionKey, groupBy, keys.*)]]</section></template></template><script>class CaptionElement extends Polymer.Element{static get is(){return'device-caption'}static get properties(){return{title:{type:String},keys:{type:Object,value:function(){return{}},notify:!0},groupBy:{type:String,value:''},onlyGroupedKey:{type:Boolean,value:!1},withoutGroupedKey:{type:Boolean,value:!1},reducedCaptionKeys:{type:Array,computed:'_computeReducedCaptionKeys(groupBy, keys, onlyGroupedKey, withoutGroupedKey)'},vertical:{type:Boolean,reflectToAttribute:!0}}}constructor(){super(),this.setAttribute('unresolved','')}getKey(a){return this.keys&&this.keys[a]}_computeReducedCaptionKeys(a,b,c,d){const e=Object.keys(b||{});if(0===e.length)return[];let f=[];return!0===d?f=e.filter(function(b){return a!==b}):!0===c&&(f=e.filter(function(b){return a===b})),this.hasAttribute('unresolved')&&this.removeAttribute('unresolved'),0===f.length?e:f}isEmptyCaption(a){return!this.keys[a]}}customElements.define(CaptionElement.is,CaptionElement);</script></dom-module><script>window.WebvisualMixins=window.WebvisualMixins||{},WebvisualMixins.DeviceMixin=function(a){return class extends a{constructor(){super()}static get properties(){return{item:{type:Object},values:{type:Array,value:function(){return[]}},isExceeding:{type:Boolean,value:!1},hasExceeded:{type:Boolean,value:!1},storeInside:{type:Boolean},viewLength:{type:Number,value:1},valueKey:{type:String,value:'y'},noLink:{type:Boolean,value:!1},_initialized:{type:Boolean},isDevice:{type:Boolean,value:!0,reflectToAttribute:!0,readOnly:!0}}}static get observers(){return['_exceedingChanged(isExceeding)','_hasExceededChanged(hasExceeded)','_linkElement(item, noLink)']}connectedCallback(){super.connectedCallback(),this._linkElement(this.item,this.noLink)}disconnectedCallback(){super.disconnectedCallback(),setTimeout(()=>{this.clearValues(),this._unlinkElement()},0)}_linkElement(a,b){if(a&&a.mount){if(this._olditem){if(a.mount===this._olditem.mount&&!b)return;this._unlinkElement(this._olditem)}return b?void this._unlinkElement(a):void(window.Webvisual&&window.Webvisual.assignElement&&(window.Webvisual.assignElement(this),this._olditem=a,this._initialized&&(this.clearValues(),this.reset()),this.requestValues(null,null,this.viewLength).then((a)=>{for(let b in a)if(b===this.item.mount){this.insertValues(a[b]);break}}).catch((a)=>{a&&console.log(a)})))}}_unlinkElement(a){a=a||this.item||this._olditem,setTimeout(()=>{window.Webvisual&&Webvisual.retractElement&&a&&a.mount&&(window.Webvisual.retractElement(this,a),this._olditem=null)},0)}getElement(){return this.properties}computeDate(a){return a?864E5>Math.abs(Date.now()-a)?new Date(a).toLocaleTimeString():new Date(a).toLocaleString():''}computeValue(a){return this.item&&this.item.isIndicatorLamp?this.checkExceedingState(a)?'\u2717':'\u2713':a}insertValues(a,b){if(void 0!==a){if(b=b||this.viewLength,this._initialized||(this._initialized=!0),!b)this.storeInside&&(this.values=this.values.concat(a)),this.renderInsertedValues(a);else{const c=a.slice(a.length-b,a.length);this.storeInside&&(this.values=this.values.concat(c)),this.renderInsertedValues(c),c.length=0}a.length=0}}spliceValues(a){a&&(!0===this.storeInside&&(this.values=this.values.filter((b)=>-1===a.indexOf(b)),this.notifyPath('values')),this.renderSplicedValues&&this.renderSplicedValues(a))}resetValues(a){this.values=a,this.notifyPath('values'),this.renderInsertedValues(this.values)}clearValues(){this.values=[],this.notifyPath('values')}requestValues(a,b,c){if(!(this.item&&this.item.mount))return new Promise((a,b)=>{b()});c=c||this.viewLength||1;const d={target:'cache',operation:'request',args:{mounts:[this.item.mount],from:null,to:null,length:c||1}};return window.Webvisual?new Promise((a)=>{window.Webvisual.request(d,a)}):new Promise((a,b)=>{this.values?a(this.values.slice(this.values.length-c,this.values.length)):b()})}requestRange(a){if(!(this.item&&this.item.mount))return new Promise((a)=>{a([void 0,void 0])});const b={target:'cache',operation:'range',forced:!0,args:{mounts:[this.item.mount],key:a}};return!this.storeInside&&window.Webvisual?new Promise((a)=>{window.Webvisual.request(b,a)}):new Promise((b)=>{if(this.values&&this.values.length){const c=this.min(this.values,a),d=this.max(this.values,a);void 0===c&&void 0===d||b([c,d])}b([void 0,void 0])})}min(c,d){let e,a,b=-1;const f=c.length;for(;++b<f;)if(null!==(a=c[b][d])&&a>=a){e=a;break}for(;++b<f;)null!==(a=c[b][d])&&e>a&&(e=a);return e}max(c,d){let e,a,b=-1;const f=c.length;for(;++b<f;)if(null!==(a=c[b][d])&&a>=a){e=a;break}for(;++b<f;)null!==(a=c[b][d])&&e<a&&(e=a);return e}renderInsertedValues(){}renderSplicedValues(){}renderClearing(){}checkExceedingState(a){if(!(this.item&&!0===this.item.exceedable&&void 0!==a&&void 0!==a[this.valueKey]&&null!==a[this.valueKey]))return 0;let b=0;return a[this.valueKey]<this.item.threshold.from?b=-1:a[this.valueKey]>this.item.threshold.to&&(b=1),0===b?!0===this.isExceeding&&(this.isExceeding=!1):!0!==this.isExceeding&&(this.isExceeding=!0,!1===this.hasExceeded&&this.set('hasExceeded',!0)),b}_exceedingChanged(a){this.item&&!0===this.item.exceedable&&this.dispatchEvent(new CustomEvent('exceeding',{bubbles:!0,composed:!0,detail:{item:this.item,value:a}}))}_hasExceededChanged(){}reset(){this.resetColor&&this.resetColor(),super.reset&&super.reset(),this.isExceeding=!1,this.hasExceeded=!1,this._initialized=!1,this.renderClearing()}}};</script><script>window.WebvisualMixins=window.WebvisualMixins||{},WebvisualMixins.ColorMixin=function(a){return class extends a{static get observers(){return['setColor(item.color)']}setColor(a){a&&(this.updateStyles({"--device-color":a||null}),this.item.isIndicatorLamp?this.updateStyles({"--device-state-inrange-color":null}):this.updateStyles({"--device-state-inrange-color":a||null})),this.updateStyles()}resetColor(){this.setColor(this.item&&this.item.color||'')}getComputedStyleValue(a){return window.ShadyCSS?ShadyCSS.getComputedStyleValue(this,a):getComputedStyle(this).getPropertyValue(a)}}};</script><script>window.WebvisualMixins=window.WebvisualMixins||{},WebvisualMixins.CheckedAndSelectMixin=function(a){return class extends a{constructor(){super()}static get properties(){return{active:{type:Boolean,notify:!0,reflectToAttribute:!0},selectable:{type:Boolean,value:!1,reflectToAttribute:!0},checked:{type:Boolean,reflectToAttribute:!0,notify:!0,observer:'_checkedChanged'},toggles:{type:Boolean,value:!0},tapEvent:{type:String},tapDuration:{type:Number,value:300},selectEvent:{type:String,value:'item-select'},disabled:{type:Boolean,value:!1},eventTarget:{type:String}}}static get observers(){return['_addTouchListeners(disabled, selectEvent, tapEvent)']}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this._checkedChanged(!1,this.checked),this._removeTouchListeners()}_addTouchListeners(a,b,c){if(void 0!==b)if(a)this._removeTouchListeners();else{let a;a=this.eventTarget?this.$[this.eventTarget]:this,c?(Polymer.Gestures.addListener(a,'down',(a)=>this._handleTouch(a)),Polymer.Gestures.addListener(a,'up',(a)=>this._handleTouch(a))):b?Polymer.Gestures.addListener(a,'tap',()=>this.select()):this._removeTouchListeners()}}_removeTouchListeners(){let a;a=this.eventTarget?this.$[this.eventTarget]:this,Polymer.Gestures.removeListener(a,'down',(a)=>this._handleTouch(a)),Polymer.Gestures.removeListener(a,'up',(a)=>this._handleTouch(a)),Polymer.Gestures.removeListener(a,'tap',()=>this.select())}_handleTouch(a){'down'===a.type?this._lastEvent=a:this._lastEvent&&a.timeStamp-(this._lastEvent.timeStamp||performance.now())>this.tapDuration?(this.dispatchEvent(new CustomEvent(this.tapEvent,{bubbles:!0,composed:!0,detail:{item:this.item}})),!1===this.checked&&this.select(!0)):this.select()}_checkedChanged(a){this.selectable&&this.selectEvent&&!this._preventSelectEvent&&this.dispatchEvent(new CustomEvent(this.selectEvent,{bubbles:!0,composed:!0,detail:{item:this.item,value:a}}))}select(a,b){!0===this.selectable&&(this._preventSelectEvent=b,a===void 0?!0===this.toggles?(this.checked=!0!==this.checked,this.active=!this.active):this.checked=!0:this.checked=a)}deselect(){!0===this.checked&&!0===this.selectable&&(this.checked=!1)}reset(){this._initialized&&(super.reset&&super.reset(),this.deselect())}}};</script><dom-module id="device-sign"><template strip-whitespace=""><style>:host{display:flex;flex-direction:column;position:relative;font-family:'Fira Sans', sans-serif;cursor:pointer;pointer-events:all;outline:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:1em;font-weight:400;width:auto;min-width:4em;min-height:4em;align-self:stretch;background-color:var(--device-state-inrange-color, var(--device-color));color:var(--device-text-color);will-change:background-color;transition:background-color 250ms cubic-bezier(0.3, 0, 0.15, 1);}:host([state="0"]){background-color:var(--device-state-inrange-color);color:var(--device-state-inrange-text-color);}:host([state="1"]){background-color:var(--device-state-exceeds-color);color:var(--device-state-exceeds-text-color);}:host([state="-1"]){background-color:var(--device-state-deceeds-color);color:var(--device-state-deceeds-text-color);}.value{position:absolute;top:0;bottom:0;left:0;right:0;display:inline-flex;flex-direction:row;align-items:center;justify-content:center;padding:0.3em 0.3em 0.5em 0.3em;box-sizing:border-box;overflow:hidden;}.value::before{position:absolute;top:0;bottom:0;left:0;right:0;content:"";pointer-events:none;background:linear-gradient(180deg,rgba(255,255,255,0),rgba(255,255,255,0.12),rgba(255,255,255,0));}:host([state="1"]) .value::before, :host([state="-1"]) .value::before{will-change:transform;animation-name:sign-background-rotate;animation-duration:1800ms;animation-fill-mode:both;animation-timing-function:linear;animation-iteration-count:infinite;}@keyframes sign-background-rotate{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}#valueSection{display:flex;flex-direction:row;align-items:baseline;justify-content:center;max-width:100%;text-align:center;}#value{font-size:0.9em;padding-right:0.15em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}#unitSection{font-size:0.7em;}#dateSection{position:absolute;pointer-events:none;padding:0.15em 0.25em;font-size:0.55em;bottom:0;width:100%;box-sizing:border-box;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;}svg#icon{height:1.5em;width:1.5em;fill:currentColor;}#ripple{pointer-events:none;color:#1d1d1d;border-radius:inherit;}#bookmark{padding:4px;cursor:pointer;outline:none;position:absolute;right:-5px;top:-5px;height:1.25em;width:1.25em;fill:#fff;opacity:0.9;mix-blend-mode:hard-light;will-change:transform, opacity;transform-origin:center;transition:transform 300ms cubic-bezier(0.3, 0, 0.1, 1), opacity 300ms cubic-bezier(0.3, 0, 0.1, 1);}#bookmark:hover{transform:scale(1.4);opacity:1;}#checkbox{fill:#fff;cursor:pointer;outline:none;pointer-events:none;position:absolute;opacity:0.6;right:0;bottom:0;height:1.25em;width:1.25em;mix-blend-mode:hard-light;}[hidden]{pointer-events:none;display:none !important;}</style><div class="value"><template is="dom-if" if="[[selectable]]"><paper-ripple id="ripple" recenters=""></paper-ripple></template><div id="valueSection" hidden$="[[item.isIndicatorLamp]]"><span id="value"></span> <span id="unitSection">[[item.unit]]</span></div><svg id="icon" hidden$="[[!item.isIndicatorLamp]]" aria-label="Alarm" viewBox="0 0 24 24"><g id="error-outline" hidden$="[[!isExceeding]]"><path d="M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></g></svg></div><span id="dateSection" hidden$="[[!showDate]]"></span> <svg id="bookmark" hidden$="[[!hasExceeded]]" viewBox="0 0 24 24" on-click="_requestExceedingDetails"><g id="announcement"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"></path></g></svg><template is="dom-if" if="[[checked]]"><svg id="checkbox" viewBox="0 0 24 24"><g id="playlist-add-check"><path d="M14 10H2v2h12v-2zm0-4H2v2h12V6zM2 16h8v-2H2v2zm19.5-4.5L23 13l-6.99 7-4.51-4.5L13 14l3.01 3 5.49-5.5z"></path></g></svg></template></template><script>class DeviceSign extends WebvisualMixins.CheckedAndSelectMixin(WebvisualMixins.ColorMixin(WebvisualMixins.DeviceMixin(Polymer.Element))){static get is(){return'device-sign'}static get properties(){return{showDate:{type:Boolean,value:!1},viewLength:{type:Number,value:1}}}insertValues(a){a&&a.length?setTimeout(()=>{this._initialized||(this._initialized=!0);const b=a[a.length-1];if(this.item.isIndicatorLamp||(this.$.value.textContent=this.computeValue(b.y)),this.showDate&&(this.$.dateSection.textContent=this.computeDate(b.x)),this.item.exceedable){const a=this.checkExceedingState(b);this.hasAttribute('state')&&this.state===a||this.setAttribute('state',a)}},0):this.renderClearing()}computeValue(a){return a}renderClearing(){this._initialized||(this.hasExceeded=!1,this.isExceeding=!1),this.$.value.textContent='',this.$.dateSection.textContent='',this.setAttribute('state',null)}_requestExceedingDetails(){this.dispatchEvent(new CustomEvent('request-exceeding-details',{bubbles:!0,composed:!0,detail:{item:this.item}}))}}customElements.define(DeviceSign.is,DeviceSign);</script></dom-module><dom-module id="device-checkbox"><template strip-whitespace=""><style>:host{display:inline-block;position:relative;transition:background-color 200ms ease;box-sizing:border-box;cursor:pointer;pointer-events:all;--calculated-box-size:var(--box-size, 20px);--calculated-box-ink-size:var(--box-ink-size, -1px);}#content{display:inline-flex;width:100%;position:relative;line-height:0;padding:0.25em 0.5em;}:host::before{position:absolute;content:"";top:0;left:0;right:0;bottom:0;transition:background-color 200ms cubic-bezier(0.6, 1, 0.3, 1);@apply --checkbox-unchecked-background;}:host([checked])::before{@apply --checkbox-checked-background;}:host(:not([checked])){color:var(--checkbox-unchecked-color, var(--device-color));}:host([checked]){color:var(--checkbox-checked-color, var(--device-color));}:host(:focus)::before{outline:1px solid var(--bright-primary-color);}#boxContainer{display:inline-block;align-self:center;position:relative;line-height:0;-webkit-tap-highlight-color:transparent;width:var(--calculated-box-size);height:var(--calculated-box-size);min-width:var(--calculated-box-size);margin:var(--box-margin, initial);vertical-align:var(--box-vertical-align, middle);background-color:var(--box-unchecked-background-color, transparent);}#ripple{position:absolute;top:calc(0px - (var(--calculated-box-ink-size) - var(--calculated-box-size)) / 2);left:calc(0px - (var(--calculated-box-ink-size) - var(--calculated-box-size)) / 2);width:var(--calculated-box-ink-size);height:var(--calculated-box-ink-size);color:var(--box-unchecked-ink-color, var(--primary-text-color));opacity:0.6;}#box{opacity:0.75;position:relative;box-sizing:border-box;position:relative;height:100%;border:solid 2px;border-color:var(--checkbox-border, var(--primary-text-color));border-radius:2px;background-color:rgba(255, 255, 255, 0.9);-webkit-transition:background-color 150ms, border-color 150ms, opacity 150ms;transition:background-color 150ms, border-color 150ms, opacity 150ms;}#arrow{position:absolute;width:36%;height:70%;border-style:solid;border-top:none;border-left:none;border-right-width:calc(2/15 * var(--calculated-box-size));border-bottom-width:calc(2/15 * var(--calculated-box-size));border-color:var(--box-arrow-color, white);-webkit-transform-origin:97% 87%;transform-origin:97% 87%;-webkit-transform:scale(0, 0) rotate(22.5deg);transform:scale(0, 0) rotate(67.5deg);box-sizing:content-box;}#box{background-color:var(--device-color);}:host([checked][state="1"]) #box,
      :host([checked][state="1"]) #arrow{border-color:var(--device-state-exceeds-color);}:host([checked][state="-1"]) #box,
      :host([checked][state="-1"]) #arrow{border-color:var(--device-state-deceeds-color);}:host(:not([checked])[state="1"]) #box{border-color:var(--device-state-exceeds-color);}:host(:not([checked])[state="-1"]) #box{border-color:var(--device-state-deceeds-color);}#ripple{color:var(--device-color);}:host([state="0"]) #ripple{color:var(--device-state-inrange-color);}:host([state="1"]) #ripple{color:var(--device-state-exceeds-color);}:host([state="-1"]) #ripple{color:var(--device-state-deceeds-color);}:host([checked]) #box{opacity:1;}:host([checked]) #arrow{-webkit-animation:arrow-expand 250ms ease-out forwards;animation:arrow-expand 250ms ease-out forwards;}@-webkit-keyframes arrow-expand{0%{-webkit-transform:scale(0, 0) rotate(67.5deg);}100%{-webkit-transform:scale(1, 1) rotate(45deg);}}@keyframes arrow-expand{0%{transform:scale(0, 0) rotate(67.5deg);}100%{transform:scale(1, 1) rotate(45deg);}}:host([disabled]) #box{opacity:0.5;border-color:var(--box-unchecked-color, --primary-text-color);}:host([disabled][checked]) #box{background-color:var(--disabled-text-color, --primary-text-color);opacity:0.5;}[hidden]{display:none !important;}</style><div id="content"><div id="boxContainer"><template is="dom-if" if="[[selectable]]"><paper-ripple id="ripple" center="" class="circle"></paper-ripple></template><section id="box"><section id="arrow" hidden$="[[!checked]]"></section></section></div><slot></slot></div></template><script>class DeviceCheckbox extends WebvisualMixins.ColorMixin(WebvisualMixins.CheckedAndSelectMixin(WebvisualMixins.DeviceMixin(Polymer.Element))){static get is(){return'device-checkbox'}static get properties(){return{viewLength:{type:Number,value:1},showDate:{type:Boolean}}}insertValues(a){if(a&&a.length){this._initialized||(this._initialized=!0);const b=a[a.length-1];if(this.item.exceedable){const a=this.checkExceedingState(b);this.hasAttribute('state')&&this.state===a||this.setAttribute('state',a)}}else this.renderClearing()}renderClearing(){this._initialized=!1,this.setAttribute('state',null)}connectedCallback(){super.connectedCallback(),Polymer.RenderStatus.afterNextRender(this,function(){const a=this.getComputedStyleValue('--calculated-box-ink-size').trim();if(!a||'-1px'===a){const a=parseFloat(this.getComputedStyleValue('--calculated-box-size').trim())||20;let b=Math.floor(8/3*a);b%2!==a%2&&b++,this.updateStyles({"--box-ink-size":b+'px'})}})}}customElements.define(DeviceCheckbox.is,DeviceCheckbox);</script></dom-module><dom-module id="iron-list" assetpath="../bower_components/iron-list/"><template><style>:host{display:block;}@media only screen and (-webkit-max-device-pixel-ratio: 1){:host{will-change:transform;}}#items{@apply --iron-list-items-container;position:relative;}:host(:not([grid])) #items > ::slotted(*){width:100%;}#items > ::slotted(*){box-sizing:border-box;margin:0;position:absolute;top:0;will-change:transform;}</style><array-selector id="selector" items="{{items}}" selected="{{selectedItems}}" selected-item="{{selectedItem}}"></array-selector><div id="items"><slot></slot></div></template></dom-module><script>(function(){var a=Math.floor,b=Math.round,c=Math.abs,d=Math.ceil,e=Math.min,f=Math.max,g=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),h=g&&8<=g[1],i=3,j='-10000px',k=-100,l=null!=Polymer.flush,m=l?Polymer.Async.animationFrame:0,n=l?Polymer.Async.idlePeriod:1,o=l?Polymer.Async.microTask:2;Polymer.OptionalMutableDataBehavior||(Polymer.OptionalMutableDataBehavior={}),Polymer({is:'iron-list',properties:{items:{type:Array},as:{type:String,value:'item'},indexAs:{type:String,value:'index'},selectedAs:{type:String,value:'selected'},grid:{type:Boolean,value:!1,reflectToAttribute:!0,observer:'_gridChanged'},selectionEnabled:{type:Boolean,value:!1},selectedItem:{type:Object,notify:!0},selectedItems:{type:Object,notify:!0},multiSelection:{type:Boolean,value:!1},scrollOffset:{type:Number,value:0}},observers:['_itemsChanged(items.*)','_selectionEnabledChanged(selectionEnabled)','_multiSelectionChanged(multiSelection)','_setOverflow(scrollTarget, scrollOffset)'],behaviors:[Polymer.Templatizer,Polymer.IronResizableBehavior,Polymer.IronScrollTargetBehavior,Polymer.OptionalMutableDataBehavior],_ratio:0.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_collection:null,_lastVisibleIndexVal:null,_maxPages:2,_focusedItem:null,_focusedVirtualIndex:-1,_focusedPhysicalIndex:-1,_offscreenFocusedItem:null,_focusBackfillItem:null,_itemsPerRow:1,_itemWidth:0,_rowHeight:0,_templateCost:0,_parentModel:!0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){var a=this.grid?this._physicalRows*this._rowHeight:this._physicalSize;return a-this._viewportHeight},get _itemsParent(){return Polymer.dom(Polymer.dom(this._userTemplate).parentNode)},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollOffset},get _maxVirtualStart(){var a=this._convertIndexToCompleteRow(this._virtualCount);return f(0,a-this._physicalCount)},set _virtualStart(a){a=this._clamp(a,0,this._maxVirtualStart),this.grid&&(a-=a%this._itemsPerRow),this._virtualStartVal=a},get _virtualStart(){return this._virtualStartVal||0},set _physicalStart(a){a%=this._physicalCount,0>a&&(a=this._physicalCount+a),this.grid&&(a-=a%this._itemsPerRow),this._physicalStartVal=a},get _physicalStart(){return this._physicalStartVal||0},get _physicalEnd(){return(this._physicalStart+this._physicalCount-1)%this._physicalCount},set _physicalCount(a){this._physicalCountVal=a},get _physicalCount(){return this._physicalCountVal||0},get _optPhysicalSize(){return 0===this._viewportHeight?Infinity:this._viewportHeight*this._maxPages},get _isVisible(){return!!(this.offsetWidth||this.offsetHeight)},get firstVisibleIndex(){var a=this._firstVisibleIndexVal;if(null==a){var b=this._physicalTop+this._scrollOffset;a=this._iterateItems(function(a,c){return b+=this._getPhysicalSizeIncrement(a),b>this._scrollPosition?this.grid?c-c%this._itemsPerRow:c:this.grid&&this._virtualCount-1===c?c-c%this._itemsPerRow:void 0})||0,this._firstVisibleIndexVal=a}return a},get lastVisibleIndex(){var a=this._lastVisibleIndexVal;if(null==a){if(this.grid)a=e(this._virtualCount,this.firstVisibleIndex+this._estRowsInView*this._itemsPerRow-1);else{var b=this._physicalTop+this._scrollOffset;this._iterateItems(function(c,d){b<this._scrollBottom&&(a=d),b+=this._getPhysicalSizeIncrement(c)})}this._lastVisibleIndexVal=a}return a},get _defaultScrollTarget(){return this},get _virtualRowCount(){return d(this._virtualCount/this._itemsPerRow)},get _estRowsInView(){return d(this._viewportHeight/this._rowHeight)},get _physicalRows(){return d(this._physicalCount/this._itemsPerRow)},get _scrollOffset(){return this._scrollerPaddingTop+this.scrollOffset},ready:function(){this.addEventListener('focus',this._didFocus.bind(this),!0)},attached:function(){this._debounceRender(this._render,m),this.listen(this,'iron-resize','_resizeHandler'),this.listen(this,'keydown','_keydownHandler')},detached:function(){this.unlisten(this,'iron-resize','_resizeHandler'),this.unlisten(this,'keydown','_keydownHandler')},_setOverflow:function(a){this.style.webkitOverflowScrolling=a===this?'touch':'',this.style.overflowY=a===this?'auto':'',this._lastVisibleIndexVal=null,this._firstVisibleIndexVal=null,this._debounceRender(this._render,m)},updateViewportBoundaries:function(){var a=window.getComputedStyle(this);this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(a['padding-top'],10),this._isRTL=!('rtl'!==a.direction),this._viewportWidth=this.$.items.offsetWidth,this._viewportHeight=this._scrollTargetHeight,this.grid&&this._updateGridMetrics()},_scrollHandler:function(){var d=f(0,e(this._maxScrollTop,this._scrollTop)),g=d-this._scrollPosition,h=0<=g;if(this._scrollPosition=d,this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,c(g)>this._physicalSize&&0<this._physicalSize){g-=this._scrollOffset;var i=b(g/this._physicalAverage)*this._itemsPerRow;this._virtualStart+=i,this._physicalStart+=i,this._physicalTop=a(this._virtualStart/this._itemsPerRow)*this._physicalAverage,this._update()}else if(0<this._physicalCount){var j=this._getReusables(h);h?(this._physicalTop=j.physicalTop,this._virtualStart+=j.indexes.length,this._physicalStart+=j.indexes.length):(this._virtualStart-=j.indexes.length,this._physicalStart-=j.indexes.length),this._update(j.indexes,h?null:j.indexes),this._debounceRender(this._increasePoolIfNeeded.bind(this,0),o)}},_getReusables:function(a){var b,c,d,e,f=[],g=this._hiddenContentSize*this._ratio,h=this._virtualStart,i=this._virtualEnd,j=this._physicalCount,k=this._physicalTop+this._scrollOffset,l=this._physicalBottom+this._scrollOffset,m=this._scrollTop,n=this._scrollBottom;for(a?(b=this._physicalStart,c=this._physicalEnd,d=m-k):(b=this._physicalEnd,c=this._physicalStart,d=l-n);e=this._getPhysicalSizeIncrement(b),d-=e,!(f.length>=j||d<=g);)if(a){if(i+f.length+1>=this._virtualCount)break;if(k+e>=m-this._scrollOffset)break;f.push(b),k+=e,b=(b+1)%j}else{if(0>=h-f.length)break;if(k+this._physicalSize-e<=n)break;f.push(b),k-=e,b=0===b?j-1:b-1}return{indexes:f,physicalTop:k-this._scrollOffset}},_update:function(a,b){if(!(a&&0===a.length||0===this._physicalCount)){if(this._manageFocus(),this._assignModels(a),this._updateMetrics(a),b)for(;b.length;){var c=b.pop();this._physicalTop-=this._getPhysicalSizeIncrement(c)}this._positionItems(),this._updateScrollerSize()}},_createPool:function(a){this._ensureTemplatized();var b,c,d=Array(a);for(b=0;b<a;b++)c=this.stamp(null),d[b]=c.root.querySelector('*'),this._itemsParent.appendChild(c.root);return d},_isClientFull:function(){return 0!=this._scrollBottom&&this._physicalBottom-1>=this._scrollBottom&&this._physicalTop<=this._scrollPosition},_increasePoolIfNeeded:function(a){var c=this._clamp(this._physicalCount+a,i,this._virtualCount-this._virtualStart);if(c=this._convertIndexToCompleteRow(c),this.grid){var d=c%this._itemsPerRow;d&&c-d<=this._physicalCount&&(c+=this._itemsPerRow),c-=d}var e=c-this._physicalCount,f=b(0.5*this._physicalCount);if(!(0>e)){if(0<e){var g=window.performance.now();[].push.apply(this._physicalItems,this._createPool(e)),[].push.apply(this._physicalSizes,Array(e)),this._physicalCount+=e,this._physicalStart>this._physicalEnd&&this._isIndexRendered(this._focusedVirtualIndex)&&this._getPhysicalIndex(this._focusedVirtualIndex)<this._physicalEnd&&(this._physicalStart+=e),this._update(),this._templateCost=(window.performance.now()-g)/e,f=b(0.5*this._physicalCount)}this._virtualEnd>=this._virtualCount-1||0===f||(this._isClientFull()?this._physicalSize<this._optPhysicalSize&&this._debounceRender(this._increasePoolIfNeeded.bind(this,this._clamp(b(50/this._templateCost),1,f)),n):this._debounceRender(this._increasePoolIfNeeded.bind(this,f),o))}},_render:function(){if(this.isAttached&&this._isVisible)if(0!==this._physicalCount){var a=this._getReusables(!0);this._physicalTop=a.physicalTop,this._virtualStart+=a.indexes.length,this._physicalStart+=a.indexes.length,this._update(a.indexes),this._update(),this._increasePoolIfNeeded(0)}else 0<this._virtualCount&&(this.updateViewportBoundaries(),this._increasePoolIfNeeded(i))},_ensureTemplatized:function(){if(!this.ctor){this._userTemplate=this.queryEffectiveChildren('template'),this._userTemplate||console.warn('iron-list requires a template to be provided in light-dom');var a={};a.__key__=!0,a[this.as]=!0,a[this.indexAs]=!0,a[this.selectedAs]=!0,a.tabIndex=!0,this._instanceProps=a,this.templatize(this._userTemplate,this.mutableData)}},_gridChanged:function(a,b){'undefined'===typeof b||(this.notifyResize(),Polymer.flush?Polymer.flush():Polymer.dom.flush(),a&&this._updateGridMetrics())},_itemsChanged:function(a){if('items'===a.path)this._virtualStart=0,this._physicalTop=0,this._virtualCount=this.items?this.items.length:0,this._collection=this.items&&Polymer.Collection?Polymer.Collection.get(this.items):null,this._physicalIndexForKey={},this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this._physicalCount=this._physicalCount||0,this._physicalItems=this._physicalItems||[],this._physicalSizes=this._physicalSizes||[],this._physicalStart=0,this._scrollTop>this._scrollOffset&&this._resetScrollPosition(0),this._removeFocusedItem(),this._debounceRender(this._render,m);else if('items.splices'===a.path){this._adjustVirtualIndex(a.value.indexSplices),this._virtualCount=this.items?this.items.length:0;var b=a.value.indexSplices.some(function(a){return this._isIndexRendered(a.index)},this);(!this._isClientFull()||b)&&this._debounceRender(this._render,m)}else'items.length'!==a.path&&this._forwardItemPath(a.path,a.value)},_forwardItemPath:function(a,b){a=a.slice(6);var c=a.indexOf('.')+1;0===c&&(c=a.length);var d,e,f=l?parseInt(a.substring(0,c),10):parseInt(a.substring(1,c),10),g=this._offscreenFocusedItem,h=this._isIndexRendered(f);h?(e=this._getPhysicalIndex(f),d=this.modelForElement(this._physicalItems[e])):g&&(d=this.modelForElement(g));d&&d[this.indexAs]===f&&(a=a.substring(c),a=this.as+(a?'.'+a:''),l?d._setPendingPropertyOrPath(a,b,!1,!0):d.notifyPath(a,b,!0),d._flushProperties&&d._flushProperties(!0),h&&(this._updateMetrics([e]),this._positionItems(),this._updateScrollerSize()))},_adjustVirtualIndex:function(a){a.forEach(function(a){if(a.removed.forEach(this._removeItem,this),a.index<this._virtualStart){var b=f(a.addedCount-a.removed.length,a.index-this._virtualStart);this._virtualStart+=b,0<=this._focusedVirtualIndex&&(this._focusedVirtualIndex+=b)}},this)},_removeItem:function(a){this.$.selector.deselect(a),this._focusedItem&&this.modelForElement(this._focusedItem)[this.as]===a&&(this._removeFocusedItem(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur())},_iterateItems:function(a,b){var c,d,e,f;if(2===arguments.length&&b){for(f=0;f<b.length;f++)if(c=b[f],d=this._computeVidx(c),null!=(e=a.call(this,c,d)))return e;}else{for(c=this._physicalStart,d=this._virtualStart;c<this._physicalCount;c++,d++)if(null!=(e=a.call(this,c,d)))return e;for(c=0;c<this._physicalStart;c++,d++)if(null!=(e=a.call(this,c,d)))return e}},_computeVidx:function(a){return a>=this._physicalStart?this._virtualStart+(a-this._physicalStart):this._virtualStart+(this._physicalCount-this._physicalStart)+a},_assignModels:function(a){this._iterateItems(function(a,b){var c=this._physicalItems[a],d=this.items&&this.items[b];if(null!=d){var e=this.modelForElement(c);e.__key__=this._collection?this._collection.getKey(d):null,this._forwardProperty(e,this.as,d),this._forwardProperty(e,this.selectedAs,this.$.selector.isSelected(d)),this._forwardProperty(e,this.indexAs,b),this._forwardProperty(e,'tabIndex',this._focusedVirtualIndex===b?0:-1),this._physicalIndexForKey[e.__key__]=a,e._flushProperties&&e._flushProperties(!0),c.removeAttribute('hidden')}else c.setAttribute('hidden','')},a)},_updateMetrics:function(a){Polymer.flush?Polymer.flush():Polymer.dom.flush();var c=0,e=0,f=this._physicalAverageCount,g=this._physicalAverage;this._iterateItems(function(a){e+=this._physicalSizes[a]||0,this._physicalSizes[a]=this._physicalItems[a].offsetHeight,c+=this._physicalSizes[a],this._physicalAverageCount+=this._physicalSizes[a]?1:0},a),this.grid?(this._updateGridMetrics(),this._physicalSize=d(this._physicalCount/this._itemsPerRow)*this._rowHeight):(e=1===this._itemsPerRow?e:d(this._physicalCount/this._itemsPerRow)*this._rowHeight,this._physicalSize=this._physicalSize+c-e,this._itemsPerRow=1),this._physicalAverageCount!==f&&(this._physicalAverage=b((g*f+c)/this._physicalAverageCount))},_updateGridMetrics:function(){this._itemWidth=0<this._physicalCount?this._physicalItems[0].getBoundingClientRect().width:200,this._rowHeight=0<this._physicalCount?this._physicalItems[0].offsetHeight:200,this._itemsPerRow=this._itemWidth?a(this._viewportWidth/this._itemWidth):this._itemsPerRow},_positionItems:function(){this._adjustScrollPosition();var b=this._physicalTop;if(this.grid){var c=this._itemsPerRow*this._itemWidth,d=(this._viewportWidth-c)/2;this._iterateItems(function(c,e){var f=e%this._itemsPerRow,g=a(f*this._itemWidth+d);this._isRTL&&(g*=-1),this.translate3d(g+'px',b+'px',0,this._physicalItems[c]),this._shouldRenderNextRow(e)&&(b+=this._rowHeight)})}else this._iterateItems(function(a){this.translate3d(0,b+'px',0,this._physicalItems[a]),b+=this._physicalSizes[a]})},_getPhysicalSizeIncrement:function(a){return this.grid?this._computeVidx(a)%this._itemsPerRow===this._itemsPerRow-1?this._rowHeight:0:this._physicalSizes[a]},_shouldRenderNextRow:function(a){return a%this._itemsPerRow===this._itemsPerRow-1},_adjustScrollPosition:function(){var a=0===this._virtualStart?this._physicalTop:e(this._scrollPosition+this._physicalTop,0);if(0!==a){this._physicalTop-=a;var b=this._scrollTop;!h&&0<b&&this._resetScrollPosition(b-a)}},_resetScrollPosition:function(a){this.scrollTarget&&0<=a&&(this._scrollTop=a,this._scrollPosition=this._scrollTop)},_updateScrollerSize:function(a){this._estScrollHeight=this.grid?this._virtualRowCount*this._rowHeight:this._physicalBottom+f(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage,a=a||0===this._scrollHeight,a=a||this._scrollPosition>=this._estScrollHeight-this._physicalSize,a=a||this.grid&&this.$.items.style.height<this._estScrollHeight,(a||c(this._estScrollHeight-this._scrollHeight)>=this._viewportHeight)&&(this.$.items.style.height=this._estScrollHeight+'px',this._scrollHeight=this._estScrollHeight)},scrollToItem:function(a){return this.scrollToIndex(this.items.indexOf(a))},scrollToIndex:function(b){if(!('number'!==typeof b||0>b||b>this.items.length-1)&&(Polymer.flush?Polymer.flush():Polymer.dom.flush(),0!==this._physicalCount)){b=this._clamp(b,0,this._virtualCount-1),(!this._isIndexRendered(b)||b>=this._maxVirtualStart)&&(this._virtualStart=this.grid?b-2*this._itemsPerRow:b-1),this._manageFocus(),this._assignModels(),this._updateMetrics(),this._physicalTop=a(this._virtualStart/this._itemsPerRow)*this._physicalAverage;for(var c=this._physicalStart,d=this._virtualStart,e=0,f=this._hiddenContentSize;d<b&&e<=f;)e+=this._getPhysicalSizeIncrement(c),c=(c+1)%this._physicalCount,d++;this._updateScrollerSize(!0),this._positionItems(),this._resetScrollPosition(this._physicalTop+this._scrollOffset+e),this._increasePoolIfNeeded(0),this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null}},_resetAverage:function(){this._physicalAverage=0,this._physicalAverageCount=0},_resizeHandler:function(){this._debounceRender(function(){this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null;c(this._viewportHeight-this._scrollTargetHeight);this.updateViewportBoundaries(),this._isVisible?(this.toggleScrollListener(!0),this._resetAverage(),this._render()):this.toggleScrollListener(!1)},m)},selectItem:function(a){return this.selectIndex(this.items.indexOf(a))},selectIndex:function(a){if(!(0>a||a>=this._virtualCount)){if(!this.multiSelection&&this.selectedItem&&this.clearSelection(),this._isIndexRendered(a)){var b=this.modelForElement(this._physicalItems[this._getPhysicalIndex(a)]);b&&(b[this.selectedAs]=!0),this.updateSizeForIndex(a)}this.$.selector.selectIndex?this.$.selector.selectIndex(a):this.$.selector.select(this.items[a])}},deselectItem:function(a){return this.deselectIndex(this.items.indexOf(a))},deselectIndex:function(a){if(!(0>a||a>=this._virtualCount)){if(this._isIndexRendered(a)){var b=this.modelForElement(this._physicalItems[this._getPhysicalIndex(a)]);b[this.selectedAs]=!1,this.updateSizeForIndex(a)}this.$.selector.deselectIndex?this.$.selector.deselectIndex(a):this.$.selector.deselect(this.items[a])}},toggleSelectionForItem:function(a){return this.toggleSelectionForIndex(this.items.indexOf(a))},toggleSelectionForIndex:function(a){var b=this.$.selector.isIndexSelected?this.$.selector.isIndexSelected(a):this.$.selector.isSelected(this.items[a]);b?this.deselectIndex(a):this.selectIndex(a)},clearSelection:function(){this._iterateItems(function(a){this.modelForElement(this._physicalItems[a])[this.selectedAs]=!1}),this.$.selector.clearSelection()},_selectionEnabledChanged:function(a){var b=a?this.listen:this.unlisten;b.call(this,this,'tap','_selectionHandler')},_selectionHandler:function(a){var b=this.modelForElement(a.target);if(b){var c,d,e=Polymer.dom(a).path[0],f=this._itemsParent.node.domHost,g=Polymer.dom(f?f.root:document).activeElement,h=this._physicalItems[this._getPhysicalIndex(b[this.indexAs])];'input'!==e.localName&&'button'!==e.localName&&'select'!==e.localName&&(c=b.tabIndex,b.tabIndex=k,d=g?g.tabIndex:-1,b.tabIndex=c,g&&h!==g&&h.contains(g)&&d!==k||this.toggleSelectionForItem(b[this.as]))}},_multiSelectionChanged:function(a){this.clearSelection(),this.$.selector.multi=a},updateSizeForItem:function(a){return this.updateSizeForIndex(this.items.indexOf(a))},updateSizeForIndex:function(a){return this._isIndexRendered(a)?(this._updateMetrics([this._getPhysicalIndex(a)]),this._positionItems(),null):null},_manageFocus:function(){var a=this._focusedVirtualIndex;0<=a&&a<this._virtualCount?this._isIndexRendered(a)?this._restoreFocusedItem():this._createFocusBackfillItem():0<this._virtualCount&&0<this._physicalCount&&(this._focusedPhysicalIndex=this._physicalStart,this._focusedVirtualIndex=this._virtualStart,this._focusedItem=this._physicalItems[this._physicalStart])},_convertIndexToCompleteRow:function(a){return this._itemsPerRow=this._itemsPerRow||1,this.grid?d(a/this._itemsPerRow)*this._itemsPerRow:a},_isIndexRendered:function(a){return a>=this._virtualStart&&a<=this._virtualEnd},_isIndexVisible:function(a){return a>=this.firstVisibleIndex&&a<=this.lastVisibleIndex},_getPhysicalIndex:function(a){return(this._physicalStart+(a-this._virtualStart))%this._physicalCount},focusItem:function(a){this._focusPhysicalItem(a)},_focusPhysicalItem:function(a){if(!(0>a||a>=this._virtualCount)){this._restoreFocusedItem(),this._isIndexRendered(a)||this.scrollToIndex(a);var b,c=this._physicalItems[this._getPhysicalIndex(a)],d=this.modelForElement(c);d.tabIndex=k,c.tabIndex===k&&(b=c),b||(b=Polymer.dom(c).querySelector('[tabindex="'+k+'"]')),d.tabIndex=0,this._focusedVirtualIndex=a,b&&b.focus()}},_removeFocusedItem:function(){this._offscreenFocusedItem&&this._itemsParent.removeChild(this._offscreenFocusedItem),this._offscreenFocusedItem=null,this._focusBackfillItem=null,this._focusedItem=null,this._focusedVirtualIndex=-1,this._focusedPhysicalIndex=-1},_createFocusBackfillItem:function(){var a=this._focusedPhysicalIndex;if(!(this._offscreenFocusedItem||0>this._focusedVirtualIndex)){if(!this._focusBackfillItem){var b=this.stamp(null);this._focusBackfillItem=b.root.querySelector('*'),this._itemsParent.appendChild(b.root)}this._offscreenFocusedItem=this._physicalItems[a],this.modelForElement(this._offscreenFocusedItem).tabIndex=0,this._physicalItems[a]=this._focusBackfillItem,this._focusedPhysicalIndex=a,this.translate3d(0,j,0,this._offscreenFocusedItem)}},_restoreFocusedItem:function(){if(this._offscreenFocusedItem&&!(0>this._focusedVirtualIndex)){this._assignModels();var a=this._focusedPhysicalIndex,b=this._physicalItems[a];if(b){var c=this.modelForElement(b),d=this.modelForElement(this._offscreenFocusedItem);c[this.as]===d[this.as]?(this._focusBackfillItem=b,c.tabIndex=-1,this._physicalItems[a]=this._offscreenFocusedItem,this.translate3d(0,j,0,this._focusBackfillItem)):(this._removeFocusedItem(),this._focusBackfillItem=null),this._offscreenFocusedItem=null}}},_didFocus:function(a){var b=this.modelForElement(a.target),c=this.modelForElement(this._focusedItem),d=null!==this._offscreenFocusedItem,e=this._focusedVirtualIndex;b&&(c===b?!this._isIndexVisible(e)&&this.scrollToIndex(e):(this._restoreFocusedItem(),c&&(c.tabIndex=-1),b.tabIndex=0,e=b[this.indexAs],this._focusedVirtualIndex=e,this._focusedPhysicalIndex=this._getPhysicalIndex(e),this._focusedItem=this._physicalItems[this._focusedPhysicalIndex],d&&!this._offscreenFocusedItem&&this._update()))},_keydownHandler:function(a){switch(a.keyCode){case 40:a.preventDefault(),this._focusPhysicalItem(this._focusedVirtualIndex+(this.grid?this._itemsPerRow:1));break;case 39:this.grid&&this._focusPhysicalItem(this._focusedVirtualIndex+(this._isRTL?-1:1));break;case 38:this._focusPhysicalItem(this._focusedVirtualIndex-(this.grid?this._itemsPerRow:1));break;case 37:this.grid&&this._focusPhysicalItem(this._focusedVirtualIndex+(this._isRTL?1:-1));break;case 13:this._focusPhysicalItem(this._focusedVirtualIndex),this._selectionHandler(a);}},_clamp:function(a,b,c){return e(c,f(b,a))},_debounceRender:function(a,b){l?(this._renderDebouncer=Polymer.Debouncer.debounce(this._renderDebouncer,b,a.bind(this)),Polymer.enqueueDebouncer(this._renderDebouncer)):this._debounceTemplate(a)},_forwardProperty:function(a,b,c){l?a._setPendingProperty(b,c):a[b]=c},_forwardHostPropV2:function(a,b){(this._physicalItems||[]).concat([this._offscreenFocusedItem,this._focusBackfillItem]).forEach(function(c){c&&this.modelForElement(c).forwardHostProp(a,b)},this)},_notifyInstancePropV2:function(a,b,c){if(Polymer.Path.matches(this.as,b)){var d=a[this.indexAs];b==this.as&&(this.items[d]=c),this.notifyPath(Polymer.Path.translate(this.as,'items.'+d,b),c)}},_getStampedChildren:function(){return this._physicalItems},_forwardInstancePath:function(a,b,c){0===b.indexOf(this.as+'.')&&this.notifyPath('items.'+a.__key__+'.'+b.slice(this.as.length+1),c)},_forwardParentPath:function(a,b){(this._physicalItems||[]).concat([this._offscreenFocusedItem,this._focusBackfillItem]).forEach(function(c){c&&this.modelForElement(c).notifyPath(a,b,!0)},this)},_forwardParentProp:function(a,b){(this._physicalItems||[]).concat([this._offscreenFocusedItem,this._focusBackfillItem]).forEach(function(c){c&&(this.modelForElement(c)[a]=b)},this)}})})();</script><dom-module id="device-table"><template strip-whitespace=""><style>:host{color:var(--table-color, currentColor);background-color:var(--table-background, transparent);@apply --layout-vertical;width:100%;height:100%;position:relative;border-color:inherit;border-radius:inherit;min-width:150px;min-height:75px;text-align:left;line-height:1.4;pointer-events:all;font-weight:400;}span{position:relative;padding:0 0.5em;}.tr{@apply --layout-horizontal;@apply --layout-around-justified;font-size:0.7em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.tr:not([state]), .tr[state="0"]{background:none;color:inherit;}.tr:nth-of-type(even){background:rgba(137, 137, 137, 0.15);}.tr[state="1"]{background:var(--device-state-exceeds-color);color:var(--device-state-exceeds-text-color);}.tr[state="-1"]{background:var(--device-state-deceeds-color);color:var(--device-state-deceeds-text-color);}.tr[onlyfirstrow] > span:not(:first-of-type){display:none;}#head{@apply --layout-horizontal;@apply --layout-around-justified;font-size:0.8em;width:100%;line-height:1.7;border-bottom-style:solid;border-bottom-width:thin;border-color:inherit;cursor:pointer;text-align:center;}#caption{font-weight:500;display:block;position:relative;font-size:0.6em;background-color:rgba(0, 0, 0, 0.2);color:var(--bright-text-color);padding:0.5em 1em;text-align:center;-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all;}[hidden]{display:none !important;}#list{height:auto;width:100%;flex:1 1 50px;}::selection{background:transparent;}::-moz-selection{background:transparent;}</style><section id="head" hidden$="[[hideHeader]]" on-click="_toggleGridView"><span>Datum</span> <span hidden$="[[onlyFirstRow]]">Wert <span hidden$="[[!item.unit]]" style="font-style:italic">([[item.unit]])</span></span></section><iron-list id="list" items="[[values]]" as="value"><template><div class="tr" state$="[[checkExceedingState(value)]]" onlyfirstrow$="[[onlyFirstRow]]"><span>[[computeDate(value.x)]]</span> <span>[[computeValue(value.y)]]</span></div></template></iron-list><section id="caption" hidden$="[[!caption]]">[[caption]]</section></template><script>class DeviceTable extends WebvisualMixins.DeviceMixin(Polymer.Element){static get is(){return'device-table'}static get properties(){return{caption:{type:String,value:''},keysForCaption:{type:Boolean},onlyFirstRow:{type:Boolean},hideHeader:{type:Boolean},fullDate:{type:Boolean},viewLength:{type:Number,value:Number.POSITIVE_INFINITY},storeInside:{type:Boolean,value:!1}}}static get observers(){return['_computeKeysForCaption(keysForCaption, item)']}insertValues(a){a&&a.length?setTimeout(()=>{if(!this._initialized)this.set('values',a.reverse()),this._initialized=!0;else for(let b=0;b<a.length;b++)this.unshift('values',a[b])},0):!this._initialized&&this.renderClearing()}spliceValues(a){setTimeout(()=>{const b=[];for(let c=0;c<a.length;c++){let d;for(d=this.values.length-1;0<=d&&!(this.values[d].x===a[c].x);d--);-1!==d&&(this.values.splice(d,1),b.push({index:d,removed:[this.values[d]],addedCount:0,object:this.values,type:'splice'}))}this.notifySplices('values',b)},0)}renderClearing(){this.$.list.set('items',[])}_computeKeysForCaption(a,b){if(a&&b&&b.keys){let a='';for(let b in this.item.keys)a+=this.item.keys[b]+' ';this.$.caption.textContent=a}else this.caption&&(this.$.caption.textContent=this.caption)}_toggleGridView(){this.$.list.grid=!this.$.list.grid}}customElements.define(DeviceTable.is,DeviceTable);</script></dom-module><dom-module id="device-table-group"><template strip-whitespace=""><style>:host{@apply --layout-vertical;position:relative;box-sizing:border-box;}#tabs{width:100%;flex-shrink:0;background-color:rgba(0, 0, 0, 0.2);--tab-overlay:{background-color:rgba(0, 0, 0, 0.3);color:var(--bright-text-color);border-bottom:medium solid var(--secondary-color);border-left:none;};}.caption{--caption-background:transparent;--caption-color:currentColor;}#tables{position:relative;box-sizing:border-box;flex:1 0 0.0001px;}.tab{font-size:0.75em;height:auto;box-sizing:border-box;border-radius:0;white-space:nowrap;}.hidden{display:none;}</style><tabs-container id="tabs" selected="{{selectedMount}}" attr-for-selected="title"><template is="dom-repeat" items="[[items]]"><tab-element class="tab" title$="[[item.mount]]"><device-caption class="caption" title$="[[item.title]]" keys="[[item.keys]]"></device-caption></tab-element></template></tabs-container><iron-pages id="tables" selected="{{selectedMount}}" attr-for-selected="title"><template is="dom-repeat" items="[[items]]"><device-table title$="[[item.title]]" item="[[item]]" no-link="[[!opened]]"></device-table></template></iron-pages></template><script>class DeviceTableGroup extends Polymer.Element{static get is(){return'device-table-group'}static get properties(){return{opened:{type:Boolean,notify:!0},items:{type:Array,notify:!0},selectedItemMount:{type:String,notify:!0}}}static get observers(){return['_shouldHideTabs(items.length)']}_shouldHideTabs(a){2>a?this.$.tabs.classList.add('hidden'):this.$.tabs.classList.remove('hidden'),1===a&&this.set('selectedItemMount',this.items[0].mount)}reset(){this.set('items',[]),this.set('selectedItemMount','')}}customElements.define(DeviceTableGroup.is,DeviceTableGroup);</script></dom-module><script type="text/javascript">var d3=function(oo){"use strict";function io(o){return function(t,n){return Rr(o(t),n)}}function uo(a,t,n){var l=(t-a)/Wr(0,n),r=$r(Zr(l)/Br),d=l/Vr(10,r);return 0<=r?(d>=Kr?10:d>=ti?5:d>=ni?2:1)*Vr(10,r):-Vr(10,-r)/(d>=Kr?10:d>=ti?5:d>=ni?2:1)}function Oa(a,t,n){var e=qr(t-a)/Wr(0,n),l=Vr(10,$r(Zr(e)/Br)),d=e/l;return d>=Kr?l*=10:d>=ti?l*=5:d>=ni&&(l*=2),t<a?-l:l}function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ja(){return new e}function n(e){this._context=e}function o(e){return e[0]}function a(e){return e[1]}function r(o,t,n){o._context.bezierCurveTo((2*o._x0+o._x1)/3,(2*o._y0+o._y1)/3,(o._x0+2*o._x1)/3,(o._y0+2*o._y1)/3,(o._x0+4*o._x1+t)/6,(o._y0+4*o._y1+n)/6)}function s(e){this._context=e}function l(o,t,n){o._context.bezierCurveTo(o._x1+o._k*(o._x2-o._x0),o._y1+o._k*(o._y2-o._y0),o._x2+o._k*(o._x1-t),o._y2+o._k*(o._y1-n),o._x2,o._y2)}function c(e,t){this._context=e,this._k=(1-t)/6}function u(d,t,n){var e=d._x1,r=d._y1,i=d._x2,o=d._y2;if(d._l01_a>ai){var u=2*d._l01_2a+3*d._l01_a*d._l12_a+d._l12_2a,a=3*d._l01_a*(d._l01_a+d._l12_a);e=(e*u-d._x0*d._l12_2a+d._x2*d._l01_2a)/a,r=(r*u-d._y0*d._l12_2a+d._y2*d._l01_2a)/a}if(d._l23_a>ai){var s=2*d._l23_2a+3*d._l23_a*d._l12_a+d._l12_2a,c=3*d._l23_a*(d._l23_a+d._l12_a);i=(i*s+d._x1*d._l23_2a-t*d._l12_2a)/c,o=(o*s+d._y1*d._l23_2a-n*d._l12_2a)/c}d._context.bezierCurveTo(e,r,i,o,d._x2,d._y2)}function p(e,t){this._context=e,this._alpha=t}function _(e){return 0>e?-1:1}function h(a,t,n){var e=a._x1-a._x0,l=t-a._x1,i=(a._y1-a._y0)/(e||0>l&&-0),o=(n-a._y1)/(l||0>e&&-0);return(_(i)+_(o))*Ir(qr(i),qr(o),.5*qr((i*l+o*e)/(e+l)))||0}function y(o,t){var n=o._x1-o._x0;return n?(3*(o._y1-o._y0)/n-t)/2:t}function d(l,t,n){var e=l._x0,r=l._y0,i=l._x1,o=l._y1,d=(i-e)/3;l._context.bezierCurveTo(e+d,r+d*t,i-d,o-d*n,i,o)}function m(e){this._context=e}function g(e){this._context=e}function f(e){this._context=e}function x(a){var t,n,e=a.length-1,l=Array(e),i=Array(e),o=Array(e);for(l[0]=0,i[0]=2,o[0]=a[0]+2*a[1],t=1;t<e-1;++t)l[t]=1,i[t]=4,o[t]=4*a[t]+2*a[t+1];for(l[e-1]=2,i[e-1]=7,o[e-1]=8*a[e-1]+a[e],t=1;t<e;++t)n=l[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(l[e-1]=o[e-1]/i[e-1],t=e-2;0<=t;--t)l[t]=(o[t]-l[t+1])/i[t];for(i[e-1]=(a[e]+l[e-1])/2,t=0;t<e-1;++t)i[t]=2*a[t+1]-l[t+1];return[l,i]}function v(e,t){this._context=e,this._t=t}function b(a,l,t,e){function d(e){return a(e=new Date(+e)),e}return d.floor=d,d.ceil=function(t){return a(t=new Date(t-1)),l(t,1),a(t),t},d.round=function(o){var t=d(o),n=d.ceil(o);return o-t<n-o?t:n},d.offset=function(n,o){return l(n=new Date(+n),null==o?1:$r(o)),n},d.range=function(t,n,i){var o=[];if(t=d.ceil(t),i=null==i?1:$r(i),!(t<n&&0<i))return o;do o.push(new Date(+t));while((l(t,i),a(t),t<n));return o},d.filter=function(o){return b(function(e){if(e>=e)for(;a(e),!o(e);)e.setTime(e-1)},function(e,t){if(e>=e)if(0>t)for(;0>=++t;)for(;l(e,-1),!o(e););else for(;0<=--t;)for(;l(e,1),!o(e););})},t&&(d.count=function(e,o){return fi.setTime(+e),pi.setTime(+o),a(fi),a(pi),$r(t(fi,pi))},d.every=function(o){return o=$r(o),isFinite(o)&&0<o?1<o?d.filter(e?function(t){return 0==e(t)%o}:function(e){return 0==d.count(0,e)%o}):d:null}),d}function t(e){return b(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vi)/yi})}function w(e){return b(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/yi})}function T(e){return new k(e)}function k(d){if(!(t=Pi.exec(d)))throw new Error("invalid format: "+d);var t,n=t[1]||" ",e=t[2]||">",r=t[3]||"-",i=t[4]||"",o=!!t[5],u=t[6]&&+t[6],a=!!t[7],s=t[8]&&+t[8].slice(1),c=t[9]||"";"n"===c?(a=!0,c="g"):Qr[c]||(c=""),(o||"0"===n&&"="===e)&&(o=!0,n="0",e="="),this.fill=n,this.align=e,this.sign=r,this.symbol=i,this.zero=o,this.width=u,this.comma=a,this.precision=s,this.type=c}function S(e){return Li=Ii(e),oo.format=Li.format,Hi=Li.formatPrefix,Li}function C(e){if(0<=e.y&&100>e.y){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function z(e){if(0<=e.y&&100>e.y){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function M(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function A(k){function S(l,t){return function(n){var d,r,i,o=[],u=-1,a=0,s=l.length;for(n instanceof Date||(n=new Date(+n));++u<s;)37===l.charCodeAt(u)&&(o.push(l.slice(a,u)),null==(r=Zi[d=l.charAt(++u)])?r="e"===d?" ":"0":d=l.charAt(++u),(i=t[d])&&(d=i(n,r)),o.push(d),a=u+1);return o.push(l.slice(a,u)),o.join("")}}function U(a,t){return function(n){var e=M(1900);if(A(e,a,n+="",0)!=n.length)return null;if("p"in e&&(e.H=e.H%12+12*e.p),"W"in e||"U"in e){"w"in e||(e.w="W"in e?1:0);var i="Z"in e?z(M(e.y)).getUTCDay():t(M(e.y)).getDay();e.m=0,e.d="W"in e?(e.w+6)%7+7*e.W-(i+5)%7:e.w+7*e.U-(i+6)%7}return"Z"in e?(e.H+=0|e.Z/100,e.M+=e.Z%100,z(e)):t(e)}}function A(l,t,n,e){for(var d,i,o=0,c=t.length,a=n.length;o<c;){if(e>=a)return-1;if(37===(d=t.charCodeAt(o++))){if(d=t.charAt(o++),!(i=b[d in Zi?t.charAt(o++):d])||0>(e=i(l,n,e)))return-1;}else if(d!=n.charCodeAt(e++))return-1}return e}var r=k.dateTime,i=k.date,o=k.time,e=k.periods,n=k.days,a=k.shortDays,s=k.months,l=k.shortMonths,c=E(e),u=D(e),p=E(n),_=D(n),h=E(a),y=D(a),d=E(s),m=D(s),g=E(l),f=D(l),x={a:function(e){return a[e.getDay()]},A:function(e){return n[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Qa,e:Qa,H:ui,I:el,j:tl,L:nl,m:ol,M:al,p:function(n){return e[+(12<=n.getHours())]},S:il,U:ll,w:rl,W:dl,x:null,X:null,y:sl,Y:cl,Z:ul,"%":Cl},v={a:function(e){return a[e.getUTCDay()]},A:function(e){return n[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:_l,e:_l,H:pl,I:hl,j:gl,L:yl,m:ml,M:fl,p:function(n){return e[+(12<=n.getUTCHours())]},S:xl,U:vl,w:bl,W:wl,x:null,X:null,y:Tl,Y:kl,Z:Sl,"%":Cl},b={a:function(o,t,n){var e=h.exec(t.slice(n));return e?(o.w=y[e[0].toLowerCase()],n+e[0].length):-1},A:function(o,t,n){var e=p.exec(t.slice(n));return e?(o.w=_[e[0].toLowerCase()],n+e[0].length):-1},b:function(o,t,n){var e=g.exec(t.slice(n));return e?(o.m=f[e[0].toLowerCase()],n+e[0].length):-1},B:function(o,t,n){var e=d.exec(t.slice(n));return e?(o.m=m[e[0].toLowerCase()],n+e[0].length):-1},c:function(o,t,n){return A(o,r,t,n)},d:Ba,e:Ba,H:Wa,I:Wa,j:Za,L:Ja,m:$a,M:Ra,p:function(o,t,n){var e=c.exec(t.slice(n));return e?(o.p=u[e[0].toLowerCase()],n+e[0].length):-1},S:Ga,U:P,w:F,W:L,x:function(o,t,n){return A(o,i,t,n)},X:function(a,t,n){return A(a,o,t,n)},y:Ia,Y:N,Z:Va,"%":Ka};return x.x=S(i,x),x.X=S(o,x),x.c=S(r,x),v.x=S(i,v),v.X=S(o,v),v.c=S(r,v),{format:function(n){var t=S(n+="",x);return t.toString=function(){return n},t},parse:function(e){var t=U(e+="",C);return t.toString=function(){return e},t},utcFormat:function(n){var t=S(n+="",v);return t.toString=function(){return n},t},utcParse:function(e){var t=U(e,z);return t.toString=function(){return e},t}}}function U(a,l,n){var e=0>a?"-":"",r=(e?-a:a)+"",i=r.length;return e+(i<n?Array(n-i+1).join(l)+r:r)}function Y(e){return e.replace(Ji,"\\$&")}function E(e){return new RegExp("^(?:"+e.map(Y).join("|")+")","i")}function D(o){for(var t={},n=-1,e=o.length;++n<e;)t[o[n].toLowerCase()]=n;return t}function F(o,t,n){var e=Wi.exec(t.slice(n,n+1));return e?(o.w=+e[0],n+e[0].length):-1}function P(o,t,n){var e=Wi.exec(t.slice(n));return e?(o.U=+e[0],n+e[0].length):-1}function L(o,t,n){var e=Wi.exec(t.slice(n));return e?(o.W=+e[0],n+e[0].length):-1}function N(o,t,n){var e=Wi.exec(t.slice(n,n+4));return e?(o.y=+e[0],n+e[0].length):-1}function Ia(o,t,n){var e=Wi.exec(t.slice(n,n+2));return e?(o.y=+e[0]+(68<+e[0]?1900:2e3),n+e[0].length):-1}function Va(o,t,n){var e=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(t.slice(n,n+6));return e?(o.Z=e[1]?0:-(e[2]+(e[3]||"00")),n+e[0].length):-1}function $a(o,t,n){var e=Wi.exec(t.slice(n,n+2));return e?(o.m=e[0]-1,n+e[0].length):-1}function Ba(o,t,n){var e=Wi.exec(t.slice(n,n+2));return e?(o.d=+e[0],n+e[0].length):-1}function Za(o,t,n){var e=Wi.exec(t.slice(n,n+3));return e?(o.m=0,o.d=+e[0],n+e[0].length):-1}function Wa(o,t,n){var e=Wi.exec(t.slice(n,n+2));return e?(o.H=+e[0],n+e[0].length):-1}function Ra(o,t,n){var e=Wi.exec(t.slice(n,n+2));return e?(o.M=+e[0],n+e[0].length):-1}function Ga(o,t,n){var e=Wi.exec(t.slice(n,n+2));return e?(o.S=+e[0],n+e[0].length):-1}function Ja(o,t,n){var e=Wi.exec(t.slice(n,n+3));return e?(o.L=+e[0],n+e[0].length):-1}function Ka(o,t,n){var e=Gi.exec(t.slice(n,n+1));return e?n+e[0].length:-1}function Qa(e,t){return U(e.getDate(),t,2)}function ui(e,t){return U(e.getHours(),t,2)}function el(e,t){return U(e.getHours()%12||12,t,2)}function tl(e,t){return U(1+wi.count(Ti(e),e),t,3)}function nl(e,t){return U(e.getMilliseconds(),t,3)}function ol(e,t){return U(e.getMonth()+1,t,2)}function al(e,t){return U(e.getMinutes(),t,2)}function il(e,t){return U(e.getSeconds(),t,2)}function ll(e,t){return U(xi.count(Ti(e),e),t,2)}function rl(e){return e.getDay()}function dl(e,t){return U(bi.count(Ti(e),e),t,2)}function sl(e,t){return U(e.getFullYear()%100,t,2)}function cl(e,t){return U(e.getFullYear()%1e4,t,4)}function ul(e){var t=e.getTimezoneOffset();return(0<t?"-":(t*=-1,"+"))+U(0|t/60,"0",2)+U(t%60,"0",2)}function _l(e,t){return U(e.getUTCDate(),t,2)}function pl(e,t){return U(e.getUTCHours(),t,2)}function hl(e,t){return U(e.getUTCHours()%12||12,t,2)}function gl(e,t){return U(1+ki.count(Si(e),e),t,3)}function yl(e,t){return U(e.getUTCMilliseconds(),t,3)}function ml(e,t){return U(e.getUTCMonth()+1,t,2)}function fl(e,t){return U(e.getUTCMinutes(),t,2)}function xl(e,t){return U(e.getUTCSeconds(),t,2)}function vl(e,t){return U(Ai.count(Si(e),e),t,2)}function bl(e){return e.getUTCDay()}function wl(e,t){return U(Ni.count(Si(e),e),t,2)}function Tl(e,t){return U(e.getUTCFullYear()%100,t,2)}function kl(e,t){return U(e.getUTCFullYear()%1e4,t,4)}function Sl(){return"+0000"}function Cl(){return"%"}function zl(e){return $i=A(e),oo.timeFormat=$i.format,oo.timeParse=$i.parse,Oi=$i.utcFormat,ji=$i.utcParse,$i}function Nt(){}function Ml(a,t){var l=new Nt;if(a instanceof Nt)a.each(function(e,t){l.set(t,e)});else if(Array.isArray(a)){var e,n=-1,i=a.length;if(null==t)for(;++n<i;)l.set(n,a[n]);else for(;++n<i;)l.set(t(e=a[n],n,a),e)}else if(a)for(var o in a)l.set(o,a[o]);return l}function Ct(){}function Ul(o,t){var n=Object.create(o.prototype);for(var e in t)n[e]=t[e];return n}function Et(){}function Dt(e){var t;return e=(e+"").trim().toLowerCase(),(t=ro.exec(e))?(t=parseInt(t[1],16),new Lt(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)):(t=ao.exec(e))?Ut(parseInt(t[1],16)):(t=so.exec(e))?new Lt(t[1],t[2],t[3],1):(t=co.exec(e))?new Lt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=lo.exec(e))?Yt(t[1],t[2],t[3],t[4]):(t=ho.exec(e))?Yt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=fo.exec(e))?Ht(t[1],t[2]/100,t[3]/100,1):(t=po.exec(e))?Ht(t[1],t[2]/100,t[3]/100,t[4]):_o.hasOwnProperty(e)?Ut(_o[e]):"transparent"===e?new Lt(NaN,NaN,NaN,0):null}function Ut(e){return new Lt(255&e>>16,255&e>>8,255&e,1)}function Yt(o,t,n,e){return 0>=e&&(o=t=n=NaN),new Lt(o,t,n,e)}function Ft(e){return e instanceof Et||(e=Dt(e)),e?(e=e.rgb(),new Lt(e.r,e.g,e.b,e.opacity)):new Lt}function Pt(o,t,n,e){return 1===arguments.length?Ft(o):new Lt(o,t,n,null==e?1:e)}function Lt(o,a,i,l){this.r=+o,this.g=+a,this.b=+i,this.opacity=+l}function Ht(o,t,n,e){return 0>=e?o=t=n=NaN:0>=n||1<=n?o=t=NaN:0>=t&&(o=NaN),new qt(o,t,n,e)}function Xt(l){if(l instanceof qt)return new qt(l.h,l.s,l.l,l.opacity);if(l instanceof Et||(l=Dt(l)),!l)return new qt;if(l instanceof qt)return l;var d=(l=l.rgb()).r/255,n=l.g/255,e=l.b/255,r=Ir(d,n,e),i=Wr(d,n,e),o=NaN,c=i-r,a=(i+r)/2;return c?(o=d===i?(n-e)/c+6*(n<e):n===i?(e-d)/c+2:(d-n)/c+4,c/=.5>a?i+r:2-i-r,o*=60):c=0<a&&1>a?0:o,new qt(o,c,a,l.opacity)}function qt(o,a,i,l){this.h=+o,this.s=+a,this.l=+i,this.opacity=+l}function It(o,t,n){return 255*(60>o?t+(n-t)*o/60:180>o?n:240>o?t+(n-t)*(240-o)/60:t)}function $t(a){if(a instanceof Ot)return new Ot(a.l,a.a,a.b,a.opacity);if(a instanceof Wt){var t=a.h*vo;return new Ot(a.l,jr(t)*a.c,Or(t)*a.c,a.opacity)}a instanceof Lt||(a=Ft(a));var n=Bt(a.r),e=Bt(a.g),l=Bt(a.b),i=jt((.4124564*n+.3575761*e+.1804375*l)/mo),o=jt((.2126729*n+.7151522*e+.072175*l)/go);return new Ot(116*o-16,500*(i-o),200*(o-jt((.0193339*n+.119192*e+.9503041*l)/wo)),a.opacity)}function Ot(o,a,i,l){this.l=+o,this.a=+a,this.b=+i,this.opacity=+l}function jt(e){return e>To?Vr(e,1/3):e/Mo+xo}function Vt(e){return e>bo?e*e*e:Mo*(e-xo)}function Rt(e){return 255*(.0031308>=e?12.92*e:1.055*Vr(e,1/2.4)-.055)}function Bt(e){return .04045>=(e/=255)?e/12.92:Vr((e+.055)/1.055,2.4)}function Zt(e){if(e instanceof Wt)return new Wt(e.h,e.c,e.l,e.opacity);e instanceof Ot||(e=$t(e));var t=Nr(e.b,e.a)*yo;return new Wt(0>t?t+360:t,Xr(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Wt(o,a,i,l){this.h=+o,this.c=+a,this.l=+i,this.opacity=+l}function Gt(l){if(l instanceof Kt)return new Kt(l.h,l.s,l.l,l.opacity);l instanceof Lt||(l=Ft(l));var t=l.r/255,n=l.g/255,e=l.b/255,r=(Do*e+zo*t-Eo*n)/(Do+zo-Eo),i=e-r,o=(Co*(n-r)-No*i)/So,d=Xr(o*o+i*i)/(Co*r*(1-r)),a=d?Nr(o,i)*yo-120:NaN;return new Kt(0>a?a+360:a,d,r,l.opacity)}function Jt(o,t,n,e){return 1===arguments.length?Gt(o):new Kt(o,t,n,null==e?1:e)}function Kt(o,a,i,l){this.h=+o,this.s=+a,this.l=+i,this.opacity=+l}function Qt(o,t){return function(n){return o+n*t}}function tn(o,t,n){return o=Vr(o,n),t=Vr(t,n)-o,n=1/n,function(e){return Vr(o+e*t,n)}}function nn(o){return 1==(o=+o)?en:function(t,n){return n-t?tn(t,n,o):Lo(isNaN(t)?n:t)}}function en(o,t){var n=t-o;return n?Qt(o,n):Lo(isNaN(o)?t:o)}function rn(e){return function(){return e}}function on(e){return function(t){return e(t)+""}}function un(l,d,n,c){function _(e){return e.length?e.pop()+" ":""}function t(e,t,l,i,r,c){if(e!==l||t!==i){var a=r.push("translate(",null,d,null,n);c.push({i:a-4,x:Io(e,l)},{i:a-2,x:Io(t,i)})}else(l||i)&&r.push("translate("+l+d+i+n)}function o(a,t,n,e){a===t?t&&n.push(_(n)+"rotate("+t+c):(180<a-t?t+=360:180<t-a&&(a+=360),e.push({i:n.push(_(n)+"rotate(",null,c)-2,x:Io(a,t)}))}function u(a,t,n,e){a===t?t&&n.push(_(n)+"skewX("+t+c):e.push({i:n.push(_(n)+"skewX(",null,c)-2,x:Io(a,t)})}function a(i,t,n,e,l,o){if(i!==n||t!==e){var r=l.push(_(l)+"scale(",null,",",null,")");o.push({i:r-4,x:Io(i,n)},{i:r-2,x:Io(t,e)})}else 1===n&&1===e||l.push(_(l)+"scale("+n+","+e+")")}return function(d,n){var s=[],r=[];return d=l(d),n=l(n),t(d.translateX,d.translateY,n.translateX,n.translateY,s,r),o(d.rotate,n.rotate,s,r),u(d.skewX,n.skewX,s,r),a(d.scaleX,d.scaleY,n.scaleX,n.scaleY,s,r),d=n=null,function(a){for(var t,n=-1,e=r.length;++n<e;)s[(t=r[n]).i]=t.x(a);return s.join("")}}}function an(e){return((e=Hr(e))+1/e)/2}function sn(e){return((e=Hr(e))-1/e)/2}function cn(e){return((e=Hr(2*e))-1)/(e+1)}function ln(l){return function t(d){function n(e,t){var n=l((e=Jt(e)).h,(t=Jt(t)).h),i=en(e.s,t.s),o=en(e.l,t.l),s=en(e.opacity,t.opacity);return function(a){return e.h=n(a),e.s=i(a),e.l=o(Vr(a,d)),e.opacity=s(a),e+""}}return d=+d,n.gamma=t,n}(1)}function hn(o,a){return(a-=o=+o)?function(t){return(t-o)/a}:nd(a)}function fn(o){return function(a,i){var l=o(a=+a,i=+i);return function(e){return e<=a?0:e>=i?1:l(e)}}}function pn(o){return function(a,i){var l=o(a=+a,i=+i);return function(e){return 0>=e?a:1<=e?i:l(e)}}}function _n(l,t,n,e){var r=l[0],i=l[1],o=t[0],d=t[1];return i<r?(r=n(i,r),o=e(d,o)):(r=n(r,i),o=e(o,d)),function(e){return o(r(e))}}function vn(l,t,n,e){var r=Ir(l.length,t.length)-1,i=Array(r),o=Array(r),d=-1;for(l[r]<l[0]&&(l=l.slice().reverse(),t=t.slice().reverse());++d<r;)i[d]=n(l[d],l[d+1]),o[d]=e(t[d],t[d+1]);return function(t){var n=Jr(l,t,1,r)-1;return o[n](i[n](t))}}function yn(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function dn(d,_){function n(){return r=2<Ir(i.length,a.length)?vn:_n,t=o=null,e}function e(e){return(t||(t=r(i,a,c?fn(d):d,s)))(+e)}var r,t,o,i=ad,a=ad,s=Ro,c=!1;return e.invert=function(e){return(o||(o=r(a,i,hn,c?pn(_):_)))(+e)},e.domain=function(e){return arguments.length?(i=to.call(e,od),n()):i.slice()},e.range=function(e){return arguments.length?(a=no.call(e),n()):a.slice()},e.rangeRound=function(e){return a=no.call(e),s=Bo,n()},e.clamp=function(e){return arguments.length?(c=!!e,n()):c},e.interpolate=function(e){return arguments.length?(s=e,n()):s},n()}function mn(e){var l=e.domain;return e.ticks=function(n){var t=l();return ei(t[0],t[t.length-1],null==n?10:n)},e.tickFormat=function(n,t){return id(l(),n,t)},e.nice=function(t){null==t&&(t=10);var n,i=l(),o=0,r=i.length-1,a=i[o],d=i[r];return d<a&&(n=a,a=d,d=n,n=o,o=r,r=n),0<(n=uo(a,d,t))?n=uo(a=$r(a/n)*n,d=Lr(d/n)*n,t):0>n&&(n=uo(a=Lr(a*n)/n,d=$r(d*n)/n,t)),0<n?(i[o]=$r(a/n)*n,i[r]=Lr(d/n)*n,l(i)):0>n&&(i[o]=Lr(a*n)/n,i[r]=$r(d*n)/n,l(i)),e},e}function gn(){var e=dn(hn,Io);return e.copy=function(){return yn(e,gn())},mn(e)}function wn(o,t){return(t=Zr(t/o))?function(n){return Zr(n/o)/t}:nd(t)}function xn(o,a){return 0>o?function(i){return-Vr(-a,i)*Vr(-o,1-i)}:function(t){return Vr(a,t)*Vr(o,1-t)}}function bn(e){return isFinite(e)?+("1e"+e):0>e?0:e}function Mn(e){return 10===e?bn:e===Fr?Hr:function(t){return Vr(e,t)}}function Tn(e){return e===Fr?Zr:10===e&&Math.log10||2===e&&Math.log2||(e=Zr(e),function(t){return Zr(t)/e})}function kn(e){return function(t){return-e(-t)}}function An(){function a(){return i=Tn(g),o=Mn(g),0>d()[0]&&(i=kn(i),o=kn(o)),t}var t=dn(wn,xn).domain([1,10]),d=t.domain,g=10,i=Tn(10),o=Mn(10);return t.base=function(e){return arguments.length?(g=+e,a()):g},t.domain=function(e){return arguments.length?(d(e),a()):d()},t.ticks=function(r){var u,n=d(),e=n[0],a=n[n.length-1];(u=a<e)&&(h=e,e=a,a=h);var s,c,l,h=i(e),y=i(a),p=null==r?10:+r,_=[];if(!(!(g%1)&&y-h<p))_=ei(h,y,Ir(y-h,p)).map(o);else if(h=Er(h)-1,y=Er(y)+1,0<e){for(;h<y;++h)for(c=1,s=o(h);c<g;++c)if(!((l=s*c)<e)){if(l>a)break;_.push(l)}}else for(;h<y;++h)for(c=g-1,s=o(h);1<=c;--c)if(!((l=s*c)<e)){if(l>a)break;_.push(l)}return u?_.reverse():_},t.tickFormat=function(e,l){if(null==l&&(l=10===g?".0e":","),"function"!=typeof l&&(l=oo.format(l)),e===1/0)return l;null==e&&(e=10);var d=Wr(1,g*e/t.ticks().length);return function(e){var t=e/o(Er(i(e)));return t*g<g-.5&&(t*=g),t<=d?l(e):""}},t.nice=function(){return d(ld(d(),{floor:function(e){return o($r(i(e)))},ceil:function(e){return o(Lr(i(e)))}}))},t.copy=function(){return yn(t,An().base(g))},t}function Nn(e,o){return 0>e?-Vr(-e,o):Vr(e,o)}function Sn(){var o=1,t=dn(function(t,n){return(n=Nn(n,o)-(t=Nn(t,o)))?function(e){return(Nn(e,o)-t)/n}:nd(n)},function(t,n){return n=Nn(n,o)-(t=Nn(t,o)),function(e){return Nn(t+n*e,1/o)}}),a=t.domain;return t.exponent=function(e){return arguments.length?(o=+e,a(a())):o},t.copy=function(){return yn(t,Sn().exponent(o))},mn(t)}function Cn(e){return new Date(e)}function zn(e){return e instanceof Date?+e:+new Date(+e)}function En(T,t,n,e,i,o,u,r,a){function s(a){return(u(a)<a?_:o(a)<a?f:i(a)<a?y:e(a)<a?d:t(a)<a?n(a)<a?m:g:T(a)<a?v:x)(a)}function l(t,l,e,i){if(null==t&&(t=10),"number"==typeof t){var o=qr(e-l)/t,d=Gr(function(e){return e[2]}).right(b,o);d===b.length?(i=Oa(l/pd,e/pd,t),t=T):d?(i=(d=b[o/b[d-1][2]<b[d][2]/o?d-1:d])[1],t=d[0]):(i=Oa(l,e,t),t=r)}return null==i?t:t.every(i)}var c=dn(hn,Io),h=c.invert,p=c.domain,_=a(".%L"),f=a(":%S"),y=a("%I:%M"),d=a("%I %p"),m=a("%a %d"),g=a("%b %d"),v=a("%B"),x=a("%Y"),b=[[u,1,rd],[u,5,5*rd],[u,15,15*rd],[u,30,30*rd],[o,1,dd],[o,5,5*dd],[o,15,15*dd],[o,30,30*dd],[i,1,sd],[i,3,3*sd],[i,6,6*sd],[i,12,12*sd],[e,1,cd],[e,2,2*cd],[n,1,ud],[t,1,_d],[t,3,3*_d],[T,1,pd]];return c.invert=function(e){return new Date(h(e))},c.domain=function(e){return arguments.length?p(to.call(e,zn)):p().map(Cn)},c.ticks=function(a,t){var n,e=p(),r=e[0],i=e[e.length-1],o=i<r;return o&&(n=r,r=i,i=n),n=l(a,r,i,t),n=n?n.range(r,i+1):[],o?n.reverse():n},c.tickFormat=function(e,t){return null==t?s:a(t)},c.nice=function(o,t){var n=p();return(o=l(o,n[0],n[n.length-1],t))?p(ld(n,o)):c},c.copy=function(){return yn(c,En(T,t,n,e,i,o,u,r,a))},c}function Dn(e){return"translate("+(e+.5)+",0)"}function Un(e){return"translate(0,"+(e+.5)+")"}function Yn(e){return function(t){return+e(t)}}function Fn(o){var t=Wr(0,o.bandwidth()-1)/2;return o.round()&&(t=Er(t)),function(n){return+o(n)+t}}function Pn(){return!this.__axis}function Ln(S,C){function n(n){var l=null==r?C.ticks?C.ticks.apply(C,z):C.domain():r,c=null==i?C.tickFormat?C.tickFormat.apply(C,z):yd:i,p=Wr(o,0)+a,_=C.range(),h=+_[0]+.5,y=+_[_.length-1]+.5,d=(C.bandwidth?Fn:Yn)(C.copy()),m=n.selection?n.selection():n,g=m.selectAll(".domain").data([null]),f=m.selectAll(".tick").data(l,C).order(),x=f.exit(),v=f.enter().append("g").attr("class","tick"),b=f.select("line"),w=f.select("text");g=g.merge(g.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),f=f.merge(v),b=b.merge(v.append("line").attr("stroke","#000").attr(s+"2",t*o)),w=w.merge(v.append("text").attr("fill","#000").attr(s,t*p).attr("dy",S===md?"0em":S===xd?"0.71em":"0.32em")),n!==m&&(g=g.transition(n),f=f.transition(n),b=b.transition(n),w=w.transition(n),x=x.transition(n).attr("opacity",bd).attr("transform",function(n){return isFinite(n=d(n))?e(n):this.getAttribute("transform")}),v.attr("opacity",bd).attr("transform",function(o){var t=this.parentNode.__axis;return e(t&&isFinite(t=t(o))?t:d(o))})),x.remove(),g.attr("d",S===vd||S==fd?"M"+t*u+","+h+"H0.5V"+y+"H"+t*u:"M"+h+","+t*u+"V0.5H"+y+"V"+t*u),f.attr("opacity",1).attr("transform",function(n){return e(d(n))}),b.attr(s+"2",t*o),w.attr(s,t*p).text(c),m.filter(Pn).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",S===fd?"start":S===vd?"end":"middle"),m.each(function(){this.__axis=d})}var z=[],r=null,i=null,o=6,u=6,a=3,t=S===md||S===vd?-1:1,s=S===vd||S===fd?"x":"y",e=S===md||S===xd?Dn:Un;return n.scale=function(e){return arguments.length?(C=e,n):C},n.ticks=function(){return z=gd.call(arguments),n},n.tickArguments=function(e){return arguments.length?(z=null==e?[]:gd.call(e),n):z.slice()},n.tickValues=function(e){return arguments.length?(r=null==e?null:gd.call(e),n):r&&r.slice()},n.tickFormat=function(e){return arguments.length?(i=e,n):i},n.tickSize=function(e){return arguments.length?(o=u=+e,n):o},n.tickSizeInner=function(e){return arguments.length?(o=+e,n):o},n.tickSizeOuter=function(e){return arguments.length?(u=+e,n):u},n.tickPadding=function(e){return arguments.length?(a=+e,n):a},n}function Hn(){for(var o,t=0,n=arguments.length,e={};t<n;++t){if(!(o=arguments[t]+"")||o in e)throw new Error("illegal type: "+o);e[o]=[]}return new Xn(e)}function Xn(e){this._=e}function Al(e,o){return e.trim().split(/^|\s+/).map(function(n){var a="",i=n.indexOf(".");if(0<=i&&(a=n.slice(i+1),n=n.slice(0,i)),n&&!o.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:a}})}function In(o,t){for(var n,e=0,a=o.length;e<a;++e)if((n=o[e]).name===t)return n.value}function $n(o,t,a){for(var l=0,r=o.length;l<r;++l)if(o[l].name===t){o[l]=wd,o=o.slice(0,l).concat(o.slice(l+1));break}return null!=a&&o.push({name:t,value:a}),o}function On(o){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Td&&t.documentElement.namespaceURI===Td?t.createElement(o):t.createElementNS(n,o)}}function jn(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Vn(o,t,n){return o=Rn(o,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||o.call(this,t)}}function Rn(t,n,e){return function(a){var i=oo.event;oo.event=a;try{t.call(this,this.__data__,n,e)}finally{oo.event=i}}}function Bn(e){return e.trim().split(/^|\s+/).map(function(o){var a="",i=o.indexOf(".");return 0<=i&&(a=o.slice(i+1),o=o.slice(0,i)),{type:o,name:a}})}function Zn(a){return function(){var t=this.__on;if(t){for(var n,e=0,l=-1,i=t.length;e<i;++e)n=t[e],a.type&&n.type!==a.type||n.name!==a.name?t[++l]=n:this.removeEventListener(n.type,n.listener,n.capture);++l?t.length=l:delete this.__on}}}function Wn(d,t,_){var p=Yd.hasOwnProperty(d.type)?Vn:Rn;return function(r,i,o){var u,a=this.__on,s=p(t,i,o);if(a)for(var g=0,l=a.length;g<l;++g)if((u=a[g]).type===d.type&&u.name===d.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=s,u.capture=_),void(u.value=t);this.addEventListener(d.type,s,_),u={type:d.type,name:d.name,value:t,listener:s,capture:_},a?a.push(u):this.__on=[u]}}function Gn(t,n,e,a){var i=oo.event;t.sourceEvent=oo.event,oo.event=t;try{return n.apply(e,a)}finally{oo.event=i}}function Jn(){}function Kn(){return[]}function Qn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Yl(l,t,n,e,r,i){for(var o,d=0,a=t.length,s=i.length;d<s;++d)(o=t[d])?(o.__data__=i[d],e[d]=o):n[d]=new Qn(l,i[d]);for(;d<a;++d)(o=t[d])&&(r[d]=o)}function ne(d,t,n,e,r,i,o){var u,a,s,c={},l=t.length,_=i.length,h=Array(l);for(u=0;u<l;++u)(a=t[u])&&(h[u]=s=Nd+o.call(a,a.__data__,u,t),s in c?r[u]=a:c[s]=a);for(u=0;u<_;++u)(a=c[s=Nd+o.call(d,i[u],u,i)])?(e[u]=a,a.__data__=i[u],c[s]=null):n[u]=new Qn(d,i[u]);for(u=0;u<l;++u)(a=t[u])&&c[h[u]]===a&&(r[u]=a)}function ee(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function re(e){return function(){this.removeAttribute(e)}}function ie(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oe(e,t){return function(){this.setAttribute(e,t)}}function ue(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ae(o,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(o):this.setAttribute(o,n)}}function se(o,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(o.space,o.local):this.setAttributeNS(o.space,o.local,n)}}function ce(e){return function(){this.style.removeProperty(e)}}function le(o,t,n){return function(){this.style.setProperty(o,t,n)}}function he(o,t,n){return function(){var e=t.apply(this,arguments);null==e?this.style.removeProperty(o):this.style.setProperty(o,e,n)}}function fe(e,t){return e.style.getPropertyValue(t)||Od(e).getComputedStyle(e,null).getPropertyValue(t)}function pe(e){return function(){delete this[e]}}function _e(e,t){return function(){this[e]=t}}function ve(o,t){return function(){var n=t.apply(this,arguments);null==n?delete this[o]:this[o]=n}}function ye(e){return e.trim().split(/^|\s+/)}function de(e){return e.classList||new me(e)}function me(e){this._node=e,this._names=ye(e.getAttribute("class")||"")}function ge(o,t){for(var n=de(o),e=-1,a=t.length;++e<a;)n.add(t[e])}function we(o,t){for(var n=de(o),e=-1,a=t.length;++e<a;)n.remove(t[e])}function xe(e){return function(){ge(this,e)}}function be(e){return function(){we(this,e)}}function Me(e,t){return function(){(t.apply(this,arguments)?ge:we)(this,e)}}function Te(){this.textContent=""}function ke(e){return function(){this.textContent=e}}function Ae(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Ne(){this.innerHTML=""}function Se(e){return function(){this.innerHTML=e}}function Ce(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ze(){this.nextSibling&&this.parentNode.appendChild(this)}function Ee(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function De(){return null}function Ue(){var e=this.parentNode;e&&e.removeChild(this)}function Ye(o,t,n){var e=Od(o),a=e.CustomEvent;"function"==typeof a?a=new a(t,n):(a=e.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),o.dispatchEvent(a)}function Fe(e,t){return function(){return Ye(this,e,t)}}function Pe(e,t){return function(){return Ye(this,e,t.apply(this,arguments))}}function Le(e,t){this._groups=e,this._parents=t}function El(){return new Le([[document.documentElement]],jd)}function Xe(){oo.event.stopImmediatePropagation()}function qe(o,t){var n=o.document.documentElement,e=Id(o).on("dragstart.drag",null);t&&(e.on("click.drag",Vd,!0),setTimeout(function(){e.on("click.drag",null)},0)),"onselectstart"in n?e.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Ie(l,t,n,e,r,i,o,d,a,s){this.target=l,this.type=t,this.subject=n,this.identifier=e,this.active=r,this.x=i,this.y=o,this.dx=d,this.dy=a,this._=s}function $e(){return!oo.event.button}function Oe(){return this.parentNode}function je(e){return null==e?{x:oo.event.x,y:oo.event.y}:e}function Ve(){return"ontouchstart"in this}function Re(){return ta||(ra(Be),ta=ea.now()+na)}function Be(){ta=0}function Ze(){this._call=this._time=this._next=null}function Dl(o,t,n){var e=new Ze;return e.restart(o,t,n),e}function Ge(){Re(),++Rd;for(var e,t=Zd;t;)0<=(e=ta-t._time)&&t._call.call(null,e),t=t._next;--Rd}function Je(){ta=(Qd=ea.now())+na,Rd=Gd=0;try{Ge()}finally{Rd=0,Qe(),ta=0}}function Ke(){var e=ea.now(),t=e-Qd;t>Kd&&(na-=t,Qd=e)}function Qe(){for(var o,t,n=Zd,e=1/0;n;)n._call?(e>n._time&&(e=n._time),o=n,n=n._next):(t=n._next,n._next=null,n=o?o._next=t:Zd=t);Wd=o,Fl(e)}function Fl(e){if(!Rd){Gd&&(Gd=clearTimeout(Gd));var t=e-ta;24<t?(e<1/0&&(Gd=setTimeout(Je,t)),Jd&&(Jd=clearInterval(Jd))):(Jd||(Qd=ta,Jd=setInterval(Ke,Kd)),Rd=1,ra(Je))}}function Pl(o,t){var n=o.__transition;if(!n||!(n=n[t])||n.state>ts)throw new Error("too late");return n}function Ll(o,t){var n=o.__transition;if(!n||!(n=n[t])||n.state>ca)throw new Error("too late");return n}function Hl(o,t){var n=o.__transition;if(!n||!(n=n[t]))throw new Error("too late");return n}function Xl(d,t,_){function e(a){var r,s,l,u;if(_.state!==ns)return p();for(r in i)if((u=i[r]).name===_.name){if(u.state===la)return ia(e);u.state===ha?(u.state=pa,u.timer.stop(),u.on.call("interrupt",d,d.__data__,u.index,u.group),delete i[r]):+r<t&&(u.state=pa,u.timer.stop(),delete i[r])}if(ia(function(){_.state===la&&(_.state=ha,_.timer.restart(n,_.delay,_.time),n(a))}),_.state=ca,_.on.call("start",d,d.__data__,_.index,_.group),_.state===ca){for(_.state=la,o=Array(l=_.tween.length),r=0,s=-1;r<l;++r)(u=_.tween[r].value.call(d,d.__data__,_.index,_.group))&&(o[++s]=u);o.length=s+1}}function n(e){for(var t=e<_.duration?_.ease.call(null,e/_.duration):(_.timer.restart(p),_.state=fa,1),n=-1,l=o.length;++n<l;)o[n].call(null,t);_.state===fa&&(_.on.call("end",d,d.__data__,_.index,_.group),p())}function p(){for(var e in _.state=pa,_.timer.stop(),delete i[t],i)return;delete d.__transition}var o,i=d.__transition;i[t]=_,_.timer=Dl(function(n){_.state=ns,_.timer.restart(e,_.delay,_.time),_.delay<=n&&e(n-_.delay)},0,_.time)}function Nl(l,t){var n,e;return function(){var r=Ll(this,l),i=r.tween;if(i!==n)for(var o=0,d=(e=n=i).length;o<d;++o)if(e[o].name===t){(e=e.slice()).splice(o,1);break}r.tween=e}}function Ol(l,t,o){var d,r;if("function"!=typeof o)throw new Error;return function(){var i=Ll(this,l),_=i.tween;if(_!==d){r=(d=_).slice();for(var u={name:t,value:o},a=0,s=r.length;a<s;++a)if(r[a].name===t){r[a]=u;break}a===s&&r.push(u)}i.tween=r}}function jl(o,a,n){var e=o._id;return o.each(function(){var o=Ll(this,e);(o.value||(o.value={}))[a]=n.apply(this,arguments)}),function(n){return Hl(n,e).value[a]}}function Il(e){return function(){this.removeAttribute(e)}}function ql(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Vl(a,t,n){var e,l;return function(){var i=this.getAttribute(a);return i===n?null:i===e?l:l=t(e=i,n)}}function $l(a,t,n){var e,l;return function(){var i=this.getAttributeNS(a.space,a.local);return i===n?null:i===e?l:l=t(e=i,n)}}function Bl(l,t,n){var e,r,i;return function(){var o,d=n(this);{if(null!=d)return(o=this.getAttribute(l))===d?null:o===e&&d===r?i:i=t(e=o,r=d);this.removeAttribute(l)}}}function Zl(l,t,n){var e,r,i;return function(){var o,d=n(this);{if(null!=d)return(o=this.getAttributeNS(l.space,l.local))===d?null:o===e&&d===r?i:i=t(e=o,r=d);this.removeAttributeNS(l.space,l.local)}}}function Wl(o,t){function n(){var a=this,i=t.apply(a,arguments);return i&&function(e){a.setAttributeNS(o.space,o.local,i(e))}}return n._value=t,n}function Rl(o,t){function n(){var a=this,i=t.apply(a,arguments);return i&&function(e){a.setAttribute(o,i(e))}}return n._value=t,n}function Gl(e,t){return function(){Pl(this,e).delay=+t.apply(this,arguments)}}function Jl(e,t){return t=+t,function(){Pl(this,e).delay=t}}function Kl(e,t){return function(){Ll(this,e).duration=+t.apply(this,arguments)}}function Ql(e,t){return t=+t,function(){Ll(this,e).duration=t}}function er(e,t){if("function"!=typeof t)throw new Error;return function(){Ll(this,e).ease=t}}function tr(e){return(e+"").trim().split(/^|\s+/).every(function(e){var o=e.indexOf(".");return 0<=o&&(e=e.slice(0,o)),!e||"start"===e})}function nr(l,t,n){var e,r,i=tr(t)?Pl:Ll;return function(){var o=i(this,l),d=o.on;d!==e&&(r=(e=d).copy()).on(t,n),o.on=r}}function or(n){return function(){var t=this.parentNode;for(var o in this.__transition)if(+o!==n)return;t&&t.removeChild(this)}}function ar(a,t){var n,e,l;return function(){var i=fe(this,a),o=(this.style.removeProperty(a),fe(this,a));return i===o?null:i===n&&o===e?l:l=t(n=i,e=o)}}function ir(e){return function(){this.style.removeProperty(e)}}function lr(a,t,n){var e,l;return function(){var i=fe(this,a);return i===n?null:i===e?l:l=t(e=i,n)}}function rr(l,t,n){var e,r,i;return function(){var o=fe(this,l),d=n(this);return null==d&&(this.style.removeProperty(l),d=fe(this,l)),o===d?null:o===e&&d===r?i:i=t(e=o,r=d)}}function dr(o,t,a){function e(){var e=this,l=t.apply(e,arguments);return l&&function(t){e.style.setProperty(o,l(t),a)}}return e._value=t,e}function sr(e){return function(){this.textContent=e}}function cr(e){return function(){var t=e(this);this.textContent=null==t?"":t}}function ur(o,t,n,e){this._groups=o,this._parents=t,this._name=n,this._id=e}function _r(){return++ma}function pr(o,t){for(var n;!(n=o.__transition)||!(n=n[t]);)if(!(o=o.parentNode))return xa.time=Re(),xa;return n}function hr(o,t,n){this.target=o,this.type=t,this.transform=n}function gr(o,t,n){this.k=o,this.x=t,this.y=n}function yr(e){return e.__zoom||Ma}function mr(){oo.event.stopImmediatePropagation()}function fr(){return!oo.event.button}function xr(){var o,t,n=this;return n instanceof SVGElement?(o=(n=n.ownerSVGElement||n).width.baseVal.value,t=n.height.baseVal.value):(o=n.clientWidth,t=n.clientHeight),[[0,0],[o,t]]}function vr(){return this.__zoom||Ma}function br(){return-oo.event.deltaY*(oo.event.deltaMode?120:1)/500}function wr(){return"ontouchstart"in this}function Tr(){oo.event.stopImmediatePropagation()}function kr(e){return{type:e}}function Sr(){return!oo.event.button}function Cr(){var e=this.ownerSVGElement||this;return[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function zr(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function Mr(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function Ur(g){function n(n){var t=n.property("__brush",d).selectAll(".overlay").data([kr("overlay")]);t.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Fa.overlay).merge(t).each(function(){var e=zr(this).extent;Id(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])}),n.selectAll(".selection").data([kr("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Fa.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var a=n.selectAll(".handle").data(g.handles,function(e){return e.type});a.exit().remove(),a.enter().append("rect").attr("class",function(e){return"handle handle--"+e.type}).attr("cursor",function(e){return Fa[e.type]}),n.each(O).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",o)}function O(){var e=Id(this),o=zr(this).selection;o?(e.selectAll(".selection").style("display",null).attr("x",o[0][0]).attr("y",o[0][1]).attr("width",o[1][0]-o[0][0]).attr("height",o[1][1]-o[0][1]),e.selectAll(".handle").style("display",null).attr("x",function(e){return"e"===e.type[e.type.length-1]?o[1][0]-s/2:o[0][0]-s/2}).attr("y",function(e){return"s"===e.type[0]?o[1][1]-s/2:o[0][1]-s/2}).attr("width",function(e){return"n"===e.type||"s"===e.type?o[1][0]-o[0][0]+s:s}).attr("height",function(e){return"e"===e.type||"w"===e.type?o[1][1]-o[0][1]+s:s})):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function r(o,t){return o.__brush.emitter||new e(o,t)}function e(e,t){this.that=e,this.args=t,this.state=e.__brush,this.active=0}function o(){function n(){var n=Fd(x);!U||v||w||(qr(n[0]-F[0])>qr(n[1]-F[1])?w=!0:v=!0),F=n,m=!0,Na(),e()}function e(){var e;switch(y=F[0]-j[0],d=F[1]-j[1],M){case Ca:case Sa:T&&(y=Wr(C-l,Ir(E-h,y)),a=l+y,p=h+y),k&&(d=Wr(z-s,Ir(D-_,d)),c=s+d,f=_+d);break;case za:0>T?(y=Wr(C-l,Ir(E-l,y)),a=l+y,p=h):0<T&&(y=Wr(C-h,Ir(E-h,y)),a=l,p=h+y),0>k?(d=Wr(z-s,Ir(D-s,d)),c=s+d,f=_):0<k&&(d=Wr(z-_,Ir(D-_,d)),c=s,f=_+d);break;case Ea:T&&(a=Wr(C,Ir(E,l-y*T)),p=Wr(C,Ir(E,h+y*T))),k&&(c=Wr(z,Ir(D,s-d*k)),f=Wr(z,Ir(D,_+d*k)));}p<a&&(T*=-1,e=l,l=h,h=e,e=a,a=p,p=e,b in Pa&&H.attr("cursor",Fa[b=Pa[b]])),f<c&&(k*=-1,e=s,s=_,_=e,e=c,c=f,f=e,b in La&&H.attr("cursor",Fa[b=La[b]])),A.selection&&(S=A.selection),v&&(a=S[0][0],p=S[1][0]),w&&(c=S[0][1],f=S[1][1]),S[0][0]===a&&S[0][1]===c&&S[1][0]===p&&S[1][1]===f||(A.selection=[[a,c],[p,f]],O.call(x),P.brush())}function o(){if(Tr(),oo.event.touches){if(oo.event.touches.length)return;t&&clearTimeout(t),t=setTimeout(function(){t=null},500),L.on("touchmove.brush touchend.brush touchcancel.brush",null)}else qe(oo.event.view,m),X.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);L.attr("pointer-events","all"),H.attr("cursor",Fa.overlay),A.selection&&(S=A.selection),Mr(S)&&(A.selection=null,O.call(x)),P.end()}if(oo.event.touches){if(oo.event.changedTouches.length<oo.event.touches.length)return Na();}else if(t)return;if(i.apply(this,arguments)){var l,a,s,c,h,p,_,f,y,d,m,v,w,x=this,b=oo.event.target.__data__.type,M="selection"===(oo.event.metaKey?b="overlay":b)?Sa:oo.event.altKey?Ea:za,T=g===Ua?null:Ha[b],k=g===Da?null:Xa[b],A=zr(x),N=A.extent,S=A.selection,C=N[0][0],z=N[0][1],E=N[1][0],D=N[1][1],U=T&&k&&oo.event.shiftKey,j=Fd(x),F=j,P=r(x,arguments).beforestart();"overlay"===b?A.selection=S=[[l=g===Ua?C:j[0],s=g===Da?z:j[1]],[h=g===Ua?E:l,_=g===Da?D:s]]:(l=S[0][0],s=S[0][1],h=S[1][0],_=S[1][1]),a=l,c=s,p=h,f=_;var L=Id(x).attr("pointer-events","none"),H=L.selectAll(".overlay").attr("cursor",Fa[b]);if(oo.event.touches)L.on("touchmove.brush",n,!0).on("touchend.brush touchcancel.brush",o,!0);else{var X=Id(oo.event.view).on("keydown.brush",function(){switch(oo.event.keyCode){case 16:U=T&&k;break;case 18:M===za&&(T&&(h=p-y*T,l=a+y*T),k&&(_=f-d*k,s=c+d*k),M=Ea,e());break;case 32:M!==za&&M!==Ea||(0>T?h=p-y:0<T&&(l=a-y),0>k?_=f-d:0<k&&(s=c-d),M=Ca,H.attr("cursor",Fa.selection),e());break;default:return;}Na()},!0).on("keyup.brush",function(){switch(oo.event.keyCode){case 16:U&&(v=w=U=!1,e());break;case 18:M===Ea&&(0>T?h=p:0<T&&(l=a),0>k?_=f:0<k&&(s=c),M=za,e());break;case 32:M===Ca&&(oo.event.altKey?(T&&(h=p-y*T,l=a+y*T),k&&(_=f-d*k,s=c+d*k),M=Ea):(0>T?h=p:0<T&&(l=a),0>k?_=f:0<k&&(s=c),M=za),H.attr("cursor",Fa[b]),e());break;default:return;}Na()},!0).on("mousemove.brush",n,!0).on("mouseup.brush",o,!0);$d(oo.event.view)}Tr(),va(x),O.call(x),P.start()}}function d(){var e=this.__brush||{selection:null};return e.extent=a.apply(this,arguments),e.dim=g,e}var t,a=Cr,i=Sr,l=Hn(n,"start","brush","end"),s=6;return n.move=function(n,i){n.selection?n.on("start.brush",function(){r(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){r(this,arguments).end()}).tween("brush",function(){function n(e){o.selection=1===e&&Mr(a)?null:s(e),O.call(d),u.brush()}var d=this,o=d.__brush,u=r(d,arguments),t=o.selection,a=g.input("function"==typeof i?i.apply(this,arguments):i,o.extent),s=Ro(t,a);return t&&a?n:n(1)}):n.each(function(){var n=this,t=arguments,o=n.__brush,l=g.input("function"==typeof i?i.apply(n,t):i,o.extent),a=r(n,t).beforestart();va(n),o.selection=null==l||Mr(l)?null:l,O.call(n),a.start().brush().end()})},e.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){Gn(new Aa(n,e,g.output(this.state.selection)),l.apply,l,[e,this.that,this.args])}},n.extent=function(e){return arguments.length?(a="function"==typeof e?e:ka([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),n):a},n.filter=function(e){return arguments.length?(i="function"==typeof e?e:ka(!!e),n):i},n.handleSize=function(e){return arguments.length?(s=+e,n):s},n.on=function(){var e=l.on.apply(l,arguments);return e===l?n:e},n}var Ar=Math.asin,Yr=Math.PI,Er=Math.round,Fr=Math.E,Lr=Math.ceil,Hr=Math.exp,Xr=Math.sqrt,Nr=Math.atan2,Or=Math.sin,jr=Math.cos,Ir=Math.min,qr=Math.abs,Vr=Math.pow,$r=Math.floor,Br=Math.LN10,Zr=Math.log,Wr=Math.max,Rr=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Gr=function(a){return 1===a.length&&(a=io(a)),{left:function(t,n,e,l){for(null==e&&(e=0),null==l&&(l=t.length);e<l;){var i=e+l>>>1;0>a(t[i],n)?e=i+1:l=i}return e},right:function(t,n,e,l){for(null==e&&(e=0),null==l&&(l=t.length);e<l;){var i=e+l>>>1;0<a(t[i],n)?l=i:e=i+1}return e}}},Jr=Gr(Rr).right,Kr=7.0710678118654755,ti=3.1622776601683795,ni=1.4142135623730951,ei=function(e,t,n){var l,i,o,r=t<e,a=-1;if(r&&(l=e,e=t,t=l),0===(o=uo(e,t,n))||!isFinite(o))return[];if(0<o)for(e=Lr(e/o),t=$r(t/o),i=Array(l=Lr(t-e+1));++a<l;)i[a]=(e+a)*o;else for(e=$r(e*o),t=Lr(t*o),i=Array(l=Lr(e-t+1));++a<l;)i[a]=(e-a)/o;return r&&i.reverse(),i},ri=Yr,ii=2*ri;e.prototype=ja.prototype={constructor:e,moveTo:function(e,o){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+o)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,o){this._+="L"+(this._x1=+e)+","+(this._y1=+o)},quadraticCurveTo:function(o,a,i,l){this._+="Q"+ +o+","+ +a+","+(this._x1=+i)+","+(this._y1=+l)},bezierCurveTo:function(a,l,d,s,c,u){this._+="C"+ +a+","+ +l+","+ +d+","+ +s+","+(this._x1=+c)+","+(this._y1=+u)},arcTo:function(x,v,b,T,k){x=+x,v=+v,b=+b,T=+T,k=+k;var S=this._x1,o=this._y1,u=b-x,a=T-v,s=S-x,c=o-v,l=s*s+c*c;if(0>k)throw new Error("negative radius: "+k);if(null===this._x1)this._+="M"+(this._x1=x)+","+(this._y1=v);else if(!(1e-6<l));else if(1e-6<qr(c*u-a*s)&&k){var h=b-S,f=T-o,p=u*u+a*a,_=Xr(p),y=Xr(l),d=k*Math.tan((ri-Math.acos((p+l-(h*h+f*f))/(2*_*y)))/2),m=d/y,g=d/_;1e-6<qr(m-1)&&(this._+="L"+(x+m*s)+","+(v+m*c)),this._+="A"+k+","+k+",0,0,"+ +(c*h>s*f)+","+(this._x1=x+g*u)+","+(this._y1=v+g*a)}else this._+="L"+(this._x1=x)+","+(this._y1=v)},arc:function(d,_,p,g,r,i){d=+d,_=+_;var o=(p=+p)*jr(g),u=p*Or(g),a=d+o,s=_+u,c=1^i,l=i?g-r:r-g;if(0>p)throw new Error("negative radius: "+p);null===this._x1?this._+="M"+a+","+s:(1e-6<qr(this._x1-a)||1e-6<qr(this._y1-s))&&(this._+="L"+a+","+s),p&&(0>l&&(l=l%ii+ii),l>ii-1e-6?this._+="A"+p+","+p+",0,1,"+c+","+(d-o)+","+(_-u)+"A"+p+","+p+",0,1,"+c+","+(this._x1=a)+","+(this._y1=s):1e-6<l&&(this._+="A"+p+","+p+",0,"+ +(l>=ri)+","+c+","+(this._x1=d+p*jr(r))+","+(this._y1=_+p*Or(r))))},rect:function(o,a,i,l){this._+="M"+(this._x0=this._x1=+o)+","+(this._y0=this._y1=+a)+"h"+ +i+"v"+ +l+"h"+-i+"Z"},toString:function(){return this._}};var oi=function(e){return function(){return e}},ai=1e-12;n.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,o){switch(e=+e,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,o):this._context.moveTo(e,o);break;case 1:this._point=2;default:this._context.lineTo(e,o);}}};var si=function(e){return new n(e)},ci=function(){function l(n){var o,a,s,l=n.length,c=!1;for(null==r&&(u=i(s=ja())),o=0;o<=l;++o)!(o<l&&e(a=n[o],o,n))===c&&((c=!c)?u.lineStart():u.lineEnd()),c&&u.point(+d(a,o,n),+_(a,o,n));if(s)return u=null,s+""||null}var d=o,_=a,e=oi(!0),r=null,i=si,u=null;return l.x=function(t){return arguments.length?(d="function"==typeof t?t:oi(+t),l):d},l.y=function(e){return arguments.length?(_="function"==typeof e?e:oi(+e),l):_},l.defined=function(t){return arguments.length?(e="function"==typeof t?t:oi(!!t),l):e},l.curve=function(e){return arguments.length?(i=e,null!=r&&(u=i(r)),l):i},l.context=function(e){return arguments.length?(null==e?r=u=null:u=i(r=e),l):r},l};s.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:r(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,o){switch(e=+e,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,o):this._context.moveTo(e,o);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:r(this,e,o);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=o}},c.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:l(this,this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,o){switch(e=+e,o=+o,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,o):this._context.moveTo(e,o);break;case 1:this._point=2,this._x1=e,this._y1=o;break;case 2:this._point=3;default:l(this,e,o);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=o}};var li=function o(a){function t(e){return new c(e,a)}return t.tension=function(e){return o(+e)},t}(0);p.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(o,a){if(o=+o,a=+a,this._point){var i=this._x2-o,e=this._y2-a;this._l23_a=Xr(this._l23_2a=Vr(i*i+e*e,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(o,a):this._context.moveTo(o,a);break;case 1:this._point=2;break;case 2:this._point=3;default:u(this,o,a);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=o,this._y0=this._y1,this._y1=this._y2,this._y2=a}};var hi=function o(a){function t(e){return a?new p(e,a):new c(e,0)}return t.alpha=function(e){return o(+e)},t}(.5);m.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:d(this,this._t0,y(this,this._t0));}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(o,a){var i=NaN;if(o=+o,a=+a,o!==this._x1||a!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(o,a):this._context.moveTo(o,a);break;case 1:this._point=2;break;case 2:this._point=3,d(this,y(this,i=h(this,o,a)),i);break;default:d(this,this._t0,i=h(this,o,a));}this._x0=this._x1,this._x1=o,this._y0=this._y1,this._y1=a,this._t0=i}}},(function(e){this._context=new g(e)}.prototype=Object.create(m.prototype)).point=function(e,t){m.prototype.point.call(this,t,e)},g.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(a,t,n,e,l,i){this._context.bezierCurveTo(t,a,e,n,i,l)}},f.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var a=this._x,t=this._y,n=a.length;if(n)if(this._line?this._context.lineTo(a[0],t[0]):this._context.moveTo(a[0],t[0]),2===n)this._context.lineTo(a[1],t[1]);else for(var e=x(a),l=x(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(e[0][i],l[0][i],e[1][i],l[1][i],a[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,o){this._x.push(+e),this._y.push(+o)}},v.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&1>this._t&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(o,a){switch(o=+o,a=+a,this._point){case 0:this._point=1,this._line?this._context.lineTo(o,a):this._context.moveTo(o,a);break;case 1:this._point=2;default:if(0>=this._t)this._context.lineTo(this._x,a),this._context.lineTo(o,a);else{var i=this._x*(1-this._t)+o*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,a)}}this._x=o,this._y=a}};var fi=new Date,pi=new Date,_i=b(function(){},function(e,o){e.setTime(+e+o)},function(e,t){return t-e});_i.every=function(o){return o=$r(o),isFinite(o)&&0<o?1<o?b(function(e){e.setTime($r(e/o)*o)},function(t,a){t.setTime(+t+a*o)},function(t,n){return(n-t)/o}):_i:null};var vi=6e4,yi=6048e5,di=b(function(e){e.setTime(1e3*$r(e/1e3))},function(e,o){e.setTime(+e+1e3*o)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),mi=b(function(e){e.setTime($r(e/vi)*vi)},function(e,o){e.setTime(+e+o*vi)},function(e,t){return(t-e)/vi},function(e){return e.getMinutes()}),gi=b(function(e){var o=e.getTimezoneOffset()*vi%36e5;0>o&&(o+=36e5),e.setTime(36e5*$r((+e-o)/36e5)+o)},function(e,o){e.setTime(+e+36e5*o)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),wi=b(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vi)/864e5},function(e){return e.getDate()-1}),xi=t(0),bi=t(1),Mi=(t(2),t(3),t(4),t(5),t(6),b(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),Ti=b(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Ti.every=function(o){return isFinite(o=$r(o))&&0<o?b(function(e){e.setFullYear($r(e.getFullYear()/o)*o),e.setMonth(0,1),e.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*o)}):null},b(function(e){e.setUTCSeconds(0,0)},function(e,o){e.setTime(+e+o*vi)},function(e,t){return(t-e)/vi},function(e){return e.getUTCMinutes()}),b(function(e){e.setUTCMinutes(0,0,0)},function(e,o){e.setTime(+e+36e5*o)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()});var ki=b(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),Ai=w(0),Ni=w(1),Si=(w(2),w(3),w(4),w(5),w(6),b(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),b(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));Si.every=function(o){return isFinite(o=$r(o))&&0<o?b(function(e){e.setUTCFullYear($r(e.getUTCFullYear()/o)*o),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*o)}):null};var Ci,zi=function(o,t){if(0>(n=(o=t?o.toExponential(t-1):o.toExponential()).indexOf("e")))return null;var n,e=o.slice(0,n);return[1<e.length?e[0]+e.slice(2):e,+o.slice(n+1)]},Ei=function(e){return(e=zi(qr(e)))?e[1]:NaN},Di=function(l,t){return function(n,e){for(var r=n.length,i=[],o=0,d=l[0],a=0;0<r&&0<d&&(a+d+1>e&&(d=Wr(1,e-a)),i.push(n.substring(r-=d,r+d)),!((a+=d+1)>e));)d=l[o=(o+1)%l.length];return i.reverse().join(t)}},Ui=function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}},Yi=function(o,t){var n=zi(o,t);if(!n)return o+"";var a=n[0],l=n[1];return 0>l?"0."+Array(-l).join("0")+a:a.length>l+1?a.slice(0,l+1)+"."+a.slice(l+1):a+Array(l-a.length+2).join("0")},Qr={"":function(a,t){t:for(var n,e=(a=a.toPrecision(t)).length,l=1,i=-1;l<e;++l)switch(a[l]){case".":i=n=l;break;case"0":0===i&&(i=l),n=l;break;case"e":break t;default:0<i&&(i=0);}return 0<i?a.slice(0,i)+a.slice(n+1):a},"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Er(e).toString(2)},c:function(e){return e+""},d:function(e){return Er(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Er(e).toString(8)},p:function(e,t){return Yi(100*e,t)},r:Yi,s:function(a,t){var n=zi(a,t);if(!n)return a+"";var l=n[0],r=n[1],i=r-(Ci=3*Wr(-8,Ir(8,$r(r/3))))+1,o=l.length;return i===o?l:i>o?l+Array(i-o+1).join("0"):0<i?l.slice(0,i)+"."+l.slice(i):"0."+Array(1-i).join("0")+zi(a,Wr(0,t+i-1))[0]},X:function(e){return Er(e).toString(16).toUpperCase()},x:function(e){return Er(e).toString(16)}},Pi=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;T.prototype=k.prototype,k.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Wr(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Wr(0,0|this.precision))+this.type};var Li,Hi,Xi=function(e){return e},qi=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Ii=function(a){function l(u){function t(e){var o,c,g,u=U,l=y;if("c"===_)l=d(e)+l,e="";else{var v=0>(e=+e);if(e=d(qr(e),p),v&&0==+e&&(v=!1),u=(v?"("===s?s:"-":"-"===s||"("===s?"":s)+u,l=l+("s"===_?qi[8+Ci/3]:"")+(v&&"("===s?")":""),m)for(o=-1,c=e.length;++o<c;)if(48>(g=e.charCodeAt(o))||57<g){l=(46===g?r+e.slice(o+1):e.slice(o))+l,e=e.slice(0,o);break}}f&&!C&&(e=k(e,1/0));var x=u.length+e.length+l.length,b=x<z?Array(z-x+1).join(S):"";switch(f&&C&&(e=k(b+e,b.length?z-l.length:1/0),b=""),a){case"<":e=u+e+l+b;break;case"=":e=u+b+e+l;break;case"^":e=b.slice(0,x=b.length>>1)+u+e+l+b.slice(x);break;default:e=b+u+e+l;}return i(e)}var S=(u=T(u)).fill,a=u.align,s=u.sign,c=u.symbol,C=u.zero,z=u.width,f=u.comma,p=u.precision,_=u.type,U="$"===c?e[0]:"#"===c&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",y="$"===c?e[1]:/[%p]/.test(_)?o:"",d=Qr[_],m=!_||/[defgprs%]/.test(_);return p=null==p?_?6:12:/[gprs]/.test(_)?Wr(1,Ir(21,p)):Wr(0,Ir(20,p)),t.toString=function(){return u+""},t}var k=a.grouping&&a.thousands?Di(a.grouping,a.thousands):Xi,e=a.currency,r=a.decimal,i=a.numerals?Ui(a.numerals):Xi,o=a.percent||"%";return{format:l,formatPrefix:function(n,t){var e=l((n=T(n),n.type="f",n)),a=3*Wr(-8,Ir(8,$r(Ei(t)/3))),r=Vr(10,-a),o=qi[8+a/3];return function(n){return e(r*n)+o}}}};S({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var $i,Oi,ji,Vi=function(e){return Wr(0,-Ei(qr(e)))},Ri=function(e,t){return Wr(0,3*Wr(-8,Ir(8,$r(Ei(t)/3)))-Ei(qr(e)))},Bi=function(e,t){return e=qr(e),t=qr(t)-e,Wr(0,Ei(t)-Ei(e))+1},Zi={"-":"",_:" ",0:"0"},Wi=/^\s*\d+/,Gi=/^%/,Ji=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;zl({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Date.prototype.toISOString||Oi("%Y-%m-%dT%H:%M:%S.%LZ"),+new Date("2000-01-01T00:00:00.000Z")||ji("%Y-%m-%dT%H:%M:%S.%LZ"),Nt.prototype=Ml.prototype={constructor:Nt,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Ki=Ml.prototype;Ct.prototype=function(o,t){var n=new Ct;if(o instanceof Ct)o.each(function(e){n.add(e)});else if(o){var e=-1,a=o.length;if(null==t)for(;++e<a;)n.add(o[e]);else for(;++e<a;)n.add(t(o[e],e,o))}return n}.prototype={constructor:Ct,has:Ki.has,add:function(e){return e+="",this["$"+e]=e,this},remove:Ki.remove,clear:Ki.clear,values:Ki.keys,size:Ki.size,empty:Ki.empty,each:Ki.each};var Qi=Array.prototype,to=Qi.map,no=Qi.slice,eo=function(o,t,n){o.prototype=t.prototype=n,n.constructor=o},ro=/^#([0-9a-f]{3})$/,ao=/^#([0-9a-f]{6})$/,so=/^rgb\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*\)$/,co=/^rgb\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,lo=/^rgba\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,ho=/^rgba\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,fo=/^hsl\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,po=/^hsla\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,_o={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};eo(Et,Dt,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),eo(Lt,Pt,Ul(Et,{brighter:function(e){return e=null==e?1/.7:Vr(1/.7,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Vr(.7,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Wr(0,Ir(1,e)))?"rgb(":"rgba(")+Wr(0,Ir(255,Er(this.r)||0))+", "+Wr(0,Ir(255,Er(this.g)||0))+", "+Wr(0,Ir(255,Er(this.b)||0))+(1===e?")":", "+e+")")}})),eo(qt,function(o,t,n,e){return 1===arguments.length?Xt(o):new qt(o,t,n,null==e?1:e)},Ul(Et,{brighter:function(e){return e=null==e?1/.7:Vr(1/.7,e),new qt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Vr(.7,e),new qt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var o=this.h%360+360*(0>this.h),t=isNaN(o)||isNaN(this.s)?0:this.s,n=this.l,e=n+(.5>n?n:1-n)*t,a=2*n-e;return new Lt(It(240<=o?o-240:o+120,a,e),It(o,a,e),It(120>o?o+240:o-120,a,e),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}));var vo=Yr/180,yo=180/Yr,mo=.95047,go=1,wo=1.08883,xo=4/29,bo=6/29,Mo=3*bo*bo,To=bo*bo*bo;eo(Ot,function(o,t,n,e){return 1===arguments.length?$t(o):new Ot(o,t,n,null==e?1:e)},Ul(Et,{brighter:function(e){return new Ot(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Ot(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var o=(this.l+16)/116,t=isNaN(this.a)?o:o+this.a/500,n=isNaN(this.b)?o:o-this.b/200;return o=go*Vt(o),t=mo*Vt(t),n=wo*Vt(n),new Lt(Rt(3.2404542*t-1.5371385*o-.4985314*n),Rt(-.969266*t+1.8760108*o+.041556*n),Rt(.0556434*t-.2040259*o+1.0572252*n),this.opacity)}})),eo(Wt,function(o,t,n,e){return 1===arguments.length?Zt(o):new Wt(o,t,n,null==e?1:e)},Ul(Et,{brighter:function(e){return new Wt(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Wt(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return $t(this).rgb()}}));var ko=-.14861,Ao=1.78277,No=-.29227,So=-.90649,Co=1.97294,zo=Co*So,Eo=Co*Ao,Do=Ao*No-So*ko;eo(Kt,Jt,Ul(Et,{brighter:function(e){return e=null==e?1/.7:Vr(1/.7,e),new Kt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Vr(.7,e),new Kt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var o=isNaN(this.h)?0:(this.h+120)*vo,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),e=jr(o),a=Or(o);return new Lt(255*(t+n*(ko*e+Ao*a)),255*(t+n*(No*e+So*a)),255*(t+n*(Co*e)),this.opacity)}}));var Uo,Yo,Fo,Po,Lo=function(e){return function(){return e}},Ho=function o(t){function n(l,t){var r=a((l=Pt(l)).r,(t=Pt(t)).r),d=a(l.g,t.g),i=a(l.b,t.b),o=en(l.opacity,t.opacity);return function(e){return l.r=r(e),l.g=d(e),l.b=i(e),l.opacity=o(e),l+""}}var a=nn(t);return n.gamma=o,n}(1),Xo=function(a,t){var n,e=t?t.length:0,l=a?Ir(e,a.length):0,i=Array(e),o=Array(e);for(n=0;n<l;++n)i[n]=Ro(a[n],t[n]);for(;n<e;++n)o[n]=t[n];return function(e){for(n=0;n<l;++n)o[n]=i[n](e);return o}},qo=function(o,a){var n=new Date;return o=+o,a-=o,function(e){return n.setTime(o+a*e),n}},Io=function(o,a){return o=+o,a-=o,function(t){return o+a*t}},$o=function(o,a){var l,e={},r={};for(l in null!==o&&"object"==typeof o||(o={}),null!==a&&"object"==typeof a||(a={}),a)l in o?e[l]=Ro(o[l],a[l]):r[l]=a[l];return function(n){for(l in e)r[l]=e[l](n);return r}},Oo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jo=new RegExp(Oo.source,"g"),Vo=function(l,d){var t,e,n,i=Oo.lastIndex=jo.lastIndex=0,o=-1,c=[],a=[];for(l+="",d+="";(t=Oo.exec(l))&&(e=jo.exec(d));)(n=e.index)>i&&(n=d.slice(i,n),c[o]?c[o]+=n:c[++o]=n),(t=t[0])===(e=e[0])?c[o]?c[o]+=e:c[++o]=e:(c[++o]=null,a.push({i:o,x:Io(t,e)})),i=jo.lastIndex;return i<d.length&&(n=d.slice(i),c[o]?c[o]+=n:c[++o]=n),2>c.length?a[0]?on(a[0].x):rn(d):(d=a.length,function(n){for(var t,e=0;e<d;++e)c[(t=a[e]).i]=t.x(n);return c.join("")})},Ro=function(o,t){var a,e=typeof t;return null==t||"boolean"===e?Lo(t):("number"===e?Io:"string"===e?(a=Dt(t))?(t=a,Ho):Vo:t instanceof Dt?Ho:t instanceof Date?qo:Array.isArray(t)?Xo:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?$o:Io)(o,t)},Bo=function(o,a){return o=+o,a-=o,function(t){return Er(o+a*t)}},Zo=180/Yr,Wo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Go=function(l,d,c,e,r,_){var p,h,g;return(p=Xr(l*l+d*d))&&(l/=p,d/=p),(g=l*c+d*e)&&(c-=l*g,e-=d*g),(h=Xr(c*c+e*e))&&(c/=h,e/=h,g/=h),l*e<d*c&&(l=-l,d=-d,g=-g,p=-p),{translateX:r,translateY:_,rotate:Nr(d,l)*Zo,skewX:Math.atan(g)*Zo,scaleX:p,scaleY:h}},Jo=un(function(e){return"none"===e?Wo:(Uo||(Uo=document.createElement("DIV"),Yo=document.documentElement,Fo=document.defaultView),Uo.style.transform=e,e=Fo.getComputedStyle(Yo.appendChild(Uo),null).getPropertyValue("transform"),Yo.removeChild(Uo),e=e.slice(7,-1).split(","),Go(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),Ko=un(function(e){return null==e?Wo:(Po||(Po=document.createElementNS("http://www.w3.org/2000/svg","g")),Po.setAttribute("transform",e),(e=Po.transform.baseVal.consolidate())?(e=e.matrix,Go(e.a,e.b,e.c,e.d,e.e,e.f)):Wo)},", ",")",")"),Qo=Math.SQRT2,ed=function(g,t){var n,m,r=g[0],i=g[1],o=g[2],e=t[0],a=t[1],s=t[2],c=e-r,l=a-i,u=c*c+l*l;if(1e-12>u)m=Zr(s/o)/Qo,n=function(e){return[r+e*c,i+e*l,o*Hr(Qo*e*m)]};else{var h=Xr(u),p=(s*s-o*o+4*u)/(2*(2*o)*h),_=(s*s-o*o-4*u)/(2*(2*s)*h),f=Zr(Xr(p*p+1)-p),y=Zr(Xr(_*_+1)-_);m=(y-f)/Qo,n=function(d){var t=d*m,n=an(f),e=o/(2*h)*(n*cn(Qo*t+f)-sn(f));return[r+e*c,i+e*l,o*n/an(Qo*t+f)]}}return n.duration=1e3*m,n};ln(function(o,t){var n=t-o;return n?Qt(o,180<n||-180>n?n-360*Er(n/360):n):Lo(isNaN(o)?t:o)});var td=ln(en),nd=function(e){return function(){return e}},od=function(e){return+e},ad=[0,1],id=function(t,n,e){var i,o=t[0],l=t[t.length-1],a=Oa(o,l,null==n?10:n);switch((e=T(null==e?",f":e)).type){case"s":var r=Wr(qr(o),qr(l));return null!=e.precision||isNaN(i=Ri(a,r))||(e.precision=i),Hi(e,r);case"":case"e":case"g":case"p":case"r":null!=e.precision||isNaN(i=Bi(a,Wr(qr(o),qr(l))))||(e.precision=i-("e"===e.type));break;case"f":case"%":null!=e.precision||isNaN(i=Vi(a))||(e.precision=i-2*("%"===e.type));}return oo.format(e)},ld=function(a,t){var n,e=0,l=(a=a.slice()).length-1,i=a[e],o=a[l];return o<i&&(n=e,e=l,l=n,n=i,i=o,o=n),a[e]=t.floor(i),a[l]=t.ceil(o),a},rd=1e3,dd=60*rd,sd=60*dd,cd=24*sd,ud=7*cd,_d=30*cd,pd=365*cd,hd=function(e){return e.match(/.{6}/g).map(function(e){return"#"+e})};hd("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),hd("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),hd("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),hd("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),td(Jt(300,.5,0),Jt(-240,.5,1)),td(Jt(-100,.75,.35),Jt(80,1.5,.8)),td(Jt(260,.75,.35),Jt(80,1.5,.8)),Jt();var gd=Array.prototype.slice,yd=function(e){return e},md=1,fd=2,xd=3,vd=4,bd=1e-6,wd={value:function(){}};Xn.prototype=Hn.prototype={constructor:Xn,on:function(a,t){var l,e=this._,r=Al(a+"",e),i=-1,o=r.length;{if(!(2>arguments.length)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(l=(a=r[i]).type)e[l]=$n(e[l],a.name,t);else if(null==t)for(l in e)e[l]=$n(e[l],a.name,null);return this}for(;++i<o;)if((l=(a=r[i]).type)&&(l=In(e[l],a.name)))return l}},copy:function(){var o={},t=this._;for(var n in t)o[n]=t[n].slice();return new Xn(o)},call:function(a,t){if(0<(n=arguments.length-2))for(var n,e,l=Array(n),i=0;i<n;++i)l[i]=arguments[i+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(i=0,n=(e=this._[a]).length;i<n;++i)e[i].value.apply(t,l)},apply:function(a,t,n){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var e=this._[a],l=0,i=e.length;l<i;++l)e[l].value.apply(t,n)}};var Td="http://www.w3.org/1999/xhtml",kd={svg:"http://www.w3.org/2000/svg",xhtml:Td,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Sd=function(o){var a=o+="",n=a.indexOf(":");return 0<=n&&"xmlns"!==(a=o.slice(0,n))&&(o=o.slice(n+1)),kd.hasOwnProperty(a)?{space:kd[a],local:o}:o},Cd=function(e){var t=Sd(e);return(t.local?jn:On)(t)},zd=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var Md=document.documentElement;if(!Md.matches){var Ud=Md.webkitMatchesSelector||Md.msMatchesSelector||Md.mozMatchesSelector||Md.oMatchesSelector;zd=function(e){return function(){return Ud.call(this,e)}}}}var Ad=zd,Yd={};oo.event=null,"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Yd={mouseenter:"mouseover",mouseleave:"mouseout"}));var Ed=function(){for(var t,n=oo.event;t=n.sourceEvent;)n=t;return n},Dd=function(o,t){var n=o.ownerSVGElement||o;if(n.createSVGPoint){var e=n.createSVGPoint();return e.x=t.clientX,e.y=t.clientY,e=e.matrixTransform(o.getScreenCTM().inverse()),[e.x,e.y]}var a=o.getBoundingClientRect();return[t.clientX-a.left-o.clientLeft,t.clientY-a.top-o.clientTop]},Fd=function(e){var t=Ed();return t.changedTouches&&(t=t.changedTouches[0]),Dd(e,t)},Pd=function(e){return null==e?Jn:function(){return this.querySelector(e)}},Ld=function(e){return null==e?Kn:function(){return this.querySelectorAll(e)}},Hd=function(e){return Array(e.length)};Qn.prototype={constructor:Qn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Xd=function(e){return function(){return e}},Nd="$",Od=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};me.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return 0<=this._names.indexOf(e)}};var jd=[null];Le.prototype=El.prototype={constructor:Le,select:function(d){"function"!=typeof d&&(d=Pd(d));for(var _=this._groups,n=_.length,e=Array(n),r=0;r<n;++r)for(var i,o,u=_[r],a=u.length,s=e[r]=Array(a),c=0;c<a;++c)(i=u[c])&&(o=d.call(i,i.__data__,c,u))&&("__data__"in i&&(o.__data__=i.__data__),s[c]=o);return new Le(e,this._parents)},selectAll:function(l){"function"!=typeof l&&(l=Ld(l));for(var d=this._groups,n=d.length,e=[],r=[],i=0;i<n;++i)for(var o,u=d[i],a=u.length,s=0;s<a;++s)(o=u[s])&&(e.push(l.call(o,o.__data__,s,u)),r.push(o));return new Le(e,r)},filter:function(l){"function"!=typeof l&&(l=Ad(l));for(var d=this._groups,n=d.length,e=Array(n),r=0;r<n;++r)for(var i,o=d[r],u=o.length,a=e[r]=[],s=0;s<u;++s)(i=o[s])&&l.call(i,i.__data__,s,o)&&a.push(i);return new Le(e,this._parents)},data:function(x,b){if(!x)return f=Array(this.size()),s=-1,this.each(function(e){f[++s]=e}),f;var n=b?ne:Yl,e=this._parents,r=this._groups;"function"!=typeof x&&(x=Xd(x));for(var i=r.length,o=Array(i),u=Array(i),a=Array(i),s=0;s<i;++s){var c=e[s],l=r[s],h=l.length,f=x.call(c,c&&c.__data__,s,e),p=f.length,_=u[s]=Array(p),v=o[s]=Array(p);n(c,l,_,v,a[s]=Array(h),f,b);for(var y,d,m=0,g=0;m<p;++m)if(y=_[m]){for(m>=g&&(g=m+1);!(d=v[g])&&++g<p;);y._next=d||null}}return o=new Le(o,e),o._enter=u,o._exit=a,o},enter:function(){return new Le(this._enter||this._groups.map(Hd),this._parents)},exit:function(){return new Le(this._exit||this._groups.map(Hd),this._parents)},merge:function(d){for(var t=this._groups,n=d._groups,e=t.length,r=n.length,i=Ir(e,r),o=Array(e),u=0;u<i;++u)for(var a,s=t[u],c=n[u],l=s.length,_=o[u]=Array(l),h=0;h<l;++h)(a=s[h]||c[h])&&(_[h]=a);for(;u<e;++u)o[u]=t[u];return new Le(o,this._parents)},order:function(){for(var a=this._groups,t=-1,n=a.length;++t<n;)for(var e,l=a[t],i=l.length-1,o=l[i];0<=--i;)(e=l[i])&&(o&&o!==e.nextSibling&&o.parentNode.insertBefore(e,o),o=e);return this},sort:function(l){l||(l=ee);for(var t=this._groups,n=t.length,e=Array(n),r=0;r<n;++r){for(var i,o=t[r],d=o.length,a=e[r]=Array(d),s=0;s<d;++s)(i=o[s])&&(a[s]=i);a.sort(function(t,o){return t&&o?l(t.__data__,o.__data__):!t-!o})}return new Le(e,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var a=this._groups,t=0,n=a.length;t<n;++t)for(var e,l=a[t],r=0,i=l.length;r<i;++r)if(e=l[r],e)return e;return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(l){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r,i=t[n],o=0,d=i.length;o<d;++o)(r=i[o])&&l.call(r,r.__data__,o,i);return this},attr:function(o,t){var a=Sd(o);if(2>arguments.length){var e=this.node();return a.local?e.getAttributeNS(a.space,a.local):e.getAttribute(a)}return this.each((null==t?a.local?ie:re:"function"==typeof t?a.local?se:ae:a.local?ue:oe)(a,t))},style:function(o,t,a){return 1<arguments.length?this.each((null==t?ce:"function"==typeof t?he:le)(o,t,null==a?"":a)):fe(this.node(),o)},property:function(e,t){return 1<arguments.length?this.each((null==t?pe:"function"==typeof t?ve:_e)(e,t)):this.node()[e]},classed:function(a,t){var l=ye(a+"");if(2>arguments.length){for(var e=de(this.node()),r=-1,i=l.length;++r<i;)if(!e.contains(l[r]))return!1;return!0}return this.each(("function"==typeof t?Me:t?xe:be)(l,t))},text:function(e){return arguments.length?this.each(null==e?Te:("function"==typeof e?Ae:ke)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Ne:("function"==typeof e?Ce:Se)(e)):this.node().innerHTML},raise:function(){return this.each(ze)},lower:function(){return this.each(Ee)},append:function(e){var o="function"==typeof e?e:Cd(e);return this.select(function(){return this.appendChild(o.apply(this,arguments))})},insert:function(o,a){var i="function"==typeof o?o:Cd(o),e=null==a?De:"function"==typeof a?a:Pd(a);return this.select(function(){return this.insertBefore(i.apply(this,arguments),e.apply(this,arguments)||null)})},remove:function(){return this.each(Ue)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(d,t,n){var e,r,i=Bn(d+""),o=i.length;{if(!(2>arguments.length)){for(u=t?Wn:Zn,null==n&&(n=!1),e=0;e<o;++e)this.each(u(i[e],t,n));return this}var u=this.node().__on;if(u)for(var a,s=0,c=u.length;s<c;++s)for(e=0,a=u[s];e<o;++e)if((r=i[e]).type===a.type&&r.name===a.name)return a.value}},dispatch:function(e,t){return this.each(("function"==typeof t?Pe:Fe)(e,t))}};var Id=function(e){return"string"==typeof e?new Le([[document.querySelector(e)]],[document.documentElement]):new Le([[e]],jd)},qd=function(a,t,n){3>arguments.length&&(n=t,t=Ed().changedTouches);for(var e,l=0,i=t?t.length:0;l<i;++l)if((e=t[l]).identifier===n)return Dd(a,e);return null},Vd=function(){oo.event.preventDefault(),oo.event.stopImmediatePropagation()},$d=function(o){var t=o.document.documentElement,n=Id(o).on("dragstart.drag",Vd,!0);"onselectstart"in t?n.on("selectstart.drag",Vd,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")},Bd=function(e){return function(){return e}};Ie.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Zd,Wd,Rd=0,Gd=0,Jd=0,Kd=1e3,Qd=0,ta=0,na=0,ea="object"==typeof performance&&performance.now?performance:Date,ra="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};Ze.prototype=Dl.prototype={constructor:Ze,restart:function(o,a,i){if("function"!=typeof o)throw new TypeError("callback is not a function");i=(null==i?Re():+i)+(null==a?0:+a),this._next||Wd===this||(Wd?Wd._next=this:Zd=this,Wd=this),this._call=o,this._time=i,Fl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fl())}};var ia=function(o,t,a){var i=new Ze;return t=null==t?0:+t,i.restart(function(n){i.stop(),o(n+t)},t,a),i},oa=Hn("start","end","interrupt"),es=[],ts=0,ns=1,ca=2,la=3,ha=4,fa=5,pa=6,_a=function(a,t,l,e,d,s){var o=a.__transition;if(!o)a.__transition={};else if(l in o)return;Xl(a,l,{name:t,index:e,group:d,on:oa,tween:es,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ts})},va=function(a,t){var n,e,l,i=a.__transition,o=!0;if(i){for(l in t=null==t?null:t+"",i)(n=i[l]).name===t?(e=n.state>ca&&n.state<fa,n.state=pa,n.timer.stop(),e&&n.on.call("interrupt",a,a.__data__,n.index,n.group),delete i[l]):o=!1;o&&delete a.__transition}},ya=function(o,t){var a;return("number"==typeof t?Io:t instanceof Dt?Ho:(a=Dt(t))?(t=a,Ho):Vo)(o,t)},da=El.prototype.constructor,ma=0,ga=El.prototype;ur.prototype=function(e){return El().transition(e)}.prototype={constructor:ur,select:function(d){var _=this._name,n=this._id;"function"!=typeof d&&(d=Pd(d));for(var e=this._groups,r=e.length,i=Array(r),o=0;o<r;++o)for(var u,a,s=e[o],c=s.length,l=i[o]=Array(c),p=0;p<c;++p)(u=s[p])&&(a=d.call(u,u.__data__,p,s))&&("__data__"in u&&(a.__data__=u.__data__),l[p]=a,_a(l[p],_,n,p,l,Hl(u,n)));return new ur(i,this._parents,_,n)},selectAll:function(d){var g=this._name,n=this._id;"function"!=typeof d&&(d=Ld(d));for(var e=this._groups,r=e.length,i=[],o=[],u=0;u<r;++u)for(var a,s=e[u],c=s.length,l=0;l<c;++l)if(a=s[l]){for(var h,m=d.call(a,a.__data__,l,s),p=Hl(a,n),_=0,f=m.length;_<f;++_)(h=m[_])&&_a(h,g,n,_,m,p);i.push(m),o.push(a)}return new ur(i,o,g,n)},filter:function(l){"function"!=typeof l&&(l=Ad(l));for(var d=this._groups,n=d.length,e=Array(n),r=0;r<n;++r)for(var i,o=d[r],u=o.length,a=e[r]=[],s=0;s<u;++s)(i=o[s])&&l.call(i,i.__data__,s,o)&&a.push(i);return new ur(e,this._parents,this._name,this._id)},merge:function(d){if(d._id!==this._id)throw new Error;for(var t=this._groups,n=d._groups,e=t.length,r=n.length,i=Ir(e,r),o=Array(e),u=0;u<i;++u)for(var a,s=t[u],c=n[u],l=s.length,_=o[u]=Array(l),h=0;h<l;++h)(a=s[h]||c[h])&&(_[h]=a);for(;u<e;++u)o[u]=t[u];return new ur(o,this._parents,this._name,this._id)},selection:function(){return new da(this._groups,this._parents)},transition:function(){for(var d=this._name,t=this._id,n=_r(),e=this._groups,r=e.length,i=0;i<r;++i)for(var o,u=e[i],a=u.length,s=0;s<a;++s)if(o=u[s]){var c=Hl(o,t);_a(o,d,n,s,u,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ur(e,this._parents,d,n)},call:ga.call,nodes:ga.nodes,node:ga.node,size:ga.size,empty:ga.empty,each:ga.each,on:function(o,t){var n=this._id;return 2>arguments.length?Hl(this.node(),n).on.on(o):this.each(nr(n,o,t))},attr:function(o,t){var a=Sd(o),e="transform"===a?Ko:ya;return this.attrTween(o,"function"==typeof t?(a.local?Zl:Bl)(a,e,jl(this,"attr."+o,t)):null==t?(a.local?ql:Il)(a):(a.local?$l:Vl)(a,e,t+""))},attrTween:function(o,t){var a="attr."+o;if(2>arguments.length)return(a=this.tween(a))&&a._value;if(null==t)return this.tween(a,null);if("function"!=typeof t)throw new Error;var e=Sd(o);return this.tween(a,(e.local?Wl:Rl)(e,t))},style:function(o,t,a){var e="transform"==(o+="")?Jo:ya;return null==t?this.styleTween(o,ar(o,e)).on("end.style."+o,ir(o)):this.styleTween(o,"function"==typeof t?rr(o,e,jl(this,"style."+o,t)):lr(o,e,t+""),a)},styleTween:function(o,t,a){var e="style."+(o+="");if(2>arguments.length)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,dr(o,t,null==a?"":a))},text:function(e){return this.tween("text","function"==typeof e?cr(jl(this,"text",e)):sr(null==e?"":e+""))},remove:function(){return this.on("end.remove",or(this._id))},tween:function(a,t){var n=this._id;if(a+="",2>arguments.length){for(var e,l=Hl(this.node(),n).tween,i=0,o=l.length;i<o;++i)if((e=l[i]).name===a)return e.value;return null}return this.each((null==t?Nl:Ol)(n,a,t))},delay:function(e){var o=this._id;return arguments.length?this.each(("function"==typeof e?Gl:Jl)(o,e)):Hl(this.node(),o).delay},duration:function(e){var o=this._id;return arguments.length?this.each(("function"==typeof e?Kl:Ql)(o,e)):Hl(this.node(),o).duration},ease:function(e){var t=this._id;return arguments.length?this.each(er(t,e)):Hl(this.node(),t).ease}},function o(a){function t(e){return Vr(e,a)}return a=+a,t.exponent=o,t}(3),function o(a){function t(e){return 1-Vr(1-e,a)}return a=+a,t.exponent=o,t}(3),function o(a){function t(e){return(1>=(e*=2)?Vr(e,a):2-Vr(2-e,a))/2}return a=+a,t.exponent=o,t}(3),function o(a){function t(e){return e*e*((a+1)*e-a)}return a=+a,t.overshoot=o,t}(1.70158),function o(a){function t(e){return--e*e*((a+1)*e+a)+1}return a=+a,t.overshoot=o,t}(1.70158),function o(a){function t(e){return(1>(e*=2)?e*e*((a+1)*e-a):(e-=2)*e*((a+1)*e+a)+2)/2}return a=+a,t.overshoot=o,t}(1.70158);var wa=2*Yr,xa=(function o(a,l){function e(e){return a*Vr(2,10*--e)*Or((n-e)/l)}var n=Ar(1/(a=Wr(1,a)))*(l/=wa);return e.amplitude=function(e){return o(e,l*wa)},e.period=function(t){return o(a,t)},e}(1,.3),function o(a,l){function e(e){return 1-a*Vr(2,-10*(e=+e))*Or((e+n)/l)}var n=Ar(1/(a=Wr(1,a)))*(l/=wa);return e.amplitude=function(e){return o(e,l*wa)},e.period=function(t){return o(a,t)},e}(1,.3),function o(a,l){function e(e){return(0>(e=2*e-1)?a*Vr(2,10*e)*Or((n-e)/l):2-a*Vr(2,-10*e)*Or((n+e)/l))/2}var n=Ar(1/(a=Wr(1,a)))*(l/=wa);return e.amplitude=function(e){return o(e,l*wa)},e.period=function(t){return o(a,t)},e}(1,.3),{time:null,delay:0,duration:250,ease:function(e){return(1>=(e*=2)?e*e*e:(e-=2)*e*e+2)/2}});El.prototype.interrupt=function(e){return this.each(function(){va(this,e)})},El.prototype.transition=function(l){var t,n;l instanceof ur?(t=l._id,l=l._name):(t=_r(),(n=xa).time=Re(),l=null==l?null:l+"");for(var e=this._groups,r=e.length,i=0;i<r;++i)for(var o,d=e[i],a=d.length,s=0;s<a;++s)(o=d[s])&&_a(o,l,t,s,d,n||pr(o,t));return new ur(e,this._parents,l,t)};var ba=function(e){return function(){return e}};gr.prototype={constructor:gr,scale:function(e){return 1===e?this:new gr(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new gr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ma=new gr(1,0,0);yr.prototype=gr.prototype;var Ta=function(){oo.event.preventDefault(),oo.event.stopImmediatePropagation()},ka=function(e){return function(){return e}},Aa=function(o,t,n){this.target=o,this.type=t,this.selection=n},Na=function(){oo.event.preventDefault(),oo.event.stopImmediatePropagation()},Sa={name:"drag"},Ca={name:"space"},za={name:"handle"},Ea={name:"center"},Da={name:"x",handles:["e","w"].map(kr),input:function(e,t){return e&&[[e[0],t[0][1]],[e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Ua={name:"y",handles:["n","s"].map(kr),input:function(e,t){return e&&[[t[0][0],e[0]],[t[1][0],e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},Ya={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(kr),input:function(e){return e},output:function(e){return e}},Fa={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Pa={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},La={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Ha={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Xa={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};return oo.bisector=Gr,oo.extent=function(a,t){var n,e,l,i=a.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=a[o])&&n>=n)for(e=l=n;++o<i;)null!=(n=a[o])&&(e>n&&(e=n),l<n&&(l=n));}else for(;++o<i;)if(null!=(n=t(a[o],o,a))&&n>=n)for(e=l=n;++o<i;)null!=(n=t(a[o],o,a))&&(e>n&&(e=n),l<n&&(l=n));return[e,l]},oo.max=function(a,t){var n,e,l=a.length,i=-1;if(null==t){for(;++i<l;)if(null!=(n=a[i])&&n>=n)for(e=n;++i<l;)null!=(n=a[i])&&n>e&&(e=n);}else for(;++i<l;)if(null!=(n=t(a[i],i,a))&&n>=n)for(e=n;++i<l;)null!=(n=t(a[i],i,a))&&n>e&&(e=n);return e},oo.min=function(a,t){var n,e,l=a.length,i=-1;if(null==t){for(;++i<l;)if(null!=(n=a[i])&&n>=n)for(e=n;++i<l;)null!=(n=a[i])&&e>n&&(e=n);}else for(;++i<l;)if(null!=(n=t(a[i],i,a))&&n>=n)for(e=n;++i<l;)null!=(n=t(a[i],i,a))&&e>n&&(e=n);return e},oo.line=ci,oo.area=function(){function d(o){var g,n,a,s,p,f=o.length,x=!1,v=Array(f),d=Array(f);for(null==c&&(h=l(p=ja())),g=0;g<=f;++g){if(!(g<f&&u(s=o[g],g,o))===x)if(x=!x)n=g,h.areaStart(),h.lineStart();else{for(h.lineEnd(),h.lineStart(),a=g-1;a>=n;--a)h.point(v[a],d[a]);h.lineEnd(),h.areaEnd()}x&&(v[g]=+_(s,g,o),d[g]=+r(s,g,o),h.point(e?+e(s,g,o):v[g],i?+i(s,g,o):d[g]))}if(p)return h=null,p+""||null}function t(){return ci().defined(u).curve(l).context(c)}var _=o,e=null,r=oi(0),i=a,u=oi(!0),c=null,l=si,h=null;return d.x=function(t){return arguments.length?(_="function"==typeof t?t:oi(+t),e=null,d):_},d.x0=function(e){return arguments.length?(_="function"==typeof e?e:oi(+e),d):_},d.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:oi(+t),d):e},d.y=function(e){return arguments.length?(r="function"==typeof e?e:oi(+e),i=null,d):r},d.y0=function(e){return arguments.length?(r="function"==typeof e?e:oi(+e),d):r},d.y1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:oi(+e),d):i},d.lineX0=d.lineY0=function(){return t().x(_).y(r)},d.lineY1=function(){return t().x(_).y(i)},d.lineX1=function(){return t().x(e).y(r)},d.defined=function(e){return arguments.length?(u="function"==typeof e?e:oi(!!e),d):u},d.curve=function(e){return arguments.length?(l=e,null!=c&&(h=l(c)),d):l},d.context=function(e){return arguments.length?(null==e?c=h=null:h=l(c=e),d):c},d},oo.curveBasis=function(e){return new s(e)},oo.curveMonotoneX=function(e){return new m(e)},oo.curveNatural=function(e){return new f(e)},oo.curveCardinal=li,oo.curveCatmullRom=hi,oo.curveStep=function(e){return new v(e,.5)},oo.curveStepAfter=function(e){return new v(e,1)},oo.curveStepBefore=function(e){return new v(e,0)},oo.curveLinear=si,oo.timeMillisecond=_i,oo.timeSecond=di,oo.timeMinute=mi,oo.timeHour=gi,oo.timeDay=wi,oo.timeWeek=xi,oo.timeMonth=Mi,oo.timeYear=Ti,oo.formatDefaultLocale=S,oo.formatLocale=Ii,oo.timeFormatLocale=A,oo.timeFormatDefaultLocale=zl,oo.scaleLinear=gn,oo.scaleLog=An,oo.scalePow=Sn,oo.scaleTime=function(){return En(Ti,Mi,xi,wi,gi,mi,di,_i,oo.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},oo.axisRight=function(e){return Ln(fd,e)},oo.axisTop=function(e){return Ln(md,e)},oo.axisBottom=function(e){return Ln(xd,e)},oo.axisLeft=function(e){return Ln(vd,e)},oo.zoom=function(){function U(o){o.property("__zoom",vr).on("wheel.zoom",e).on("mousedown.zoom",n).on("dblclick.zoom",a).filter(wr).on("touchstart.zoom",l).on("touchmove.zoom",r).on("touchend.zoom touchcancel.zoom",s).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function Y(e,t){return(t=Wr(h,Ir(g,t)))===e.k?e:new gr(t,e.x,e.y)}function F(o,t,n){var e=t[0]-n[0]*o.k,a=t[1]-n[1]*o.k;return e===o.x&&a===o.y?o:new gr(o.k,e,a)}function P(a,t){var n=a.invertX(t[0][0])-u,e=a.invertX(t[1][0])-m,l=a.invertY(t[0][1])-f,r=a.invertY(t[1][1])-v;return a.translate(e>n?(n+e)/2:Ir(0,n)||Wr(0,e),r>l?(l+r)/2:Ir(0,l)||Wr(0,r))}function L(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function i(o,a,_){o.on("start.zoom",function(){H(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){H(this,arguments).end()}).tween("zoom",function(){var e=this,t=arguments,o=H(e,t),i=d.apply(e,t),r=_||L(i),s=Wr(i[1][0]-i[0][0],i[1][1]-i[0][1]),c=e.__zoom,l="function"==typeof a?a.apply(e,t):a,u=w(c.invert(r).concat(s/c.k),l.invert(r).concat(s/l.k));return function(a){if(1===a)a=l;else{var t=u(a),n=s/t[2];a=new gr(n,r[0]-t[0]*n,r[1]-t[1]*n)}o.zoom(null,a)}})}function H(a,t){for(var n,e=0,l=T.length;e<l;++e)if((n=T[e]).that===a)return n;return new o(a,t)}function o(e,t){this.that=e,this.args=t,this.index=-1,this.active=0,this.extent=d.apply(e,t)}function e(){if(_.apply(this,arguments)){var e=H(this,arguments),t=this.__zoom,n=Wr(h,Ir(g,t.k*Vr(2,p.apply(this,arguments)))),o=Fd(this);if(e.wheel)e.mouse[0][0]===o[0]&&e.mouse[0][1]===o[1]||(e.mouse[1]=t.invert(e.mouse[0]=o)),clearTimeout(e.wheel);else{if(t.k===n)return;e.mouse=[o,t.invert(o)],va(this),e.start()}Ta(),e.wheel=setTimeout(function(){e.wheel=null,e.end()},C),e.zoom("mouse",P(F(Y(t,n),e.mouse[0],e.mouse[1]),e.extent))}}function n(){if(!c&&_.apply(this,arguments)){var t=H(this,arguments),n=Id(oo.event.view).on("mousemove.zoom",function(){if(Ta(),!t.moved){var n=oo.event.clientX-a,e=oo.event.clientY-i;t.moved=n*n+e*e>z}t.zoom("mouse",P(F(t.that.__zoom,t.mouse[0]=Fd(t.that),t.mouse[1]),t.extent))},!0).on("mouseup.zoom",function(){n.on("mousemove.zoom mouseup.zoom",null),qe(oo.event.view,t.moved),Ta(),t.end()},!0),e=Fd(this),a=oo.event.clientX,i=oo.event.clientY;$d(oo.event.view),mr(),t.mouse=[e,this.__zoom.invert(e)],va(this),t.start()}}function a(){if(_.apply(this,arguments)){var e=this.__zoom,t=Fd(this),n=e.invert(t),o=P(F(Y(e,e.k*(oo.event.shiftKey?.5:2)),t,n),d.apply(this,arguments));Ta(),0<b?Id(this).transition().duration(b).call(i,o,t):Id(this).call(U.transform,o)}}function l(){if(_.apply(this,arguments)){var a,n,e,l,i=H(this,arguments),o=oo.event.changedTouches,r=o.length;for(mr(),n=0;n<r;++n)e=o[n],l=[l=qd(this,o,e.identifier),this.__zoom.invert(l),e.identifier],i.touch0?i.touch1||(i.touch1=l):(i.touch0=l,a=!0);if(t&&(t=clearTimeout(t),!i.touch1))return i.end(),void((l=Id(this).on("dblclick.zoom"))&&l.apply(this,arguments));a&&(t=setTimeout(function(){t=null},S),va(this),i.start())}}function r(){var e,n,o,a,i=H(this,arguments),r=oo.event.changedTouches,l=r.length;for(Ta(),t&&(t=clearTimeout(t)),e=0;e<l;++e)n=r[e],o=qd(this,r,n.identifier),i.touch0&&i.touch0[2]===n.identifier?i.touch0[0]=o:i.touch1&&i.touch1[2]===n.identifier&&(i.touch1[0]=o);if(n=i.that.__zoom,i.touch1){var s=i.touch0[0],c=i.touch0[1],u=i.touch1[0],_=i.touch1[1],h=(h=u[0]-s[0])*h+(h=u[1]-s[1])*h,d=(d=_[0]-c[0])*d+(d=_[1]-c[1])*d;n=Y(n,Xr(h/d)),o=[(s[0]+u[0])/2,(s[1]+u[1])/2],a=[(c[0]+_[0])/2,(c[1]+_[1])/2]}else{if(!i.touch0)return;o=i.touch0[0],a=i.touch0[1]}i.zoom("touch",P(F(n,o,a),i.extent))}function s(){var t,n,e=H(this,arguments),a=oo.event.changedTouches,i=a.length;for(mr(),c&&clearTimeout(c),c=setTimeout(function(){c=null},S),t=0;t<i;++t)n=a[t],e.touch0&&e.touch0[2]===n.identifier?delete e.touch0:e.touch1&&e.touch1[2]===n.identifier&&delete e.touch1;e.touch1&&!e.touch0&&(e.touch0=e.touch1,delete e.touch1),e.touch0?e.touch0[1]=this.__zoom.invert(e.touch0[0]):e.end()}var t,c,_=fr,d=xr,p=br,h=0,g=1/0,u=-g,m=g,f=u,v=m,b=250,w=ed,T=[],k=Hn("start","zoom","end"),S=500,C=150,z=0;return U.transform=function(o,t){var a=o.selection?o.selection():o;a.property("__zoom",vr),o===a?a.interrupt().each(function(){H(this,arguments).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}):i(o,t)},U.scaleBy=function(n,t){U.scaleTo(n,function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)})},U.scaleTo=function(e,o){U.transform(e,function(){var e=d.apply(this,arguments),t=this.__zoom,n=L(e),a=t.invert(n);return P(F(Y(t,"function"==typeof o?o.apply(this,arguments):o),n,a),e)})},U.translateBy=function(n,t,o){U.transform(n,function(){return P(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof o?o.apply(this,arguments):o),d.apply(this,arguments))})},U.translateTo=function(n,o,a){U.transform(n,function(){var i=d.apply(this,arguments),t=this.__zoom,n=L(i);return P(Ma.translate(n[0],n[1]).scale(t.k).translate("function"==typeof o?-o.apply(this,arguments):-o,"function"==typeof a?-a.apply(this,arguments):-a),i)})},o.prototype={start:function(){return 1==++this.active&&(this.index=T.push(this)-1,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(T.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(e){Gn(new hr(U,e,this.that.__zoom),k.apply,k,[e,this.that,this.args])}},U.wheelDelta=function(e){return arguments.length?(p="function"==typeof e?e:ba(+e),U):p},U.filter=function(e){return arguments.length?(_="function"==typeof e?e:ba(!!e),U):_},U.extent=function(e){return arguments.length?(d="function"==typeof e?e:ba([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),U):d},U.scaleExtent=function(e){return arguments.length?(h=+e[0],g=+e[1],U):[h,g]},U.translateExtent=function(e){return arguments.length?(u=+e[0][0],m=+e[1][0],f=+e[0][1],v=+e[1][1],U):[[u,f],[m,v]]},U.duration=function(e){return arguments.length?(b=+e,U):b},U.interpolate=function(e){return arguments.length?(w=e,U):w},U.on=function(){var e=k.on.apply(k,arguments);return e===k?U:e},U.clickDistance=function(e){return arguments.length?(z=(e=+e)*e,U):Xr(z)},U},oo.zoomIdentity=Ma,oo.zoomTransform=yr,oo.drag=function(){function x(e){e.on("mousedown.drag",n).filter(Ve).on("touchstart.drag",i).on("touchmove.drag",o).on("touchend.drag touchcancel.drag",r).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function n(){if(!u&&b.apply(this,arguments)){var o=a("mouse",p.apply(this,arguments),Fd,this,arguments);o&&(Id(oo.event.view).on("mousemove.drag",e,!0).on("mouseup.drag",t,!0),$d(oo.event.view),Xe(),l=!1,s=oo.event.clientX,c=oo.event.clientY,o("start"))}}function e(){if(Vd(),!l){var t=oo.event.clientX-s,n=oo.event.clientY-c;l=t*t+n*n>m}v.mouse("drag")}function t(){Id(oo.event.view).on("mousemove.drag mouseup.drag",null),qe(oo.event.view,l),Vd(),v.mouse("end")}function i(){if(b.apply(this,arguments)){var t,n,e=oo.event.changedTouches,l=p.apply(this,arguments),i=e.length;for(t=0;t<i;++t)(n=a(e[t].identifier,l,qd,this,arguments))&&(Xe(),n("start"))}}function o(){var t,n,e=oo.event.changedTouches,o=e.length;for(t=0;t<o;++t)(n=v[e[t].identifier])&&(Vd(),n("drag"))}function r(){var t,n,e=oo.event.changedTouches,o=e.length;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),t=0;t<o;++t)(n=v[e[t].identifier])&&(Xe(),n("end"))}function a(n,e,r,i,o){var u,a,g,c=r(e,n),l=y.copy();if(Gn(new Ie(x,"beforestart",u,n,d,c[0],c[1],0,0,l),function(){return null!=(oo.event.subject=u=_.apply(i,o))&&(a=u.x-c[0]||0,g=u.y-c[1]||0,!0)}))return function s(t){var h,p=c;switch(t){case"start":v[n]=s,h=d++;break;case"end":delete v[n],--d;case"drag":c=r(e,n),h=d;}Gn(new Ie(x,t,u,n,h,c[0]+a,c[1]+g,c[0]-p[0],c[1]-p[1],l),l.apply,l,[t,i,o])}}var s,c,l,u,b=$e,p=Oe,_=je,v={},y=Hn("start","drag","end"),d=0,m=0;return x.filter=function(e){return arguments.length?(b="function"==typeof e?e:Bd(!!e),x):b},x.container=function(e){return arguments.length?(p="function"==typeof e?e:Bd(e),x):p},x.subject=function(e){return arguments.length?(_="function"==typeof e?e:Bd(e),x):_},x.on=function(){var e=y.on.apply(y,arguments);return e===y?x:e},x.clickDistance=function(e){return arguments.length?(m=(e=+e)*e,x):Xr(m)},x},oo.brush=function(){return Ur(Ya)},oo.brushX=function(){return Ur(Da)},oo.brushY=function(){return Ur(Ua)},oo.mouse=Fd,oo.select=Id,oo.selection=El,oo.selectAll=function(e){return"string"==typeof e?new Le([document.querySelectorAll(e)],[document.documentElement]):new Le([null==e?[]:e],jd)},oo.selectorAll=Ld,oo.touch=qd,oo}({});</script><script>window.WebvisualMixins=window.WebvisualMixins||{},WebvisualMixins.FullscreenMixin=function(a){return class extends a{constructor(){super()}static get properties(){return{fullscreen:{type:Boolean,value:!1,reflectToAttribute:!0},fullscreenIcon:{type:String,computed:'computeFullscreenIcon(fullscreen)'}}}_isFullscreen(){return document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||!1}_getParent(){const a=Polymer.dom(this).getOwnerRoot();return a?a.nodeType==Node.DOCUMENT_FRAGMENT_NODE?a.host:void 0:Polymer.dom(this).parentNode}connectedCallback(){super.connectedCallback(),this.requestFullscreen?(this.exitFullscreen=document.exitFullscreen.bind(document),this.addEventListener('fullscreenchange',this.fullScreenChanged.bind(this))):this.webkitRequestFullScreen?(this.requestFullscreen=this.webkitRequestFullScreen.bind(this),this.exitFullscreen=document.webkitCancelFullScreen.bind(document),this.addEventListener('webkitfullscreenchange',this.fullScreenChanged.bind(this))):this.mozRequestFullScreen?(this.requestFullscreen=this.mozRequestFullScreen.bind(this),this.exitFullscreen=document.mozCancelFullScreen.bind(document),document.addEventListener('mozfullscreenchange',this.fullScreenChanged.bind(this))):this.msRequestFullscreen&&(this.requestFullscreen=this.msRequestFullscreen.bind(this),this.exitFullscreen=document.msExitFullscreen.bind(document),document.addEventListener('MSFullscreenChange',this.fullScreenChanged.bind(this)))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener('fullscreenchange',this.fullScreenChanged.bind(this),!1),this.removeEventListener('webkitfullscreenchange',this.fullScreenChanged.bind(this),!1),document.removeEventListener('mozfullscreenchange',this.fullScreenChanged.bind(this),!1),document.removeEventListener('MSFullscreenChange',this.fullScreenChanged.bind(this),!1)}toggleFullscreen(a){a.stopPropagation(),this._isFullscreen()?this.exitFullscreen():this.requestFullscreen(),this._resetZoom&&this._resetZoom(a)}fullScreenChanged(){this._fullScreenChanged()}_fullScreenChanged(){requestAnimationFrame(()=>{const a=this._isFullscreen();console.log('isFullscreen',a);const b=this._getParent();a?(this.fullscreen=!0,this.style.position='fixed',this.style.top='0',this.style.left='0',this.style.right='0',this.style.bottom='0',this.style.zIndex='1000',this.style['border-radius']='0px',document.body.style.overflow='hidden',b&&b.classList.add('fullscreen')):(this.fullscreen=!1,this.style.position='',this.style.top='',this.style.left='',this.style.right='',this.style.bottom='',this.style.zIndex='',this.style['border-radius']='',document.body.style.overflow='',b&&b.classList.remove('fullscreen')),this.notifyResize&&this.notifyResize()})}computeFullscreenIcon(a){return a?'fullscreen-exit':'fullscreen'}}};</script><dom-module id="device-svg"><template strip-whitespace=""><style include="control-style">:host{position:relative;border-radius:inherit;-webkit-overflow-scrolling:touch;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;font-family:inherit;letter-spacing:normal;user-select:none !important;background-color:transparent;color:currentColor;z-index:auto;transition:background 250ms linear;}:host([opened]){pointer-events:all;}:host([fullscreen]){color:var(--fullscreen-color, currentColor);background-color:var(--fullscreen-background-color);min-height:100vh;min-width:100vw;padding:0 !important;margin:0 !important;--control-bottom:8px;--control-right:16px;--control-button-distance:8px;}:host(:-webkit-full-screen){color:var(--fullscreen-color, currentColor);background-color:var(--fullscreen-background-color);}svg{border-radius:inherit;user-select:none !important;}#svgContainer{position:relative;box-sizing:border-box;width:100%;height:100%;border-radius:inherit;isolation:isolate;}#svgContainer svg{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;font-family:inherit;}text{pointer-events:none !important;letter-spacing:normal !important;stroke:none !important;cursor:default !important;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;mix-blend-mode:exclusion;@apply --svg-text;}svg *{pointer-events:none;}.selectable{pointer-events:all !important;cursor:pointer;transform-origin:center center;-moz-transform-origin:50% 50%;transition:fill 250ms cubic-bezier(0.6, 0, 0.2, 1);@apply --svg-selectable;}.clicked{fill:#3852D7 !important;fill-opacity:0.25;@apply --svg-clicked;}.selected{fill-opacity:0.75;stroke-opacity:0.5 !important;@apply --svg-selected;}.exceeding{stroke:#D95656;fill-opacity:1;stroke-width:2px;stroke-linecap:round;stroke-linejoin:round;transform-origin:center center;will-change:transform;animation-name:exceeding-animation;animation-duration:2s;animation-timing-function:linear;animation-iteration-count:infinite;@apply --svg-exceeding;}@keyframes exceeding-animation{0%{transform:scale(1.0);}50%{fill:#D95656;transform:scale(0.8);-moz-transform:scale(1.0);}100%{transform:scale(1.0);}}icon-button:focus{opacity:1;background-color:rgba(255,255,255, 0.125);}[hidden]{display:none !important;}</style><div id="svgContainer" on-contextmenu="_resetZoom"><div id="control" class="right bottom"><icon-button title="focus" icon="filter-center-focus" on-click="_resetZoom"></icon-button><icon-button title="fullscreen" icon="[[fullscreenIcon]]" on-click="toggleFullscreen"></icon-button></div></div></template><script>class DeviceSVG extends WebvisualMixins.FetchMixin(WebvisualMixins.FullscreenMixin(Polymer.Element)){static get is(){return'device-svg'}static get properties(){return{urlPrefix:{type:String,value:'/images/'},src:{type:String},_recentSrc:{type:String},classForClicked:{type:String,value:'clicked'},classForSelected:{type:String,value:'selected'},classForExceeding:{type:String,value:'exceeding'},initial:{type:String,value:'',observer:'_initialChanged'},initiallyZoomToAll:Boolean,opened:{type:Boolean,reflectToAttribute:!0,observer:'_openedChanged'},minZoom:{type:Number,value:0.9},maxZoom:{type:Number,value:5},zoomPartition:{type:Number,value:2},selectable:{type:Object,value:function(){return{}}},currentSelectedCssSelector:{type:String,reflectToAttribute:!0,notify:!0},selectableFallback:{type:String,value:'rect,circle,path,polygon,ellipse'},multi:{type:Boolean,value:!1},multiClickable:{type:Boolean,value:!1},item:{type:Object},items:{type:Array},exceeding:{type:Array},clickEvent:{type:String,value:'item-select'},_height:{type:Number,value:0},_width:{type:Number,value:0},_mainG:{type:Object},_svg:{type:Object},_d3Zoom:{type:Object}}}static get observers(){return['_srcChanged(src)','_selectableChanged(selectable)','_selectedItemsChanged(item)','_selectedItemsChanged(items.length)','_exceedingChanged(exceeding.length)']}_openedChanged(){this.src&&(this._srcChanged(),!this._inialized&&this._initialize(),this._resetZoom())}open(a){this.setSvg(a.detail),this.opened=!0}close(){this.opened=!1}_srcChanged(a){a&&this._recentSrc!==a&&(this._recentSrc=a,this._fetch(a,'GET','include','xml').then(this._registerXML.bind(this)).catch((b)=>{console.log(a,b)}))}_registerXML(a){if(a&&a.documentElement){const b=document.importNode(a.documentElement.cloneNode(!0),!0);if(this._svg=d3.select(this.$.svgContainer).select('#main'),this._svg&&!this._svg.empty()&&this.$.svgContainer.removeChild(this._svg.node()),this.$.svgContainer.insertBefore(b,this.$.svgContainer.firstChild),this._svg=d3.select(b).attr('id','main').attr('preserveAspectRatio','xMinYMin meet').attr('height',null).attr('width',null).classed('style-scope',!0).classed('device-svg',!0),this._mainG=this._svg.select('g').attr('id','mainG'),this._mainG.selectAll('text').classed('style-scope',!0).classed('device-svg',!0),this._svg.attr('viewBox')){const a=this._svg.attr('viewBox').split(' ');this._width=a[2]-a[0],this._height=a[3]-a[1],this._ratio=this._height/this._width}this._initZoom(),this._initialize()}}_initialize(){setTimeout(()=>{this._selectableChanged(),this._selectedItemsChanged(),this._exceedingChanged()},0)}_initZoom(){this._d3Zoom=d3.zoom().scaleExtent([this.minZoom,this.maxZoom]).on('zoom',this._zoom.bind(this)),this._svg.call(this._d3Zoom)}_selectedItemsChanged(){const a=this.item,b=this.items;a&&Object.keys(a).length||b&&b.length?(!this.src&&(a&&a.svg&&a.svg.path?this.src=a.svg.path:0<b.length&&b[b.length-1].svg&&b[b.length-1].svg.path&&(this.src=b[b.length-1].svg.path)),this.opened=this.src&&(this.opened||this.forceOpened||this.openOnSelect),this._selectSelected()):this._mainG&&this._mainG.selectAll&&this._mainG.selectAll('.'+this.classForSelected).classed(this.classForSelected,!1)}_exceedingChanged(){const a=this.exceeding;a&&a.length?(!this.src&&a[a.length-1].svg&&a[a.length-1].svg.path&&(this.src=a[a.length-1].svg.path),this.opened=this.src&&(this.opened||this.forceOpened||this.openOnExceed),this._selectExceeds()):this._mainG&&this._mainG.selectAll&&this._mainG.selectAll('.'+this.classForExceeding).classed(this.classForExceeding,!1)}reset(){this.opened=!1,this.set('item',{}),this.set('items',[]),this.set('exceeding',[])}_initialChanged(a){this.src&&a&&this._resetZoom()}_selectableChanged(){if(!(this._mainG&&this._mainG.node&&this.src))return;const a=this;if(this.selectable&&this.selectable.items&&Object.keys(this.selectable.items).length)for(let b in this.selectable.items)this._mainG.selectAll(this.selectable.items[b]).classed('selectable style-scope device-svg',!0).attr('title',b).on('click',function(){if(a._mainG.selectAll('.'+a.classForClicked).classed(a.classForClicked,!1),a.multiClickable){const c=(a.currentSelectedCssSelector||'').split(','),d=c.indexOf(a.selectable.items[b]);-1===d?c.push(a.selectable.items[b]):c.splice(d,1),a.currentSelectedCssSelector=c.filter((a)=>''!==a).join(',')}else a.currentSelectedCssSelector=a.currentSelectedCssSelector===a.selectable.items[b]?'':a.selectable.items[b];a.currentSelectedCssSelector?(a._mainG.selectAll(a.currentSelectedCssSelector).classed(a.classForClicked,!0),a._zoomToElement(this)):a._resetZoom()});else this._mainG.selectAll('rect,circle,path,polygon,eclipse').classed('selectable style-scope device-svg',!0).on('click',function(){a._mainG.selectAll('.'+a.classForClicked).classed(a.classForClicked,!1);const b=a._cssPath(this);if(a.multiClickable){const c=(a.currentSelectedCssSelector||'').split(','),d=c.indexOf(b);-1===d?c.push(b):c.splice(d,1),a.currentSelectedCssSelector=c.filter((a)=>''!==a).join(',')}else a.currentSelectedCssSelector=a.currentSelectedCssSelector===b?'':b;a.currentSelectedCssSelector?(a._mainG.selectAll(a.currentSelectedCssSelector).classed(a.classForClicked,!0),a._zoomToElement(this)):a._resetZoom()});this.selectable.minZoom!==void 0&&(this.minZoom=this.selectable.minZoom),this.selectable.maxZoom!==void 0&&(this.maxZoom=this.selectable.maxZoom),this.selectable.zoomPartition!==void 0&&(this.zoomPartition=this.selectable.zoomPartition),this._initZoom(),this._inialized=!0}_cssPath(a){const b=[];for(;a.nodeType===Node.ELEMENT_NODE;){let c=a.nodeName;if(a.id)c+='#'+a.id;else{let b=a;const d=[];for(;null!==b&&b.nodeType===Node.ELEMENT_NODE;)d.unshift(b.nodeName),b=this._previousElementSibling(b);'HTML'!==d[0]&&(d[0]+=':first-child'),c=d.join(' + ')}b.unshift(c),a=a.parentNode}return b.join(' > ')}_previousElementSibling(a){if('undefined'!==a.previousElementSibling)return a.previousElementSibling;for(;a=a.previousSibling;)if(1===a.nodeType)return a}_zoom(){this._mainG.attr('transform',d3.event.transform)}_zoomToElement(a){if(void 0!==a&&this._svg.node()){const b=this._calcCenterZoom(a),c=d3.zoomIdentity.translate(b.x,b.y).scale(b.k);this._svg.node().__zoom=c,this._mainG.transition(500).attr('transform',c)}}_zoomToElements(a,b){if(a&&'string'===typeof a&&(a=this._mainG.selectAll(a).classed(b,!0)),!a.empty||a.empty())return void this._resetZoom();const c=[];a.each(function(){let a=this.getBoundingClientRect();c[0]=(c[0]>a.left?a.left:c[0])||a.left,c[1]=(c[1]>a.top?a.top:c[1])||a.top,c[2]=(c[2]<a.right?a.right:c[2])||a.right,c[3]=(c[3]<a.bottom?a.bottom:c[3])||a.bottom}),this._zoomToElement({left:c[0],top:c[1],height:c[3]-c[1],width:c[2]-c[0]})}_selectSelected(){setTimeout(()=>{const a=this.multi?this.items||[]:[];this.item&&Object.keys(this.item).length&&-1===a.indexOf(this.item)&&a.push(this.item);let b;if(b=ShadyCSS&&!0===ShadyCSS.nativeShadow?this.shadowRoot.querySelector('style'):document.querySelector('style[scope="device-svg"]'),b&&a&&a.length){let c,d,e;for(let f=0;f<a.length;f++)if(a[f]&&a[f].color&&a[f].svg&&a[f].svg.selector&&b&&b.sheet&&b.sheet.cssRules&&b.sheet.insertRule){c=a[f].svg.selector.split(',');for(let g=0;g<c.length;g++){d=c[g]+'.'+this.classForSelected,e=!1;for(let a=0;a<b.sheet.cssRules.length;a++)b.sheet.cssRules[f].selectorText===d&&(e=!0);!1===e&&b.sheet.insertRule(d+' {\nfill: '+a[f].color+' !important;\n}',b.sheet.cssRules.length)}}this.updateStyles(),this.select(a,this.classForSelected)}},0)}_selectExceeds(){this.exceeding&&this.exceeding.length&&this.select(this.exceeding,this.classForExceeding)}select(a,b){if(!(this._mainG&&this._mainG.node&&this.src))return;this._mainG=this._svg.select('g'),this._mainG.selectAll('.'+b).classed(b,!1);let c;const d=[];if(Array.isArray(a)){for(let b=0;b<a.length;b++)a[b].svg&&a[b].svg.selector&&d.push(a[b].svg.selector);c=d.join(',')}else c=a&&a.svg&&a.svg.selector?a.svg.selector:'';this._zoomToElements(c,b)}_calcCenterZoom(a){var b=Math.min;const c=this.getBoundingClientRect();if(void 0===c||void 0===a||0===c.height||0===c.width)return{x:0,y:0,k:1};const d=c.height/c.width;let e,f;e=void 0===a.nodeType?a:a.getBoundingClientRect();const g=this._mainG.node().getBBox(),h=this._mainG.node().getBoundingClientRect(),i=g.width/h.width||1;let j=(e.left-h.left)*i+g.x,k=(e.top-h.top)*i+g.y;const l=this._height,m=this._width,n=this._ratio,o=this.zoomPartition;return f=d<n?b(m/(o*e.width*i*d),l/(o*e.height*i)):b(m/(o*e.width*i),m*d/(o*e.height*i)),f<this.minZoom?f=this.minZoom:f>this.maxZoom&&(f=this.maxZoom),d<n?(j=-f*j+(l/d-f*e.width*i)/2,k=-f*k+(l-f*e.height*i)/2):(j=-f*j+(m-f*e.width*i)/2,k=-f*k+(m*d-f*e.height*i)/2),isNaN(j)||isNaN(k)||isNaN(f)?{x:0,y:0,k:1}:{x:j,y:k,k:f}}notifyResize(){this._resetZoom()}_resetZoom(a){a&&(a.preventDefault(),a.stopPropagation()),setTimeout(()=>{if(this.opened&&this._mainG&&this._mainG.node&&this.src){if(this._mainG.selectAll('.'+this.classForClicked).classed(this.classForClicked,!1),!this.initiallyZoomToAll){if(this.item&&Object.keys(this.item).length||this.items&&this.items.length)return void this._selectSelected();if(this.exceeding.length)return void this._selectExceeds();if(this.initial){const a=this._mainG.selectAll(this.initial);if(!(a&&a.empty()))return void this.select([{svg:{selector:this.initial}}],'initial')}}this._zoomToElement(this._mainG.node())}},0)}}customElements.define(DeviceSVG.is,DeviceSVG);</script><dom-module></dom-module></dom-module><script>window.WebvisualMixins=window.WebvisualMixins||{},WebvisualMixins.ScaleMixin=function(a){var b=Number.Epsilon;return class extends a{constructor(){super(),this._bisectDate=d3.bisector((a,b)=>a.x-b),this._bisectValue=d3.bisector((a,b)=>a.y-b)}static get properties(){return{scalingX:{type:String,value:'time'},scalingY:{type:String,value:'linear'},ticksX:{type:Number,value:10},ticksY:{type:Number,value:10},scaleBaseX:{type:Number},scaleBaseY:{type:Number},scaleX:{type:Function,computed:'_computeScaleFn(scalingX, scaleBaseX, "x")'},scaleY:{type:Function,computed:'_computeScaleFn(scalingY, scaleBaseY, "y")'},domainX:{type:Array},domainY:{type:Array},rangeX:{type:Array},rangeY:{type:Array}}}static get observers(){return['_domainXChanged(domainX)','_domainYChanged(domainY)','_rangeXChanged(rangeX)','_rangeYChanged(rangeY)','_scaleXChanged(scaleX)','_scaleYChanged(scaleY)']}_domainXChanged(a){void 0===a||void 0===this.scaleX||a.some((a)=>void 0===a||null===a)||(this._IS_LOG_SCALE(this.scalingX)&&0>=a[0]?this.scaleX.domain([b,a[1]]):this.scaleX.domain(a))}_domainYChanged(a){void 0===a||void 0===this.scaleY||a.some((a)=>void 0===a||null===a)||(this._IS_LOG_SCALE(this.scalingY)&&0>=a[0]?this.scaleY.domain([b,a[1]]):this.scaleY.domain(a),this.scaleY.nice())}_rangeXChanged(a){void 0===a||void 0===this.scaleX||a.some((a)=>void 0===a||null===a)||this.scaleX.range(a)}_rangeYChanged(a){void 0===a||void 0===this.scaleY||a.some((a)=>void 0===a||null===a)||this.scaleY.range(a).nice()}_scaleXChanged(a){}_scaleYChanged(a){}_computeScaleFn(a,b,c){if(void 0!==a){const d='time'===a?d3.scaleTime():'ln'===a?d3.scaleLog().base(Math.E):'log'===a?d3.scaleLog().base(b||10):'log\u2082'===a?d3.scaleLog().base(2):'log\u2081\u2080'===a?d3.scaleLog().base(10):'\u221A'===a?d3.scalePow().exponent(0.5):'pow'===a?d3.scalePow().exponent(b||1):d3.scaleLinear();return'x'===c?(d.ticks(this.ticksX||10),this.domainX&&d.domain(this.domainX),this.rangeX&&d.range(this.rangeX)):'y'===c&&(d.ticks(this.ticksY||10),this.domainY&&d.domain(this.domainY),this.rangeY&&d.range(this.rangeY),d.nice()),d}}static get _VALID_SCALES(){return['time','ln','log','log\u2082','log\u2081\u2080','\u221A','pow']}_SCALE_USES_BASE(a){return'log'===a||'pow'===a}_IS_LOG_SCALE(a){return-1<['ln','log','log\u2082','log\u2081\u2080'].indexOf(a)}}};</script><script>window.WebvisualMixins=window.WebvisualMixins||{},WebvisualMixins.AxesMixin=function(a){var b=Math.ceil;return class extends WebvisualMixins.ScaleMixin(a){constructor(){super()}static get properties(){return{axisOrientX:{type:String,value:'bottom'},axisOrientY:{type:String,value:'left'},axisTitle:{type:String},axisColor:{type:String,observer:'_axisColorChanged'},tickSize:{type:Number,value:10},collapsedAxisMargin:{type:Number,value:5},axisSizeX:{type:Number,value:25},axisSizeY:{type:Number,value:60},draggable:{type:Boolean,observer:'_draggableChanged'},brushToZoom:{type:Boolean,observer:'_brushToZoomChanged'},_axisInsertionPoint:{type:Object},axisX:{type:Object},axisY:{type:Object},axisGeneratorX:{type:Function},axisGeneratorY:{type:Function},axisBrushGeneratorX:{type:Function,value:function(){return d3.brushX().on('end',this._onAxisBrushEnd.bind(this,'x'))}},axisBrushGeneratorY:{type:Function,value:function(){return d3.brushY().on('end',this._onAxisBrushEnd.bind(this,'y'))}},timeFormat:{type:Function,value:function(){return d3.timeFormat}},numberFormat:{type:Function,value:function(){return d3.format}},localeNumber:{type:Object},localeDate:{type:Object}}}static get observers(){return['_setDateNumberFormat(localeNumber, localeDate)']}_rangeXChanged(a){super._rangeXChanged(a),a[1]&&(this.ticksX=b(a[1]/70))}_rangeYChanged(a){super._rangeYChanged(a),a[0]&&(this.item&&this.item.isIndicatorLamp?(this.ticksY=2,this.axisSizeY=2*(this.tickSize+this.collapsedAxisMargin)):this.ticksY=b(a[0]/50))}_scaleXChanged(a){void 0===a||(super._scaleXChanged(a),this.axisX&&!this.axisX.attr('hidden')&&this.scaleX&&(this.axisGeneratorX=this._computeAxisGenerator(this.axisOrientX,this.scaleX,this.scalingX,this.scaleBaseX).ticks(this.ticksX).tickSize(this.tickSize).tickFormat(this.axisX.classed('expanded')?this._computeFormatFn(this.scalingX,this.scaleBaseX):''),this._updateAxisBrushGenerator.call(this.axisBrushGeneratorX,this.rangeX,this.axisOrientX),this.brushToZoom&&this.axisX.select('.brush').raise().call(this.axisBrushGeneratorX),this.axisX.attr('transform','translate('+(this.axisX._left||0)+','+(this.axisX._top||0)+')')),this.redraw())}_scaleYChanged(a){void 0===a||(super._scaleYChanged(a),this.axisY&&!this.axisY.attr('hidden')&&this.scaleY&&(this.axisGeneratorY=this._computeAxisGenerator(this.axisOrientY,this.scaleY,this.scalingY,this.scaleBaseY).ticks(this.ticksY).tickSize(this.tickSize).tickFormat(this.axisY.classed('expanded')?this._computeFormatFn(this.scalingY,this.scaleBaseY):''),this._updateAxisBrushGenerator.call(this.axisBrushGeneratorY,this.rangeY,this.axisOrientY),this.brushToZoom&&this.axisY.select('.brush').raise().call(this.axisBrushGeneratorY),this.axisY.attr('transform','translate('+(this.axisY._left||0)+','+(this.axisY._top||0)+')')),this.redraw())}_computeAxisNode(a,b,c,d){if(void 0!==a){const e=this.axisColor||'';c=c||this.axisTitle||'';const f=this._isVertical(b);if(d&&d.node){const a=d.node();a&&a.parentElement&&a.parentElement.removeChild(a),d=null}const g=a.append('svg:g').classed('axis',!0).attr('orient',b).classed('y',f).classed('vertical',f).classed('x',!f).classed('expanded',!0).style('color',e);return g.on('mouseover',this._onAxisMouseover.bind(this)).on('mouseleave',this._onAxisMouseleave.bind(this)).on('click',this._onAxisClicked.bind(this,g)),this.draggable&&g.classed('draggable',!0).call(d3.drag().on('start',this._onAxisDragStart).on('drag',this._onAxisDragged).on('end',this._onAxisDragEnd)),g.append('svg:title').text(c),g.append('svg:g').classed('brush',!0).on('contextmenu',this._onAxisContextMenu.bind(this,b)),g.node()._genitor=this,g.node()._axis=g,g._left=0,g._right=0,g._bottom=0,g._top=0,g}}_updateAxisBrushGenerator(a,b,c){c=c||8;const d=[[0,0],[a[1],a[0]]];'left'===b?d[0][0]=-c:'right'===b?d[1][0]=c:'top'===b?d[0][1]=-c:'bottom'===b&&(d[1][1]=c),this.extent(d)}_computeAxisGenerator(a,b,c,d){if(a&&void 0!==b&&void 0!==c){const e=this.tickSize||6;return('left'===a?d3.axisLeft(b):'right'===a?d3.axisRight(b):'top'===a?d3.axisTop(b):d3.axisBottom(b)).tickSize(e).tickFormat(this._computeFormatFn(c,d))}}_setAxisProperties(a,b,c){a.classed('expanded',c),b.tickFormat(c?null:'')}_removeAxes(){let a;this.axisX&&this.axisX.node&&(a=this.axisX.node(),a&&a.parentElement&&a.parentElement.removeChild(a),this.axisX=null),this.axisY&&this.axisY.node&&(a=this.axisY.node(),a&&a.parentElement&&a.parentElement.removeChild(a),this.axisY=null),delete this.axisGeneratorY,delete this.axisGeneratorX,delete this.axisBrushGeneratorY,delete this.axisBrushGeneratorX}_toggleAxis(a){const b=a.classed('expanded');a.classed('expanded',!b),this.sizeChanged()}_onAxisClicked(a){this._activeToggleAxisJob&&clearTimeout(this._axisToggleAxisJob),this._activeToggleAxisJob=setTimeout(()=>{this._toggleAxis(a),this._activeToggleAxisJob=null},300)}_onAxisContextMenu(a){d3.event&&d3.event.preventDefault();'left'===a||'right'===a?(this.axisY._isBrushed=!1,this.domainY&&this.domainY.some((a)=>void 0===a||null===a)&&this.scaleY.domain(this.domainY).nice(),this.axisY.call(this.axisGeneratorY.scale(this.scaleY))):(this.axisX._isBrushed=!1,this.domainX&&this.domainX.some((a)=>void 0===a||null===a)&&this.scaleX.domain(this.domainX).nice(),this.axisX.call(this.axisGeneratorX.scale(this.scaleX))),this.redraw()}_onAxisMouseover(){this.axisX.select('.brush').raise(),this.axisY.select('.brush').raise(),this.axisX.raise(),this.axisY.raise()}_onAxisMouseleave(){}_draggableChanged(a){void 0===this.axisX||void 0===this.axisY||(!0===a?(this.axisX.call(d3.drag().on('start',this._onAxisDragStart).on('drag',this._onAxisDragged).on('end',this._onAxisDragEnd)),this.axisY.call(d3.drag().on('start',this._onAxisDragStart).on('drag',this._onAxisDragged).on('end',this._onAxisDragEnd)),this.brushToZoom=!1):(this.axisX.on('.drag',null),this.axisY.on('.drag',null)),this.axisX.classed('draggable',a),this.axisY.classed('draggable',a))}_brushToZoomChanged(a){void 0===this.axisX||void 0===this.axisY||(!0===a?(this._updateAxisBrushGenerator.call(this.axisBrushGeneratorX,this.rangeX,this.axisOrientX),this._updateAxisBrushGenerator.call(this.axisBrushGeneratorY,this.rangeY,this.axisOrientY),this.axisX.select('.brush').call(this.axisBrushGeneratorX),this.axisY.select('.brush').call(this.axisBrushGeneratorX),this.draggable=!1):(this.axisX.select('.brush').on('.brush',null),this.axisY.select('.brush').on('.brush',null)))}_onAxisDragStart(){d3.select(this).raise().classed('dragged',!0);const a=d3.select(this).classed('vertical');a?(this._startleft=d3.event.x,this._starttop=0):(this._startleft=0,this._starttop=d3.event.y)}_onAxisDragged(){const a=d3.select(this).classed('vertical');let b=0,c=0;a?b=(this._axis._left||0)+d3.event.x-this._startleft:c=(this._axis._top||0)+d3.event.y-this._starttop,d3.select(this).attr('transform','translate('+b+','+c+')')}_onAxisDragEnd(){d3.select(this).classed('dragged',!1);const a=d3.select(this).classed('vertical'),b=this._genitor;let c,d=0,e=0;if(a){if(d=(this._axis._left||0)+d3.event.x-this._startleft,c=d>b.rangeX[1]/2?'right':'left',c!==b.axisOrientY)return b.axisGeneratorY=b._computeAxisGenerator(b.axisOrientY=c,b.scaleY,b.scalingY,b.scaleBaseY).ticks(b.ticksY).tickSize(b.tickSize).tickFormat(b.axisY.classed('expanded')?b._computeFormatFn(b.scalingY,b.scaleBaseY):''),b.axisY=b._computeAxisNode(b._axisInsertionPoint,c,b.item&&b.item.mount,b.axisY).classed('expanded',!0).call(b.axisGeneratorY),void b.sizeChanged();d=this._axis._left}else{if(e=(this._axis._top||0)+d3.event.y-this._starttop,c=e>b.rangeY[0]/2?'bottom':'top',c!==b.axisOrientX)return b.axisGeneratorX=b._computeAxisGenerator(b.axisOrientX=c,b.scaleX,b.scalingX,b.scaleBaseX).ticks(b.ticksX).tickFormat(b.axisX.classed('expanded')?b._computeFormatFn(b.scalingX,b.scaleBaseX):''),b.axisX=b._computeAxisNode(b._axisInsertionPoint,c,b.item&&b.item.mount,b.axisX).classed('expanded',!0).call(b.axisGeneratorX),void b.sizeChanged();e=this._axis._top}d3.select(this).attr('transform','translate('+d+','+e+')'),this._startleft=0,this._starttop=0}_onAxisBrushEnd(a){if(d3.event.sourceEvent&&'zoom'===d3.event.sourceEvent.type)return;const b=d3.event.selection;if(!b)return;let c;'y'===a?(c=b.map(this.scaleY.invert,this.scaleY).sort((c,a)=>c>a),this.axisY._isBrushed=!0,this.scaleY.domain(c).nice(),this.axisY.transition().call(this.axisGeneratorY.scale(this.scaleY)),this.axisY.select('.brush').call(this.axisBrushGeneratorY.move,null)):(c=b.map(this.scaleX.invert,this.scaleX).sort((c,a)=>c>a),this.axisX._isBrushed=!0,this.scaleX.domain(c),this.axisX.transition().call(this.axisGeneratorX.scale(this.scaleX)),this.axisX.select('.brush').call(this.axisBrushGeneratorX.move,null)),this.redraw()}_axisColorChanged(a){this.axisX&&this.axisX.style('color',a),this.axisY&&this.axisY.style('color',a)}static get _VALID_AXIS_POSITIONS(){return['top','right','bottom','bottom']}_isVertical(a){return'left'===a||'right'===a}_computeFormatFn(){return'time'===arguments[0]?this.formatTime.bind(this):this.item&&this.item.isIndicatorLamp?this.formatIndicator.bind(this,this.item.threshold):this.formatNumber.bind(this)}sizeChanged(){}redraw(){}formatTime(a){return(d3.timeSecond(a)<a?this.timeFormat('.%L'):d3.timeMinute(a)<a?this.timeFormat(':%S'):d3.timeHour(a)<a?this.timeFormat('%H:%M'):d3.timeDay(a)<a?this.timeFormat('%X'):d3.timeMonth(a)<a?d3.timeWeek(a)<a?this.timeFormat('%e.%m.'):this.timeFormat('%d. %b'):d3.timeYear(a)<a?this.timeFormat('%d. %b'):this.timeFormat('%Y'))(a)}formatTimeRange(a,b,c){const d=(b[1]-b[0]).valueOf()/c;return(100>d?this.timeFormat(':%S.%L'):500>d?this.timeFormat(':%M:%S.%L'):5E3>d?this.timeFormat(':%M:%S'):2E4>d?this.timeFormat('%H:%M:%S'):6E4>d?this.timeFormat('%H:%M'):36E5>d?this.timeFormat('%X'):864E5>d?this.timeFormat('%d.%m'):6048E5>d?this.timeFormat('%d.%m'):24192E5>d?this.timeFormat('%d. %b'):this.timeFormat('%Y'))(a)}formatTimeAbsolute(a){const b=a%315576E5,c=(a-b)/315576E5,e=b%864E5,f=(b-e)/864E5,d=e%36E5,g=(e-d)/36E5,h=d%6E4,i=(d-h)/6E4,j=h%1E3,k=(h-j)/1E3;let l='';return c&&(l+=c+'y '),f&&(l+=f+'d '),g&&(l+=g+'h '),i&&(l+=i+'m '),k&&(l+=k+'s '),j&&(l+=j+'ms'),l}formatNumber(a){return this.numberFormat(',g')(a)}formatIndicator(a,b){return a&&a.from&&a.to?b<a.from||b>a.to?'\u2717':'\u2713':b?'\u2717':'\u2713'}_setDateNumberFormat(a,b){'object'!==typeof b||'object'!==typeof a||(b&&(this.localeDate=b,d3.timeFormatDefaultLocale(b),this.timeFormat=d3.timeFormatLocale(b).format),a&&(this.localeNumber=a,d3.formatDefaultLocale(a),this.numberFormat=d3.formatLocale(a).format),this.axisGeneratorX&&(this.axisGeneratorX=this._computeAxisGenerator(this.axisOrientX,this.scaleX,this.scalingX,this.scaleBaseX).ticks(this.ticksX).tickSize(this.tickSize),this.axisX&&this.axisX.call(this.axisGeneratorX.tickSize(this.tickSize).tickFormat(this.axisX.classed('expanded')?this._computeFormatFn(this.scalingX,this.scaleBaseX):''))),this.axisGeneratorY&&(this.axisGeneratorY=this._computeAxisGenerator(this.axisOrientY,this.scaleY,this.scalingY,this.scaleBaseY).ticks(this.ticksY).tickSize(this.tickSize),this.axisY&&this.axisY.call(this.axisGeneratorY.tickSize(this.tickSize).tickFormat(this.axisY.classed('expanded')?this._computeFormatFn(this.scalingY,this.scaleBaseY):''))))}}};</script><dom-module id="device-graph"><template><style></style></template><script>class DeviceGraph extends WebvisualMixins.AxesMixin(WebvisualMixins.ColorMixin(WebvisualMixins.DeviceMixin(Polymer.Element))){static get is(){return'device-graph'}static get properties(){return{hasLine:{type:Boolean,value:!0},hasArea:{type:Boolean,value:!1},interpolation:{type:String,value:'curveLinear',observer:'_interpolationChanged'},lineWidth:{type:Number,value:1,observer:'_lineWidthChanged'},dotRadius:{type:Number,value:3.75},viewLength:{type:Number,value:3e4},storeInside:{type:Boolean,value:!0,readOnly:!0}}}constructor(){super(),this._isAttached=!1,this._chart=this._containerRoot,this._areaGenerator=d3.area(),this._lineGenerator=d3.line()}static get observers(){return['_itemChanged(item)','_thresholdChanged(item.threshold)']}get _containerRoot(){const a=Polymer.dom(this).getOwnerRoot();return a?a.host||a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:void 0:Polymer.dom(this).parentNode}connectedCallback(){super.connectedCallback(),this.item&&this.addNodes()}disconnectedCallback(){this._isAttached=!1,this.removeNodes(),super.disconnectedCallback()}_domainXChanged(a){void 0===a||void 0===this.scaleX||a.some((a)=>void 0===a||null===a)||(this._IS_LOG_SCALE(this.scalingX)&&0>=a[0]?super._domainXChanged([d3.min(this.values.filter((a)=>0<a.x),(a)=>a.x),a[1]]):super._domainXChanged(a))}_domainYChanged(a){void 0===a||void 0===this.scaleY||a.some((a)=>void 0===a||null===a)||(this._IS_LOG_SCALE(this.scalingY)&&0>=a[0]?super._domainYChanged([d3.min(this.values.filter((a)=>0<a.y),(a)=>a.y),a[1]]):super._domainYChanged(a))}_scaleXChanged(a){void 0===a||(this._IS_LOG_SCALE(this.scalingX)&&0>=this.domainX[0]&&this._domainXChanged([d3.min(this.values.filter((a)=>0<a.x),(a)=>a.x),this.domainX[1]]),this._areaGenerator.x((b)=>a(b.x)),this._lineGenerator.x((b)=>a(b.x)),this._interpolationChanged(this.interpolation),super._scaleXChanged(a))}_scaleYChanged(a){void 0===a||(this._IS_LOG_SCALE(this.scalingY)?(0>=this.domainY[0]&&this._domainYChanged([d3.min(this.values.filter((a)=>0<a.y),(a)=>a.y),this.domainY[1]]),this._areaGenerator.y0(()=>this._chart._height).y1((b)=>0<b.y?a(b.y):this._chart._height),this._lineGenerator.y((b)=>0<b.y?a(b.y):this._chart._height)):(this._areaGenerator.y0(()=>a(0)).y1((b)=>a(b.y)),this._lineGenerator.y((b)=>a(b.y))),super._scaleYChanged(a))}_assignToChart(){const a=this._containerRoot;return a&&'DEVICE-CHART'===a.nodeName?a._isAttached?(this._chart=a,this._axisInsertionPoint=this._chart._axisInsertionPoint,this._chart._addGraph(this),!0):void console.warn('Chart has not been attached yet for adding a graph. Registration of Graph Element failed'):void console.warn('No parentElement (chart) for graph found. Registration of Graph Element failed',a)}addNodes(){this._assignToChart()&&(this._isAttached&&this.clearValues(!0),!this._chart.multiAxesX&&this.set('domainX',this._chart.domainX),!this._chart.multiAxesY&&this.set('domainY',this._chart.domainY),this.set('rangeX',this._chart.rangeX),this.set('rangeY',this._chart.rangeY),this._setColorProperties(),this._areaChanged(),this._lineChanged(),!this.axisX&&(this.axisX=this._computeAxisNode(this._axisInsertionPoint,this.axisOrientX,this.item.mount).attr('hidden',!this._chart.multiAxesX||null)),!this.axisY&&(this.axisY=this._computeAxisNode(this._axisInsertionPoint,this.axisOrientY,this.item.mount).attr('hidden',!this._chart.multiAxesY||null).classed('vertical',!0)),this.scaleX&&(this.axisGeneratorX=this._computeAxisGenerator(this.axisOrientX,this.scaleX,this.scalingX,this.scaleBaseX)),this.scaleY&&(this.axisGeneratorY=this._computeAxisGenerator(this.axisOrientY,this.scaleY,this.scalingY,this.scaleBaseY)),this._isAttached=!0)}removeNodes(){let a;this.axisX&&(a=this.axisX.node(),a&&a.parentElement&&a.parentElement.removeChild(a)),this.axisY&&(a=this.axisY.node(),a&&a.parentElement&&a.parentElement.removeChild(a)),this._area&&this._area.node&&(a=this._area.node(),a&&a.parentElement&&a.parentElement.removeChild(a),this._area=null),this._line&&this._line.node&&(a=this._line.node(),a&&a.parentElement&&a.parentElement.removeChild(a),this._line=null),this._thresholdChanged(),this._chart._removeGraph(this)}_areaChanged(){this._chart&&this._chart._area&&(!(this._area&&this._area.node)&&(this._area=this._chart._area.append('svg:path'),this._area.append('svg:title').text(this.item.mount)),this._area.attr('mount',this.item.mount).attr('class','area').attr('stroke-width',0).attr('fill',this.item.theshold===void 0?this.item.color||'#FFF':'url(#boundery-line-'+this.item.mount+')'),this._areaGenerator&&this._area.attr('d',this._areaGenerator(this.values||[])))}_lineChanged(){this._chart&&this._chart._line&&(!(this._line&&this._line.node)&&(this._line=this._chart._line.append('svg:path'),this._line.append('svg:title').text(this.item.mount)),this._line.attr('mount',this.item.mount).attr('class','line').attr('fill','none').attr('stroke',this.item.theshold===void 0?this.item.color||'#000':'url(#boundery-line-'+this.item.mount+')').attr('stroke-width',this.lineWidth),this._lineGenerator&&this._line.attr('d',this._lineGenerator(this.values||[])))}_thresholdChanged(a){if(this._chart&&this._chart._defs)if(a)this.boundery||(this.boundery=this._chart._defs.append('linearGradient')),this.boundery.attr('id','boundery-line-'+this.item.mount).attr('gradientUnits','userSpaceOnUse').attr('x1',0).attr('y1',this._chart._height).attr('x2',0).attr('y2',0),this._area&&this._area.attr&&this._area.attr('fill','url(#boundery-line-'+this.item.mount+')'),this._line&&this._line.attr&&this._line.attr('stroke','url(#boundery-line-'+this.item.mount+')');else{if(this.boundery&&this.boundery.node){let a=this.boundery.node();a&&a.parentElement&&a.parentElement.removeChild(a),this.boundery=null}this._area&&this._area.attr&&this._area.attr('fill',this.item.color||'#FFF'),this._line&&this._line.attr&&this._line.attr('stroke',this.item.color||'#000')}}_setColorProperties(){!this._chart||this.item&&this.item.color&&(this.axisColor=this.item.color,this._area&&this._area.attr&&this._area.attr('fill',this.item.theshold===void 0?this.item.color||'#FFF':'url(#boundery-line-'+this.item.mount+')'),this._line&&this._line.attr&&this._line.attr('stroke',this.item.theshold===void 0?this.item.color||'#000':'url(#boundery-line-'+this.item.mount+')'))}_itemChanged(a){return this._isAttached?a&&a.mount?void this.addNodes():void this.removeNodes():void 0}insertValues(a,b){if(void 0!==a){if(b=b||(0<this.viewLength?this.viewLength:a.length),b&&(a=a.slice(a.length-b,a.length)),this.storeInside){this.values=this.values.concat(a);let b=this.min(this.values,'x'),c=this.max(this.values,'x');void 0!==b&&void 0!==c&&(!this.axisX||this.axisX._isBrushed||this._chart.axisX._isBrushed||this._chart._isZoomed&&!this._chart.multiAxesX?!this._chart.multiAxesX&&(b<this._chart.domainX[0]&&this._chart.set('domainX',[b,this._chart.domainX[1]]),c>this._chart.domainX[1]&&this._chart.set('domainX',[this._chart.domainX[0],c])):this.set('domainX',[b,c])),b=this.min(this.values,'y'),c=this.max(this.values,'y'),void 0!==b&&void 0!==c&&(b===c&&(b--,c++),!this.axisY||this.axisY._isBrushed||this._chart.axisY._isBrushed||this._chart._isZoomed&&!this._chart.multiAxesY?!this._chart.multiAxesY&&(b<this._chart.domainY[0]&&this._chart.set('domainY',[b,this._chart.domainY[1]]),c>this._chart.domainY[1]&&this._chart.set('domainY',[this._chart.domainY[0],c])):this.set('domainY',[b,c]))}this.renderInsertedValues(a)}}renderClearing(){this._area.attr('d',this._areaGenerator([])),this._line.attr('d',this._lineGenerator([]))}spliceValues(a){for(let b=0;b<a.length;b++){let c;for(c=0;c<this.values.length&&!(this.values[c].x===a[b].x);c++);c!==this.values.length&&this.values.splice(c,1)}this.redraw()}renderInsertedValues(a){if(!this._isAttached&&this.item&&this.addNodes(),this._chart){let b;this._chart.domainX&&this._chart.domainX.some((a)=>void 0===a||null===a)&&(this._chart.set('domainX',this.domainX),b=!0),this._chart.domainY&&this._chart.domainY.some((a)=>void 0===a||null===a)&&(this._chart.set('domainY',this.domainY),b=!0),this._chart.multiAxesY&&this._chart.multiAxesX||this._chart._isZoomed||(b=!0),this.redraw(b,a)}}sizeChanged(){this._isAttached&&this._chart.sizeChanged()}redraw(a,b){var c=Number.isFinite;if(this._isAttached&&this.scaleX&&this.scaleY){if(a)return void this._chart.redraw(!0);const d=this.values||b||[];if(this._area.attr('d',this._areaGenerator(this.hasArea?d:[])),this._line.attr('d',this._lineGenerator(this.hasLine?d:[])),this.item&&this.item.threshold){this.boundery&&this.boundery.node||this._thresholdChanged(this.item.threshold);const a=[],b=this.getComputedStyleValue('--device-state-exceeds-color')||'#F20C0C',d=this.getComputedStyleValue('--device-state-deceeds-color')||'#F20C0C',e=this.item.color||'#000';let f;void 0!==this.item.threshold.from&&(f=100*(1-Math.ceil(this.scaleY(this.item.threshold.from)+1.25*this.lineWidth)/this._chart._height),c(f)&&(a.push({o:f+'%',c:d}),a.push({o:f+'%',c:e}))),void 0!==this.item.threshold.to&&(f=100*(1-Math.floor(this.scaleY(this.item.threshold.to)-1.25*this.lineWidth)/this._chart._height),c(f)&&(a.push({o:f+'%',c:e}),a.push({o:f+'%',c:b})));const g=this.boundery.attr('x1',0).attr('y1',this._chart._height).attr('x2',0).attr('y2',0).selectAll('stop').data(a);g.attr('offset',function(a){return a.o}).attr('stop-color',function(a){return a.c}),g.enter().append('stop').attr('offset',function(a){return a.o}).attr('stop-color',function(a){return a.c}),g.exit().remove()}}}_getDomain(a,b){return new Promise((c,d)=>{const e='y'===a,f=e?this.scalingY:this.scalingX;this.requestRange(a).then((d)=>{var g=Number.EPSILON,h=Math.sign;if(d[0]!==void 0&&d[1]!==void 0){e&&d[0]===d[1]&&(d[0]--,d[1]++);let c=this._IS_LOG_SCALE(f);if(c){let a=0<d[0]*d[1];a&&0>=d[0]&&(d[0]=h(d[1])*g),a&&0>=d[1]&&(d[1]=h(d[0])*g)}b&&('x'===a?this.set('domainX',d):'y'===a&&this.set('domainY',d))}c({domain:d,key:a})}).catch((a)=>{d(a)})})}_closestPoint(a){var b=Math.ceil;const c=this.values.length,d=+this.scaleX.invert(a[0]),e=b(this._chart._width/c),f=Math.pow(b(c/this._chart._width),2),g=this._bisectDate.left;let h=g(this.values,d,0,c-1),j=this._pixdistance2(this.values[h],a);const i=Math.sqrt(j)/f,k=+this.scaleX.invert(a[0]-i);let l=g(this.values,k,0,h);(0>l||l>=c-1)&&(l=0),h===l&&h++;let m=2*h-l;(m>c||0>=m)&&(m=c);let n,o=h;for(let b=l;b<m;b+=e)(n=this._pixdistance2(this.values[b],a))<=j&&(h=b,j=n);o=h;for(let b=h+1;b<m&&b<h+e-1;b++)(n=this._pixdistance2(this.values[b],a))<=j&&(j=n,o=b);for(let b=h-1;b>l&&b>h-e+1;b--)(n=this._pixdistance2(this.values[b],a))<=j&&(j=n,o=b);return{x:this.values[o].x,y:this.values[o].y}}_pixdistance2(a,b){const c=this.scaleX(a.x)-b[0],d=this.scaleY(a.y)-b[1];return c*c+d*d}_closestInterpolatedPoint(a,b){function c(b){const c=b.x-a[0],d=b.y-a[1];return c*c+d*d}b=b||this._area.node()||this._line.node();const d=b.getTotalLength();let e,f,g=2*Math.ceil(d/this._chart._width/2),h=Infinity;for(let i,j,k=0;k<=d;k+=g)(j=c(i=b.getPointAtLength(k)))<h&&(e=i,f=k,h=j);for(g/=2;0.5<g;){let a,i,j,k,l,m;0<=(j=f-g)&&(l=c(a=b.getPointAtLength(j)))<h?(e=a,f=j,h=l):(k=f+g)<=d&&(m=c(i=b.getPointAtLength(k)))<h?(e=i,f=k,h=m):g/=2}return e={x:this.scaleX(e.x),y:this.scaleY(e.y)},e.distance=Math.sqrt(h),e}setColor(a){super.setColor.call(this,a),this._setColorProperties()}clearValues(a){super.clearValues.call(this,a)}_lineWidthChanged(a){this._line&&this._line.attr&&this._line.attr('stroke-width',a)}_interpolationChanged(a){if(a&&a.match(/curve.*/)&&a in d3){const b=d3[a];this._areaGenerator.curve(b),this._lineGenerator.curve(b)}}_onAxisClicked(a){return this._activeToggleAxisJob?(clearTimeout(this._activeToggleAxisJob),this._activeToggleAxisJob=null,void((a._isBrushed||this._isZoomed)&&this._chart._resetZoom())):void super._onAxisClicked(a)}_onAxisMouseover(){super._onAxisMouseover(),this._area&&(this._area.raise(),!1===this.hasArea&&this._area.transition().attr('d',this._areaGenerator(this.values||[]))),this._line&&this._line.raise()}_onAxisMouseleave(){super._onAxisMouseleave(),this._area&&!1===this.hasArea&&this._area.attr('d',this._areaGenerator([]))}}customElements.define(DeviceGraph.is,DeviceGraph);</script></dom-module><dom-module id="dialog-chart-export"><template strip-whitespace=""><style include="input-style button-style selectbox-style">:host{outline:none;}#dialog{border-radius:0;padding:0;width:100%;height:100%;}#chartContainer{display:block;position:relative;box-sizing:border-box;margin:0;padding:8px;flex:1 1 auto;overflow:auto;}#chartContainer > *{color:inherit;}#chartContainer > device-chart{margin:0;padding:0;--chart-text-color:#000;--chart-plot-background-opacity:1;height:100%;width:100%;}#options{position:absolute;--drawer-width:12em;--drawer-background:rgba(255,255,255,0.5);--drawer-scrim-background:rgba(0,0,0,0.25);--drawer-content:{padding:0;};}.options-content{color:var(--primary-text-color);display:flex;flex-direction:column;height:100%;padding:0.75em;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;}.options-content > *{margin-top:0;margin-bottom:0.5em;text-align:left;word-break:break-all;flex-shrink:0;position:relative;font-size:0.8em;}.input{background:rgba(255,255,255,0.5);}[hidden]{display:none !important;}</style><dialog-element id="dialog" on-iron-overlay-opened="_setDimensions"><div dialog-title=""><div>[[localize('chart', 'export')]]</div></div><div dialog-content="" horizontal=""><div id="chartContainer"></div><drawer-element id="options" opened$="{{styleOptionsOpened}}" scrim="" stretch="" align="right"><div class="options-content"><div class="selectbox"><select value="{{exportFormat::change}}"><option value="svg">.svg</option><option value="png">.png</option><option value="jpg">.jpg</option></select><span>[[localize('chart', 'export-format')]]</span></div><template is="dom-if" if="[[_nequals(exportFormat, 'svg')]]"><div class="input"><input type="range" min="0" max="1" step="0.01" value="{{quality::input}}"><div class="decorator" error-message$=">= 0"><label>[[localize('chart', 'quality')]]</label></div></div><div class="input"><input type="number" min="72" step="1" value="{{resolution::input}}"><div class="decorator" error-message$=">= 0"><label>[[localize('chart', 'resolution')]]</label><div class="underline"></div></div></div></template><div class="input"><input type="number" min="0" step="1" value="{{height::input}}"><div class="decorator" error-message$=">= 0"><label>[[localize('chart', 'height')]]</label><div class="underline"></div></div></div><div class="input"><input type="number" min="0" step="1" value="{{width::input}}"><div class="decorator" error-message$=">= 0"><label>[[localize('chart', 'width')]]</label><div class="underline"></div></div></div><div class="input"><input type="number" min="1" step="1" value="{{fontSize::input}}"><div class="decorator" error-message$=">= 0"><label>[[localize('chart', 'font-size')]]</label><div class="underline"></div></div></div><div class="input"><input type="color" value="{{fontColor::input}}"><label>[[localize('chart', 'font-color')]]</label></div><div class="input"><input type="color" value="{{backgroundColor::input}}"><label>[[localize('chart', 'background-color')]]</label></div><div class="input"><input type="color" value="{{lineColor::input}}"><label>[[localize('chart', 'line-color')]]</label></div></div></drawer-element></div><div dialog-bottom="" class="buttons"><div class="button" on-click="toggleOptions"><paper-ripple></paper-ripple><iron-icon class="left" icon="tune"></iron-icon>[[localize('options')]]</div><div class="button" on-click="toggleStyleOptions"><paper-ripple></paper-ripple><iron-icon class="left" icon="style"></iron-icon>[[localize('style')]]</div><div class="button" on-click="fitInContainer"><paper-ripple></paper-ripple><iron-icon class="left" icon="aspect-ratio"></iron-icon>[[localize('fit')]]</div><div class="button" on-click="save"><paper-ripple></paper-ripple><iron-icon class="left" icon="camera-alt"></iron-icon>[[localize('save')]]</div></div></dialog-element></template><script>class DialogChartExport extends WebvisualMixins.LocalizeMixin(Polymer.mixinBehaviors([Polymer.IronResizableBehavior],Polymer.Element)){static get is(){return'dialog-chart-export'}static get properties(){return{opened:{type:Boolean,reflectToAttribute:!0,notify:!0,observer:'_openedChanged'},styleOptionsOpened:{type:Boolean,value:!1},exportFormat:{type:String,value:'svg'},resolution:{type:Number,value:150},quality:{type:Number,value:0.5},height:{type:Number},width:{type:Number},backgroundColor:{type:String,value:'#ffffff'},fontColor:{type:String,value:'#151515'},fontSize:{type:Number,value:11},lineColor:{type:String,value:'#151515'},localesUrlPrefix:{type:String,value:'/locales/ui/'}}}static get observers(){return['_setDimensions(height, width)','_styleChanged(backgroundColor, fontColor, lineColor, fontSize, showInfo, showLegend)']}static get listeners(){return{"iron-resize":'_setDimensions'}}constructor(){super(),this.setChartElement(...arguments)}connectedCallback(){super.connectedCallback(),this._isAttached=!0,this._attachChartElement(),this._getPPI()}setChartElement(a){a&&(this._chart&&this._detachChartElement(),this._chart=a.cloneNode(!0),this._chart.controlButtonsHidden=!0,this._chart.exportButtonDisabled=!0,this._chart.autoHideInfoDisabled=!0,this._chart.modus='hold',this._chart.setAttribute('without-mixmode',!0),this._chart.set('items',a.items),!0===this._isAttached&&this._attachChartElement())}_attachChartElement(){this._chart&&(Array.prototype.forEach.call(this.$.chartContainer.children,(a)=>{this.$.chartContainer.removeChild(a)}),requestAnimationFrame(()=>{this.$.chartContainer.appendChild(this._chart),this._chart._buildLayout();const a=this._chart._svg.node().querySelector('clipPath');a.setAttribute('id','clip-export'),Array.prototype.forEach.call(this._chart._svg.node().querySelectorAll('[clip-path]'),(a)=>{a.setAttribute('clip-path','url(#clip-export)')}),setTimeout(()=>{this._styleChanged(this.backgroundColor,this.fontColor,this.lineColor,this.fontSize),this.fitInContainer()},100)}))}_detachChartElement(){!0===this._isAttached&&this._chart&&this._chart.parentElement&&this._chart.parentElement.removeChild(this._chart)}_setDimensions(a,b){if(this._chart&&!0===this._isAttached){const c=this._chart.getBoundingClientRect();'number'!==typeof a&&(a=c.height),'number'!==typeof b&&(b=c.width),0>=a||0>=b||(this._chart.style.height=a+'px',this._chart.style.width=b+'px',this._chart.sizeLayout())}}fitInContainer(){var a=Math.floor;if(this._chart&&!0===this._isAttached){const b=this.$.chartContainer.getBoundingClientRect(),c=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('padding-top')),d=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('padding-right')),e=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('padding-bottom')),f=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('padding-left')),g=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('margin-top')),h=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('margin-right')),i=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('margin-bottom')),j=parseFloat(window.getComputedStyle(this.$.chartContainer).getPropertyValue('margin-left')),k=a(b.height-g-i-c-e),l=a(b.width-h-j-d-f);0>=k||0>=l||(this.height=k,this.width=l)}}_getPPI(){let a=document.createElement('div');a.style.cssText='height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;',document.body.insertBefore(a,document.body.children[0]),this._ppiX=a.offsetWidth,this._ppiY=a.offsetHeight,a.parentElement.removeChild(a)}toggleOptions(){this._chart.toggleOptions()}toggleStyleOptions(){this.styleOptionsOpened=!this.styleOptionsOpened}_openedChanged(a){!0===a?this.open():this.close()}_nequals(c,a){return c!=a}open(){this.$.dialog.open(),this.opened=!0}close(){this.$.dialog.close(),this.opened=!1}_styleChanged(a,b,c,d){this._chart.updateStyles({"--chart-plot-background-color":a}),this._chart.updateStyles({"--chart-line-color":c}),this._chart.updateStyles({"--chart-text-color":b}),this._chart.updateStyles({"--chart-text-size":d+'px'})}_applyStyleToElement(a,b){const c=a.childNodes,d=b.childNodes,e=['svg','g'],f={rect:['fill','stroke','stroke-width'],path:['fill','stroke','stroke-width'],circle:['fill','stroke','fill-opacity','stroke-width'],line:['stroke','stroke-width'],text:['fill','font-size','font-family','letter-spacing','text-anchor','alignment-baseline','stroke','stroke-width','stroke-opacity']};for(let g=0;g<c.length;g++){const a=c[g],b=a.tagName;if(-1!==e.indexOf(b))this._applyStyleToElement(a,d[g]);else if(b in f){const c=window.getComputedStyle(d[g]);for(let d=0;d<f[b].length;d++)a.setAttribute([f[b][d]],c.getPropertyValue(f[b][d]))}}}save(){this._styleChanged(),this._setDimensions(this.height,this.width),requestAnimationFrame(()=>{const b=this._chart._svg.node().cloneNode(!0);this._applyStyleToElement(b,this._chart._svg.node()),Array.prototype.forEach.call(b.querySelectorAll('[hidden],.brush,#zoom'),(a)=>{a&&a.parentElement&&a.parentElement.removeChild(a)}),b.setAttribute('filter','url(#solid)'),b.style.margin='0px',b.style.padding='0px',b.querySelector('filter#solid feFlood').setAttribute('flood-color',this.backgroundColor),Array.prototype.forEach.call(b.querySelectorAll('.axis.main text'),(a)=>{a.setAttribute('fill',this.textColor)}),Array.prototype.forEach.call(b.querySelectorAll('.domain'),(a)=>{a.setAttribute('fill-opacity','0')}),Array.prototype.forEach.call(b.querySelectorAll('.grid line'),(a)=>{a.setAttribute('stroke-width',0.5),a.setAttribute('stroke-opacity',0.2),a.setAttribute('stroke',this.lineColor)}),Array.prototype.forEach.call(b.querySelectorAll('.axis.main line,.axis.main path'),(a)=>{a.setAttribute('stroke',this.lineColor)}),Array.prototype.forEach.call(b.querySelectorAll('*'),(a)=>{a.removeAttribute('class')});const c=new XMLSerializer().serializeToString(b),d=decodeURIComponent(location.href).replace(/ids|room|:\/\/|https|http/gi,'').replace(/[$-/:-?{-~!"^=&_`]/gi,'+').replace(/\+\+/gi,'+');let e=document.createElement('a');e.setAttribute('download',d+'.'+this.exportFormat);const a=new MouseEvent('click',{view:window,bubbles:!0,cancelable:!0});if('svg'===this.exportFormat){const b=new Blob([c],{type:'image/svg+xml;charset=utf-8}'});e.setAttribute('href',URL.createObjectURL(b));const d=!e.dispatchEvent(a);d||this.close()}else{const b=new Image,d=this.resolution;b.src='data:image/svg+xml;base64,'+window.btoa(unescape(encodeURIComponent(c))),b.onload=()=>{const c=document.createElement('canvas'),f=this._chart._svg.node().getBoundingClientRect(),g=f.height,h=f.width;c.style.width=h+'px',c.style.height=g+'px';let i=d/this._ppiX,j=d/this._ppiY;c.setAttribute('width',i*h),c.setAttribute('height',j*g);const k=c.getContext('2d');k.scale(c.width/h,c.height/g),k.drawImage(b,0,0),e.setAttribute('href',c.toDataURL('image/'+this.exportFormat,this.quality));const l=!e.dispatchEvent(a);l||this.close()}}})}}customElements.define(DialogChartExport.is,DialogChartExport);</script></dom-module><dom-module id="device-chart"><template strip-whitespace=""><style include="control-style selectbox-style button-style">:host{display:block;box-sizing:content-box;position:relative;font:inherit;color:white;letter-spacing:normal;user-select:none !important;z-index:auto;overflow:visible;transition:background 150ms linear;}:host([fullscreen]){color:var(--fullscreen-color, white);background-color:var(--fullscreen-background-color);padding-top:1em !important;padding-left:1em !important;padding-right:1em !important;padding-bottom:calc(8px + var(--icon-size, 1.5em) + 2*var(--icon-padding, 0.5em)) !important;margin:0 !important;--control-button-distance:8px !important;}:host([fullscreen]) #control{bottom:8px !important;top:auto !important;left:auto !important;right:16px !important;mix-blend-mode:normal !important;}:host(:-webkit-full-screen){color:var(--fullscreen-color, white);background-color:var(--fullscreen-background-color);height:unset;width:unset;max-height:unset !important;flex-basis:unset;}:host(:-webkit-full-screen) *{}#svg{width:100%;height:100%;font-family:inherit !important;overflow:visible;}rect#plot{fill:var(--chart-plot-background-color, #fff);stroke:currentColor;fill-opacity:var(--chart-plot-background-opacity, 0.2);stroke-opacity:0.5;stroke-width:1px;}.axis{cursor:default;pointer-events:all;font-family:inherit !important;}.axis path, .axis line{fill:currentColor;fill-opacity:0.001;stroke:currentColor;stroke-opacity:0.9;transition:fill-opacity 200ms linear;}.axis line{stroke-width:1.25px;}.axis.main line{stroke:var(--chart-line-color, currentColor);}.axis:hover path,
      .axis.dragged path{fill-opacity:0.25;}.grid .tick line{stroke:var(--chart-line-color, var(--grid-color, currentColor));stroke-opacity:0.1;stroke-width:0.75px;}.grid path{stroke-width:0;}.brush .selection{fill:currentColor;fill-opacity:0.8;stroke:currentColor;stroke-width:0;}.brush .overlay{cursor:pointer;}#graphs .area{fill-opacity:0.4;@apply --chart-area;}#graphs .area:last-of-type{fill-opacity:0.5;}#graphs .line{cursor:pointer;stroke-opacity:0.9;@apply --chart-line;}#graphs .line:last-of-type{stroke-opacity:1;}.focus,
      .delta{color:var(--chart-line-color, var(--focus-color, currentColor));}#focus *:not(.dot),
      #delta *:not(.dot){stroke:var(--chart-line-color, var(--focus-color, currentColor));stroke-opacity:var(--focus-opacity, 0.75);stroke-dasharray:1;stroke-width:1.5px;}marker path{fill:var(--chart-line-color, var(--focus-color, currentColor));}#zoom{cursor:default;fill:currentColor;fill-opacity:0.001;stroke:none;pointer-events:all;}.dot{fill-opacity:0.9;cursor:pointer;stroke:#000;stroke-opacity:0.75;stroke-width:1px;pointer-events:all;transition:fill 100ms linear;}.dot:hover{fill-opacity:1;}.selectbox > *{flex:1 0 auto;padding:0.6em 0.3em;font-size:inherit !important;}.selectbox{padding:0;}icon-button{background:rgba(255,255,255,0.0625);}.checkbox,
      .selectbox,
      .button{text-align:left;flex-shrink:0;position:relative;}#options{position:absolute;--drawer-width:12em;--drawer-background:rgba(255,255,255,0.5);--drawer-scrim-background:var(--options-scrim-background, rgba(0,0,0,0.25));--drawer-content:{padding:0;color:var(--primary-text-color);};}.options-content{display:flex;flex-direction:column;height:100%;font-size:0.8em;padding:0.75em;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;}.options-content > *{margin-bottom:0.4em;}.selectbox > select{opacity:1;}:host(:not([without-mixmode])) #delta .line,
      :host(:not([without-mixmode])) #focus .line,
      :host(:not([without-mixmode])) marker > path,
      :host(:not([without-mixmode])) .grid .tick line{mix-blend-mode:exclusion;pointer-events:none;}svg text{fill:var(--chart-text-color, var(--bright-text-color));stroke:currentColor;stroke-width:0.5px;stroke-opacity:0.2;font-size:var(--chart-text-size, 11px) !important;letter-spacing:-0.025em;font-family:inherit !important;cursor:inherit;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}svg text.info{fill:var(--primary-text-color);pointer-events:none;}.draggable{cursor:-webkit-grab;cursor:grab;}.draggable.dragged{cursor:-webkit-grabbing;cursor:grabbing;}.draggable *{cursor:inherit !important;}#legend > .entry > rect{stroke:currentColor;stroke-width:0.5px;stroke-opacity:0.5;}[hidden]{display:none !important;}</style><svg id="svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMinYMin meet" on-contextmenu="_resetZoom"><defs id="defs"><clipPath id="clip"><rect x="0" y="0"></rect></clipPath><marker id="arrowToLeft" viewBox="0 0 20 10" refX="0" refY="5" markerWidth="8" markerHeight="8" orient="auto"><path d="M 20,0 L 0,5 L 20,10 Z"></path></marker><marker id="arrowToRight" viewBox="0 0 20 10" refX="20" refY="5" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0,0 L 20,5 L 0,10 Z"></path></marker><marker id="stub" markerWidth="8" markerHeight="6" refX="6" refY="5" orient="auto" markerUnits="strokeWidth" viewBox="0 0 6 10"><path d="M 5,10 M 4,0 H 6 V 10 H 4 Z"></path><path d="M 3,5 M 0,4 H 6 V 6 H 0 Z"></path></marker><filter id="solid"><feFlood flood-color="#fff" result="out1"></feFlood><feComposite in="SourceGraphic" in2="out1" operator="over"></feComposite></filter><pattern id="circle" width="10" height="10" patternUnits="userSpaceOnUse"><circle cx="5" cy="5" r="2"></circle></pattern></defs><g id="chart"><rect id="plot" clip-path="url(#clip)"></rect><g class="grid" clip-path="url(#clip)"><g id="gridX"></g><g id="gridY"></g></g><g id="graphs" clip-path="url(#clip)"><g id="area"></g><g id="line"></g></g><rect id="zoom" x="0" y="0" clip-path="url(#clip)"></rect><g id="axis"></g><g hidden$="[[hideInfo]]"><g id="delta" hidden=""><line id="deltaX" class="line x" marker-start="url(#arrowToLeft)" marker-end="url(#arrowToRight)"></line><line id="deltaY" class="line y" marker-start="url(#arrowToLeft)" marker-end="url(#arrowToRight)"></line><circle id="deltaDot" class="dot"></circle></g><g id="focus" hidden=""><line id="focusLineX" class="line x" x1="0" marker-start="url(#stub)" marker-end="url(#arrowToRight)"></line><line id="focusLineY" class="line y" marker-start="url(#stub)" marker-end="url(#arrowToRight)"></line><circle id="focusDot" class="dot"></circle></g><g id="info"><text class="focus info" x="0" y="0" filter="url(#solid)" font-size="10" hidden=""></text><text class="delta info x" x="0" y="0" filter="url(#solid)" font-size="10" hidden=""></text><text class="delta info y" x="0" y="0" filter="url(#solid)" font-size="10" hidden=""></text></g></g><g id="legend" hidden$="[[hideLegend]]"></g></g></svg><drawer-element id="options" opened="{{showControl}}" align="right" stretch="" scrim=""><div class="options-content"><div class="selectbox" title$="[[localize('chart', 'interpolation')]]"><select value="{{interpolation::change}}"><option value="curveLinear">curveLinear</option><option value="curveBasis">curveBasis</option><option value="curveNatural">curveNatural</option><option value="curveCardinal">curveCardinal</option><option value="curveCatmullRom">curveCatmullRom</option><option value="curveStep">curveStep</option><option value="curveStepAfter">curveStepAfter</option><option value="curveStepBefore">curveStepBefore</option></select></div><div class="selectbox" title$="[[localize('chart', 'scaling', 'y')]]"><select value="{{scalingY::change}}"><option value="linear">linear</option><option value=""></option><option value="ln">ln</option><option value="log">log</option><option value="log">log</option></select></div><div class="selectbox" title$="[[localize('chart', 'modus', 'description')]]"><select value="{{modus::change}}"><option value="hold">[[localize('chart', 'modus', 'hold')]]</option><option value="zoom">[[localize('chart', 'modus', 'zoom')]]</option><option value="delta">[[localize('chart', 'modus', 'delta')]]</option></select></div><div class="checkbox"><input type="checkbox" checked="{{multiAxesX::change}}"> [[localize('chart', 'multi-axes', 'x')]]</div><div class="checkbox"><input type="checkbox" checked="{{multiAxesY::change}}"> [[localize('chart', 'multi-axes', 'y')]]</div><div class="checkbox"><input type="checkbox" checked="{{draggable::change}}"> [[localize('chart', 'draggable')]]</div><div class="checkbox"><input type="checkbox" checked="{{brushToZoom::change}}"> [[localize('chart', 'brush-to-zoom')]]</div><div class="checkbox"><input type="checkbox" checked="{{!hideInfo::change}}"> [[localize('chart', 'show-info')]]</div><div class="button" on-click="_openExportDialog" hidden$="[[exportButtonHidden]]"><iron-icon icon="file-download"></iron-icon>[[localize('chart', 'export')]]</div></div></drawer-element><div id="control" class="right bottom" hidden$="[[controlButtonsHidden]]" on-mouseenter="_debouncedHideInfo"><icon-button icon="tune" on-click="toggleOptions" title$="[[localize('options')]]"></icon-button><icon-button icon="filter-center-focus" on-click="_resetZoom" title$="[[localize('reset-zoom')]]"></icon-button><icon-button icon="[[fullscreenIcon]]" on-click="toggleFullscreen" title$="[[localize('fullscreen', fullscreen)]]"></icon-button></div><template is="dom-if" if="[[multi]]" restamp=""><template is="dom-repeat" items="[[items]]"><device-graph item="[[item]]" interpolation="[[interpolation]]" locale-date="[[localeDate]]" locale-number="[[localeNumber]]" range-x="[[rangeX]]" range-y="[[rangeY]]" no-link="[[!opened]]" scaling-y="[[scalingY]]" scaling-x="[[scalingX]]"></device-graph></template></template><template is="dom-if" if="[[!multi]]" restamp=""><device-graph item="[[item]]" interpolation="[[interpolation]]" locale-date="[[localeDate]]" locale-number="[[localeNumber]]" range-x="[[rangeX]]" range-y="[[rangeY]]" no-link="[[!opened]]" scaling-y="[[scalingY]]" scaling-x="[[scalingX]]"></device-graph></template></template><script>class DeviceChart extends Polymer.mixinBehaviors([Polymer.IronResizableBehavior],WebvisualMixins.AxesMixin(WebvisualMixins.FullscreenMixin(WebvisualMixins.LocalizeMixin(Polymer.Element)))){static get is(){return'device-chart'}static get properties(){return{opened:{type:Boolean},hasGrid:{type:Boolean,value:!0},margin:{type:Object,value:function(){return{top:10,right:5,bottom:5,left:5}}},multiAxesX:{type:Boolean,value:!1},multiAxesY:{type:Boolean,value:!0},interpolation:{type:String,value:'curveLinear',observer:'_interpolationChanged'},item:{type:Object},items:{type:Array},multi:{type:Boolean,value:!1},showControl:{type:Boolean,value:!1},hideInfo:{type:Boolean,value:!1},exportButtonHidden:{type:Boolean,value:!1},controlButtonsHidden:{type:Boolean,value:!1},autoHideInfoDisabled:{type:Boolean,value:!1},modus:{type:String,value:'delta',observer:'_modusChanged'},localesUrlPrefix:{type:Array,value:function(){return['/locales/ui/','/locales/format/']}}}}constructor(){super(),this._width=0,this._height=0,this._graphs=new Set}get _self(){return this}static get observers(){return['_localizeChanged(localize)','_multiAxesChanged(multiAxesX, multiAxesY)']}_localizeChanged(a){this.set('localeDate',a('date')),this.set('localeNumber',a('number'))}_fireResize(){this.dispatchEvent(new CustomEvent('iron-resize',{bubbles:!1,composed:!0,node:this})),this.sizeChanged()}connectedCallback(){super.connectedCallback(),this._buildLayout()}_assignNodes(){this._svg=d3.select(this.$.svg),this._chart=d3.select(this.$.chart),this._axisInsertionPoint=d3.select(this.$.axis),this._area=d3.select(this.$.area),this._line=d3.select(this.$.line),this._defs=d3.select(this.$.defs),this.gridX=d3.select(this.$.gridX),this.gridY=d3.select(this.$.gridY),this._focus=d3.select(this.$.focus),this._focusLineX=d3.select(this.$.focusLineX),this._focusLineY=d3.select(this.$.focusLineY),this._focusDot=d3.select(this.$.focusDot),this._info=this._chart.select('text.focus.info'),this._infoDeltaX=this._chart.select('text.delta.info.x'),this._infoDeltaY=this._chart.select('text.delta.info.y'),this._delta=d3.select(this.$.delta),this._deltaX=d3.select(this.$.deltaX),this._deltaY=d3.select(this.$.deltaY),this._deltaDot=d3.select(this.$.deltaDot),this._zoom=d3.select(this.$.zoom),this._legend=d3.select(this.$.legend),this._graphs.forEach((a)=>{a._assignNodes()})}_buildLayout(){this._assignNodes(),this._svg.attr('height',null).attr('width',null),this.axisX=this._computeAxisNode(this._axisInsertionPoint,this.axisOrientX,'',this.axisX).classed('main',!0).attr('hidden',!!this.multiAxesX||null),this.axisY=this._computeAxisNode(this._axisInsertionPoint,this.axisOrientY,'',this.axisY).classed('main',!0).attr('hidden',!!this.multiAxesY||null),this.axisGeneratorX=this._computeAxisGenerator(this.axisOrientX,this.scaleX,this.scalingX,this.scaleBaseX),this.axisGeneratorY=this._computeAxisGenerator(this.axisOrientY,this.scaleY,this.scalingY,this.scaleBaseY),this._focusDot.on('mouseenter',()=>{!this.autoHideInfoDisabled&&this._activeHideInfoJob&&clearTimeout(this._activeHideInfoJob)},{passive:!0}).on('mouseleave',this._debouncedHideInfo.bind(this),{passive:!0}).on('click',this._dotClicked.bind(this),{passive:!0}),this._zoomBehavior=d3.zoom().scaleExtent([0.95,Infinity]).on('zoom',this._onZoomed.bind(this)),this._zoom.call(this._zoomBehavior),this._chart.on('mouseenter touchstart',this._showInfo.bind(this),{passive:!0}).on('mouseleave touchend',this._debouncedHideInfo.bind(this),{passive:!0}).on('mousemove',()=>{if(this.hideInfo)return;if(this._showInfo(),'hold'===this.modus&&this._fixedValue)return void this._debouncedHideInfo(this);const a=d3.mouse(this._chart.node());requestAnimationFrame(()=>{let b,c,e,d;if(this._graphs.forEach((f)=>{var g=Math.pow;if(f.values&&f.values.length){const h=f._closestPoint(a),d=g(a[0]-f.scaleX(h.x),2)+g(a[1]-f.scaleY(h.y),2);(void 0===e||d<e)&&(e=d,c=h,b=f)}}),c){if(d='#fff',b.item.threshold)switch(b.checkExceedingState(c)){case 1:d=b.getComputedStyleValue('--device-state-exceeds-color')||'#F20C0C';break;case-1:d=b.getComputedStyleValue('--device-state-deceeds-color')||'#F20C0C';}this._focusedValue=c,this._focusedValue.g=b,this._focusedValue._left=this.multiAxesY?b.axisY._left:this.axisY._left,this._focusedValue._top=this.multiAxesX?b.axisX._top:this.axisX._top,this._focusDot.datum(c).attr('fill',d).attr('r',b.dotRadius),this._showInfo(),this._moveInfo(c)}else this._debouncedHideInfo()})},{passive:!0}),this._updateStyleScope(),this._isAttached=!0,this._modusChanged(this.modus),this._multiAxesChanged(this.multiAxesX,this.multiAxesY),this.sizeChanged()}reset(){this.set('item',{}),this.set('items',[]),this.set('exceeding',[]),this._graphs.clear(),this._debouncedHideInfo(),this._fixedValue=null,this._focusedValue=null}sizeChanged(){this.opened&&this._isAttached&&(this._activeSizeJob&&cancelAnimationFrame(this._activeSizeJob),this._activeSizeJob=setTimeout(()=>{this.sizeLayout()},0))}sizeLayout(){var a=Math.abs;if(!(this.opened&&this._isAttached))return;const b=this.$.svg.getBoundingClientRect();if(this._activeSizeJob&&(clearTimeout(this._activeSizeJob),this._activeSizeJob=null),0===b.height||0===b.width)return void requestAnimationFrame(()=>{this.sizeChanged()});this._debouncedHideInfo(),this._chart._top=0,this._chart._right=0,this._chart._bottom=0,this._chart._left=0;let c;const d=[],e=[];this._graphs.forEach((a)=>{if(a._isAttached&&a.scaleX&&a.scaleY){let b;a.axisX.attr('hidden')||(b=a.axisX.classed('expanded')?a.axisSizeX:a.tickSize+a.collapsedAxisMargin,d.push(this._incremAxisPosition(a.axisX,a.axisOrientX,b))),a.axisY.attr('hidden')||(b=a.axisY.classed('expanded')?a.axisSizeY:a.tickSize+a.collapsedAxisMargin,d.push(this._incremAxisPosition(a.axisY,a.axisOrientY,b)))}}),this.axisX.attr('hidden')||(c=this.axisX.classed('expanded')?this.axisSizeX:this.tickSize+this.collapsedAxisMargin,d.push(this._incremAxisPosition(this.axisX,this.axisOrientX,c))),this.axisY.attr('hidden')||(c=this.axisY.classed('expanded')?this.axisSizeY:this.tickSize+this.collapsedAxisMargin,d.push(this._incremAxisPosition(this.axisY,this.axisOrientY,c))),Promise.all(d).then(()=>{this._width=a(b.width-a(this._chart._left||0)-a(this._chart._right||0)-(this.margin.left||0)-(this.margin.right||0)),this._height=a(b.height-a(this._chart._bottom||0)-a(this._chart._top||0)-(this.margin.top||0)-(this.margin.bottom||0)),this.set('rangeX',[0,this._width]),this.set('rangeY',[this._height,0]),this._zoom.attr('height',this._height).attr('width',this._width),this._zoomBehavior.translateExtent([[0,0],[this._width,this._height]]).extent([[0,0],[this._width,this._height]]),this._graphs.forEach((a)=>{a._isAttached&&a.scaleX&&a.scaleY&&(!a.axisX.attr('hidden')&&e.push(this._finalizeAxisPosition(a.axisX,a.axisOrientX,this._width,this._height)),!a.axisY.attr('hidden')&&e.push(this._finalizeAxisPosition(a.axisY,a.axisOrientY,this._width,this._height)))}),this.axisX.attr('hidden')||e.push(this._finalizeAxisPosition(this.axisX,this.axisOrientX,this._width,this._height)),this.axisY.attr('hidden')||e.push(this._finalizeAxisPosition(this.axisY,this.axisOrientY,this._width,this._height)),Promise.all(e).then(()=>{this._svg.select('clipPath rect').transition().attr('width',this._width).attr('height',this._height),this._chart.select('rect#plot').transition().attr('width',this._width).attr('height',this._height);const a=(-this._chart._left||0)+(this.margin.left||0),b=(-this._chart._top||0)+(this.margin.top||0);this._chart.transition().attr('transform','translate('+a+','+b+')'),this._focusLineY.attr('y1',this._height),this._graphs.forEach((a)=>{a._isAttached&&a.scaleX&&a.scaleY&&(!a.axisX.attr('hidden')&&(a.axisGeneratorX=a._computeAxisGenerator.call(a,a.axisOrientX,a.scaleX,a.scalingX,a.scaleBaseX).ticks(a.ticksX).tickSize(a.tickSize).tickFormat(a.axisX.classed('expanded')?a._computeFormatFn(a.scalingX,a.scaleBaseX):''),a._updateAxisBrushGenerator.call(a.axisBrushGeneratorX,this.rangeX,a.axisOrientX),this.brushToZoom&&a.axisX.select('.brush').raise().call(a.axisBrushGeneratorX),a.axisX.attr('transform','translate('+(a.axisX._left||0)+','+(a.axisX._top||0)+')')),!a.axisY.attr('hidden')&&(a.axisGeneratorY=a._computeAxisGenerator.call(a,a.axisOrientY,a.scaleY,a.scalingY,a.scaleBaseY).ticks(a.ticksY).tickSize(a.tickSize).tickFormat(a.axisY.classed('expanded')?a._computeFormatFn(a.scalingY,a.scaleBaseY):''),a._updateAxisBrushGenerator.call(a.axisBrushGeneratorY,this.rangeY,a.axisOrientY),this.brushToZoom&&a.axisY.select('.brush').raise().call(a.axisBrushGeneratorY),a.axisY.attr('transform','translate('+(a.axisY._left||0)+','+(a.axisY._top||0)+')')))}),!this.axisX.attr('hidden')&&this.scaleX&&(this.axisGeneratorX=this._computeAxisGenerator(this.axisOrientX,this.scaleX,this.scalingX,this.scaleBaseX).ticks(this.ticksX).tickSize(this.tickSize).tickFormat(this.axisX.classed('expanded')?this._computeFormatFn(this.scalingX,this.scaleBaseX):''),this._updateAxisBrushGenerator.call(this.axisBrushGeneratorX,this.rangeX,this.axisOrientX),this.brushToZoom&&this.axisX.select('.brush').raise().call(this.axisBrushGeneratorX),this.axisX.attr('transform','translate('+(this.axisX._left||0)+','+(this.axisX._top||0)+')')),!this.axisY.attr('hidden')&&this.scaleY&&(this.axisGeneratorY=this._computeAxisGenerator(this.axisOrientY,this.scaleY,this.scalingY,this.scaleBaseY).ticks(this.ticksY).tickSize(this.tickSize).tickFormat(this.axisY.classed('expanded')?this._computeFormatFn(this.scalingY,this.scaleBaseY):''),this._updateAxisBrushGenerator.call(this.axisBrushGeneratorY,this.rangeY,this.axisOrientY),this.brushToZoom&&this.axisY.select('.brush').raise().call(this.axisBrushGeneratorY),this.axisY.attr('transform','translate('+(this.axisY._left||0)+','+(this.axisY._top||0)+')')),this._updateStyleScope(),!this.domainX||!this.domainY||this.domainX.some((a)=>void 0===a||null===a)||this.domainY.some((a)=>void 0===a||null===a)?this.redraw(!0):this.redraw()})})}_incremAxisPosition(a,b,c){return'left'===b?(a._left=this._chart._left,a._right=0,this._chart._left-=c):'right'===b?(a._left=0,a._right=this._chart._right,this._chart._right+=c):(a._left=0,a._right=0),'top'===b?(a._bottom=0,a._top=this._chart._top,this._chart._top-=c):'bottom'===b?(a._bottom=this._chart._bottom,a._top=0,this._chart._bottom+=c):(a._bottom=0,a._top=0),!0}_finalizeAxisPosition(a,b,c,d){return a._left+=a._right,a._top+=a._bottom,a._bottom=0,a._right=0,'right'===b?a._left+=c:'bottom'===b&&(a._top+=d),!0}_generateGrid(){this.scaleX&&this.scaleY&&(this._gridBuildJob&&clearTimeout(this._gridBuildJob),this._gridBuildJob=setTimeout(()=>{this.hasGrid&&(!this.multiAxesY||1>=this._graphs.size)?(this.gridGeneratorY=d3.axisLeft(this.scaleY).ticks(2*this.ticksY||10).tickSize(-this._width).tickFormat(''),this.gridY.call(this.gridGeneratorY).attr('font-family',null).attr('font-size',null).attr('text-anchor',null),this.gridY.attr('hidden',null)):this.gridY.attr('hidden',!0),this.hasGrid&&(!this.multiAxesX||1>=this._graphs.size)?(this.gridGeneratorX=d3.axisBottom(this.scaleX).ticks(2*this.ticksX||10).tickSize(this._height).tickFormat(''),this.gridX.call(this.gridGeneratorX).attr('font-family',null).attr('font-size',null).attr('text-anchor',null),this.gridX.attr('hidden',null),this.gridX.call(this.gridGeneratorX.scale(this.scaleX))):this.gridX.attr('hidden',!0),this._gridBuildJob=null},0))}_redomain(){this._isAttached&&(this._activeRedrawJob&&clearTimeout(this._activeRedrawJob),Promise.resolve(this._getDomain.call(this)).then(this.redraw.bind(this,!1)).catch((a)=>{a&&console.warn(a)}))}redraw(a){return this._isAttached&&this.scaleX&&this.scaleY?a?void this._redomain():void(this._activeRedrawJob&&clearTimeout(this._activeRedrawJob),this._activeRedrawJob=setTimeout(()=>{this.axisX.attr('hidden')||this.axisX.transition().call(this.axisGeneratorX).attr('transform','translate('+(this.axisX._left||0)+','+(this.axisX._top||0)+')'),this.axisY.attr('hidden')||this.axisY.transition().call(this.axisGeneratorY).attr('transform','translate('+(this.axisY._left||0)+','+(this.axisY._top||0)+')'),this._graphs.forEach((a)=>{a._isAttached&&a.scaleX&&a.scaleY&&(a.axisX.attr('hidden')?a.set('domainX',this.domainX):a.axisX.transition().call(a.axisGeneratorX).attr('transform','translate('+(a.axisX._left||0)+','+(a.axisX._top||0)+')'),a.axisY.attr('hidden')?a.set('domainY',this.domainY):a.axisY.transition().call(a.axisGeneratorY).attr('transform','translate('+(a.axisY._left||0)+','+(a.axisY._top||0)+')'),a.redraw())}),this.hasGrid&&this._generateGrid(),this._updateStyleScope(),this._updateInfo()},0)):void 0}_updateStyleScope(){this._svg.selectAll('g,line,text,path,rect,circle').classed('style-scope device-chart',!0)}_multiAxesChanged(a,b){if(!this._isAttached)return;let c;this._graphs.forEach((d)=>{d._isAttached&&(c=!a||null,d.axisX.attr('hidden',c),c=!b||null,d.axisY.attr('hidden',c))}),c=!!a||null,this.axisX.attr('hidden',c),c=!!b||null,this.axisY.attr('hidden',c),c=b||a?null:!0,this.axisX.select('.brush').attr('hidden',c),this.axisY.select('.brush').attr('hidden',c),this._generateGrid(),this._redomain(),this.sizeChanged()}_addGraph(a){this._graphs.has(a)||(this._graphs.add(a),console.log('add',a.item.mount,this._graphs.size),this._updateLegendEntries(),this.sizeChanged())}_removeGraph(a){this._graphs.delete(a),console.log('remove',a.item.mount,this._graphs.size),0===this._graphs.size&&(this.set('domainX',[null,null]),this.set('domainY',[null,null])),a=null,this._fixedValue=null,this._focusedValue=null,this._updateLegendEntries(),this.sizeChanged()}_updateLegendEntries(){const a=[];this._graphs.forEach((b)=>{a.push(b.item)}),console.log(a),a.sort((c,a)=>{c.mount.localeCompare(a.mount)});const b=18,c=4,d=2,e=this._legend.selectAll('.entries').data(a),f=e.enter().append('g').classed('entry',!0).attr('transform',function(a,d){return`translate(0, ${d*(b+c)})`});f.append('rect').attr('height',b).attr('width',b).attr('rx',d).attr('ry',d).attr('fill',(a)=>a.color||'#fff'),f.append('text').attr('x',b+c).attr('y',b-c).text((a)=>a.mount),e.exit().remove(),this._updateStyleScope()}_getDomain(){return new Promise((a,b)=>{const c=[],d=[];this._graphs.forEach((a)=>{c.push(a._getDomain('x',this.multiAxesX)),d.push(a._getDomain('y',this.multiAxesY))}),Promise.all(c).then((c)=>{let e,f,h;for(let a=0;a<c.length;a++)e=void 0===e||e>c[a].domain[0]?c[a].domain[0]:e,f=void 0===f||f<c[a].domain[1]?c[a].domain[1]:f;(e===void 0||f===void 0)&&a(),h=[e,f],this.set('domainX',h),this.scaleX.domain(h),!1===this.multiAxesX&&this._graphs.forEach((a)=>{a.axisX._isBrushed=!1,a.set('domainX',h),a.scaleX.domain(h)}),Promise.all(d).then((b)=>{let c,d,e;for(let a=0;a<b.length;a++)c=void 0===c||c>b[a].domain[0]?b[a].domain[0]:c,d=void 0===d||d<b[a].domain[1]?b[a].domain[1]:d;(c===void 0||d===void 0)&&a(),e=[c,d],this.set('domainY',e),!1===this.multiAxesY&&this._graphs.forEach((a)=>{a.axisY._isBrushed=!1,a.set('domainY',e)}),a()}).catch((a)=>{b(a)})}).catch((a)=>{b(a)})})}insertValues(a){this._graphs.forEach((b)=>{b&&b._isAttached&&b.item&&b.item.mount&&a[b.item.mount]&&b.insertValues(a[b.item.mount])})}clearValues(){this._graphs.forEach((a)=>{a&&a._isAttached&&a.clearValues()})}_draggableChanged(a){super._draggableChanged(a),this._graphs.forEach((b)=>{b.draggable=a})}_brushToZoomChanged(a){super._brushToZoomChanged(a),this._graphs.forEach((b)=>{b.brushToZoom=a})}_moveInfo(a){var b=Math.abs;if(Number.isFinite(a.g.scaleY(a.y))){const c=this._computeFormatFn.call(a.g,a.g.scalingX,a.g.scaleBaseX),d=this._computeFormatFn.call(a.g,a.g.scalingY,a.g.scaleBaseY),e=this._fixedValue;if(this._info.text(c(a.x)+' '+d(a.y)+'\u205F'+(a.g.item.unit||'')),'delta'===this.modus&&e){const f=b(e.x-a.x),g=b(e.y-a.y),h=a.g.item.unit===e.g.item.unit;this._infoDeltaX.text(('time'===a.g.scalingX?a.g.formatTimeAbsolute:c)(f)+(h&&'time'!==a.g.scalingX?'\u205F'+a.g.item.unit:'')),this._infoDeltaY.text(('time'===a.g.scalingY?a.g.formatTimeAbsolute:d)(g)+(h&&'time'!==a.g.scalingY?'\u205F'+a.g.item.unit:''))}this._updateInfo()}}_showInfo(){this.hideInfo||(!this.autoHideInfoDisabled&&this._activeHideInfoJob&&clearTimeout(this._activeHideInfoJob),0===this._graphs.size||(this._info.attr('hidden',null),this._focus.attr('hidden',null),'delta'===this.modus&&this._fixedValue&&this._showDelta()))}_showDelta(){this._infoDeltaX.attr('hidden',null),this._infoDeltaY.attr('hidden',null),this._delta.attr('hidden',null)}_debouncedHideInfo(){this.autoHideInfoDisabled||(this._activeHideInfoJob&&clearTimeout(this._activeHideInfoJob),this._activeHideInfoJob=setTimeout(()=>{this._hideInfo(),this._activeHideInfoJob=null},750))}_hideInfo(){this._info.attr('hidden',''),this._focus.attr('hidden',''),this._hideDelta(),this._updateStyleScope()}_hideDelta(){this._infoDeltaX.attr('hidden',''),this._infoDeltaY.attr('hidden',''),this._delta.attr('hidden','')}_updateInfo(){if(!this._focusedValue||''===this._info.attr('hidden'))return;const a=this._focusedValue,b=this._fixedValue;let c,d,e,f;if(a)c=a.g.scaleX(+a.x),d=a.g.scaleY(+a.y),e=a._left,f=a._top;else if(b)c=b.g.scaleX(+a.x),d=b.g.scaleY(+a.y),e=b._left,f=b._top;else return;if(this._alignText(this._info.node(),c,d,null,1.5*this._focusDot.attr('r')),this._focusLineX.attr('x1',e).attr('x2',c).attr('y2',d).attr('y1',d),this._focusLineY.attr('y1',f).attr('y2',d).attr('x2',c).attr('x1',c),this._focusDot.attr('cy',d).attr('cx',c),'delta'===this.modus)if(b&&void 0!==b.x&&void 0!==b.y&&(a.x!==b.x||a.y!==b.y)){const a=b.g.scaleX(+b.x),e=b.g.scaleY(+b.y);this._deltaX.attr('x1',c).attr('x2',a),this._deltaY.attr('y1',d).attr('y2',e),e<d?(this._deltaY.attr('x1',c).attr('x2',c),this._alignText(this._infoDeltaY.node(),c,(e+d)/2,null,null,null,'middle')):(this._deltaY.attr('x1',a).attr('x2',a),this._alignText(this._infoDeltaY.node(),a,(e+d)/2,null,null,null,'middle')),e<d||a<c?(this._deltaX.attr('y1',e).attr('y2',e),this._alignText(this._infoDeltaX.node(),(a+c)/2,e,null,null,null,'middle')):(this._deltaX.attr('y1',d).attr('y2',d),this._alignText(this._infoDeltaX.node(),(a+c)/2,d,null,null,null,'middle')),this._deltaDot.attr('cy',e).attr('cx',a)}else this._hideDelta();d>this._height||0>c?(this._focus.attr('hidden',''),'delta'===this.modus&&b&&this._delta.attr('hidden','')):(this._focus.attr('hidden',null),'delta'===this.modus&&b&&this._delta.attr('hidden',null))}_alignText(a,b,c,d,e,f,g){d=d||0,e=e||0;const h=a.getBBox(),i=this._height,j=this._width;let k=f||'middle',l=g||'ideographic',m=d,n=e;'middle'===k?m+=h.width/2:'end '===k?m+=h.width:void 0;'ideographic'===l?n+=h.height:'middle'===l?n+=h.height/2:'hanging'===l?n-=h.height:void 0;0>=c-n?(l='hanging',c=h.height):c+n>i&&(l='ideographic',c=i),b+m>=j?(k='end',b=j):0>=b-m&&(k='start',b=0),a.setAttribute('x',b+d),a.setAttribute('y',c-e),a.setAttribute('text-anchor',k),a.setAttribute('alignment-baseline',l)}_modusChanged(a){switch(a){case'zoom':break;case'delta':break;case'integral':break;default:}this._fixedValue=null,this._focusedValue=null}_dotClicked(a){const b=this._zoom.node().__zoom,c=this._fixedValue;let d,e,f,g;switch(this.modus){case'hold':if(!(c&&void 0!==c.x&&void 0!==c.y&&c.x===a.x&&c.y===a.y)){if(this._fixedValue=a,g='hold'===this.modus&&a.g.item.color?a.g.item.color:'#fff',console.log(g),a.g.item.threshold)switch(a.g.checkExceedingState(a)){case 1:g=a.g.getComputedStyleValue('--device-state-exceeds-color')||'#F20C0C';break;case-1:g=a.g.getComputedStyleValue('--device-state-deceeds-color')||'#F20C0C';}this._focusDot.attr('fill',g)}else this._fixedValue=null,this._focusDot.attr('fill','#fff'),this._hideInfo();break;case'zoom':d=a.g.scaleX(+a.x)-this._width/6,e=(a.g.scaleY(+a.y)||0)-this._height/6,f=3*b.k,e=(b.y-e)/b.k,d=(b.x-d)/b.k,this._zoom.transition(300).call(this._zoomBehavior.transform,d3.zoomIdentity.scale(f).translate(d,e));break;case'delta':c&&c.x!==void 0&&c.y!==void 0&&c.x===a.x&&c.y===a.y?(this._fixedValue=null,this._hideDelta(),this._deltaDot.attr('fill','#fff')):(this._fixedValue=a,this._deltaDot.datum(a).attr('cx',(a)=>a.g.scaleX(a.x)).attr('cy',(a)=>a.g.scaleY(a.y)).attr('r',this._focusDot.attr('r')).attr('fill',this._focusDot.attr('fill')));}this._updateInfo()}closeMenu(){this.showMenu=!1}_interpolationChanged(a){this._graphs.forEach((b)=>{b&&b._isAttached&&b.set('interpolation',a)}),this.redraw()}_onAxisBrushEnd(a){if(d3.event.sourceEvent&&'zoom'===d3.event.sourceEvent.type)return;const b=d3.event.selection;if(!b)return;if(!this.multiAxesY&&!this.multiAxesX)return'x'===a&&this.axisX.select('.brush').call(this.axisBrushGeneratorX.move,null),void('y'===a&&this.axisY.select('.brush').call(this.axisBrushGeneratorY.move,null));const c='y'===a;let d,e,f,g,h;c&&(d=b.map(this.scaleY.invert,this.scaleY).sort((c,a)=>c>a),this._graphs.forEach((a)=>{a.scaleY.domain(d).nice(),a.axisGeneratorY.scale(a.scaleY)}),this.axisY._isBrushed=!0,this.scaleY.domain(d).nice(),this.axisY.call(this.axisGeneratorY.scale(this.scaleY)),this.axisY.select('.brush').call(this.axisBrushGeneratorY.move,null),e=this._zoom.node().__zoom,f=e.k*this._height/(b[1]-b[0]),g=(e.y-b[0])/e.k,this._zoom.transition(300).call(this._zoomBehavior.transform,d3.zoomIdentity.scale(f).translate(0,g))),c||(d=b.map(this.scaleX.invert,this.scaleX).sort((c,a)=>c>a),this._graphs.forEach((a)=>{a.scaleX.domain(d),a.axisGeneratorX.scale(a.scaleX)}),this.axisX._isBrushed=!0,this.scaleX.domain(d),this.axisX.call(this.axisGeneratorX.scale(this.scaleX)),this.axisX.select('.brush').call(this.axisBrushGeneratorX.move,null),e=this._zoom.node().__zoom,f=e.k*this._width/(b[1]-b[0]),h=(e.x-b[0])/e.k,this._zoom.transition(300).call(this._zoomBehavior.transform,d3.zoomIdentity.scale(f).translate(h,0))),this._graphs.forEach((a)=>{a.redraw()}),this._updateInfo()}_onZoomed(){if(d3.event.sourceEvent&&'brush'===d3.event.sourceEvent.type)return;const a=d3.event.transform;if(!this.domainX||!this.domainY)return;const b=d3.event.transform.rescaleX(this.scaleX.domain(this.domainX)),c=d3.event.transform.rescaleY(this.scaleY.domain(this.domainY).nice());let d;this.multiAxesX||(d=b.domain(),this._graphs.forEach((a)=>{a._isAttached&&a.scaleX&&a.scaleY&&(a.scaleX.domain(d),a.axisGeneratorX.scale(a.scaleX))}),this.scaleX.domain(d),this.axisX.call(this.axisGeneratorX.scale(this.scaleX)),this.hasGrid&&this.gridX.call(this.gridGeneratorX.scale(this.scaleX))),this.multiAxesY||(d=c.domain(),this._graphs.forEach((a)=>{a._isAttached&&a.scaleX&&a.scaleY&&(a.scaleY.domain(d),a.axisGeneratorY.scale(a.scaleY))}),this.scaleY.domain(d),this.axisY.call(this.axisGeneratorY.scale(this.scaleY)),this.hasGrid&&this.gridY.call(this.gridGeneratorY.scale(this.scaleY))),this._graphs.forEach((a)=>{a.redraw()}),this._isZoomed=1!==a.k||0!==a.x||0!==a.y,this._updateInfo()}_onAxisClicked(a){return this._activeToggleAxisJob?(clearTimeout(this._activeToggleAxisJob),this._activeToggleAxisJob=null,void((a._isBrushed||this._isZoomed)&&this._resetZoom())):void super._onAxisClicked(a)}_onAxisContextMenu(a){d3.event&&d3.event.preventDefault(),this._isZoomed?this._resetZoom():super._onAxisContextMenu(a),this._debouncedHideInfo()}toggleOptions(){this.showControl=!this.showControl}_resetZoom(a){d3.event?d3.event.preventDefault():a&&a.preventDefault&&a.preventDefault(),this.showControl=!1,this._isZoomed=!1,this._fixedValue=null,this._focusedValue=null,this._zoom.transition(300).call(this._zoomBehavior.transform,d3.zoomIdentity.scale(1)),this.axisX._isBrushed=!1,this.axisY._isBrushed=!1,this._graphs.forEach((a)=>{a._isAttached&&a.scaleX&&a.scaleY&&(a.axisX._isBrushed=!1,a.axisY._isBrushed=!1,a.domainX&&a.domainX.some((a)=>void 0===a||null===a)&&a.scaleX.domain(a.domainX),a.domainY&&a.domainY.some((a)=>void 0===a||null===a)&&a.scaleY.domain(a.domainY).nice(),a.axisX.transition().call(a.axisGeneratorX.scale(a.scaleX)),a.axisY.transition().call(a.axisGeneratorY.scale(a.scaleY)))}),this.autoHideInfoDisabled||this._hideInfo(),this._redomain()}_openExportDialog(){if(this._isFullscreen()&&this.exitFullscreen(),!window._exportChartDialog){const a=customElements.get('dialog-chart-export');window._exportChartDialog=new a(this),document.body.appendChild(window._exportChartDialog)}else window._exportChartDialog.setChartElement(this);window._exportChartDialog.open()}}customElements.define(DeviceChart.is,DeviceChart);</script></dom-module></div></body></html>