(function(a,b){'object'===('undefined'===typeof exports?'undefined':babelHelpers.typeof(exports))&&'undefined'!==typeof module?module.exports=b():'function'===typeof define&&define.amd?define(b):a.ES6Promise=b()})(this,function(){'use strict';function a(a){var b='undefined'===typeof a?'undefined':babelHelpers.typeof(a);return null!==a&&('object'===b||'function'===b)}function b(a){return'function'===typeof a}function c(){return'undefined'===typeof E?d():function(){E(e)}}function d(){var a=setTimeout;return function(){return a(e,1)}}function e(){for(var a=0;a<I;a+=2){var b=P[a],c=P[a+1];b(c),P[a]=void 0,P[a+1]=void 0}I=0}function f(a,b){var c=this,d=new this.constructor(h);void 0===d[R]&&z(d);var e=c._state;if(e){var f=arguments[e-1];J(function(){return w(e,d,f,c._result)})}else t(c,d,a,b);return d}function g(a){var b=this;if(a&&'object'===('undefined'===typeof a?'undefined':babelHelpers.typeof(a))&&a.constructor===b)return a;var c=new b(h);return p(c,a),c}function h(){}function i(){return new TypeError('You cannot resolve a promise with itself')}function j(){return new TypeError('A promises callback cannot return that same promise.')}function k(a){try{return a.then}catch(a){return U.error=a,U}}function l(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function m(a,b,c){J(function(a){var d=!1,e=l(c,b,function(c){d||(d=!0,b===c?r(a,c):p(a,c))},function(b){d||(d=!0,s(a,b))},'Settle: '+(a._label||' unknown promise'));!d&&e&&(d=!0,s(a,e))},a)}function n(a,b){b._state===S?r(a,b._result):b._state===T?s(a,b._result):t(b,void 0,function(b){return p(a,b)},function(b){return s(a,b)})}function o(a,c,d){c.constructor===a.constructor&&d===f&&c.constructor.resolve===g?n(a,c):d===U?(s(a,U.error),U.error=null):void 0===d?r(a,c):b(d)?m(a,c,d):r(a,c)}function p(b,c){b===c?s(b,i()):a(c)?o(b,c,k(c)):r(b,c)}function q(a){a._onerror&&a._onerror(a._result),u(a)}function r(a,b){a._state!==Q||(a._result=b,a._state=S,0!==a._subscribers.length&&J(u,a))}function s(a,b){a._state!==Q||(a._state=T,a._result=b,J(q,a))}function t(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+S]=c,e[f+T]=d,0===f&&a._state&&J(u,a)}function u(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?w(c,d,e,f):e(f);a._subscribers.length=0}}function v(a,b){try{return a(b)}catch(a){return U.error=a,U}}function w(a,c,d,e){var f,g,h,i,k=b(d);if(!k)f=e,h=!0;else if(f=v(d,e),f===U?(i=!0,g=f.error,f.error=null):h=!0,c===f)return void s(c,j());c._state!==Q||(k&&h?p(c,f):i?s(c,g):a===S?r(c,f):a===T&&s(c,f))}function x(a,b){try{b(function(b){p(a,b)},function(b){s(a,b)})}catch(b){s(a,b)}}function y(){return V++}function z(a){a[R]=V++,a._state=void 0,a._result=void 0,a._subscribers=[]}function A(){return new Error('Array Methods must be provided an Array')}function B(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor')}function C(){throw new TypeError('Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.')}var D=Array.isArray?Array.isArray:function(a){return'[object Array]'===Object.prototype.toString.call(a)};var E,F,G,H=D,I=0,J=function(a,b){P[I]=a,P[I+1]=b,I+=2,2===I&&(F?F(e):G())},K='undefined'===typeof window?void 0:window,L=K||{},M=L.MutationObserver||L.WebKitMutationObserver,N='undefined'===typeof self&&'undefined'!==typeof process&&'[object process]'==={}.toString.call(process),O='undefined'!==typeof Uint8ClampedArray&&'undefined'!==typeof importScripts&&'undefined'!==typeof MessageChannel,P=Array(1e3);G=N?function(){return function(){return process.nextTick(e)}}():M?function(){var a=0,b=new M(e),c=document.createTextNode('');return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}():O?function(){var a=new MessageChannel;return a.port1.onmessage=e,function(){return a.port2.postMessage(0)}}():void 0===K&&'function'===typeof require?function(){try{var a=Function('return this')().require('vertx');return E=a.runOnLoop||a.runOnContext,c()}catch(a){return d()}}():d();var Q,R=Math.random().toString(36).substring(2),S=1,T=2,U={error:null},V=0,W=function(){function a(a,b){this._instanceConstructor=a,this.promise=new a(h),this.promise[R]||z(this.promise),H(b)?(this.length=b.length,this._remaining=b.length,this._result=Array(this.length),0===this.length?r(this.promise,this._result):(this.length=this.length||0,this._enumerate(b),0===this._remaining&&r(this.promise,this._result))):s(this.promise,A())}return a.prototype._enumerate=function(a){for(var b=0;this._state===Q&&b<a.length;b++)this._eachEntry(a[b],b)},a.prototype._eachEntry=function(a,b){var d=this._instanceConstructor,c=d.resolve;if(c===g){var e=k(a);if(e===f&&a._state!==Q)this._settledAt(a._state,b,a._result);else if('function'!==typeof e)this._remaining--,this._result[b]=a;else if(d===X){var i=new d(h);o(i,a,e),this._willSettleAt(i,b)}else this._willSettleAt(new d(function(b){return b(a)}),b)}else this._willSettleAt(c(a),b)},a.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===Q&&(this._remaining--,a===T?s(d,c):this._result[b]=c),0===this._remaining&&r(d,this._result)},a.prototype._willSettleAt=function(a,b){var c=this;t(a,void 0,function(a){return c._settledAt(S,b,a)},function(a){return c._settledAt(T,b,a)})},a}(),X=function(){function a(b){this[R]=y(),this._result=this._state=void 0,this._subscribers=[],h!==b&&('function'!==typeof b&&B(),this instanceof a?x(this,b):C())}return a.prototype.catch=function(a){return this.then(null,a)},a.prototype.finally=function(a){var b=this,c=b.constructor;return b.then(function(b){return c.resolve(a()).then(function(){return b})},function(b){return c.resolve(a()).then(function(){throw b})})},a}();return X.prototype.then=f,X.all=function(a){return new W(this,a).promise},X.race=function(a){var b=this;return H(a)?new b(function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}):new b(function(a,b){return b(new TypeError('You must pass an array to race.'))})},X.resolve=g,X.reject=function(a){var b=this,c=new b(h);return s(c,a),c},X._setScheduler=function(a){F=a},X._setAsap=function(a){J=a},X._asap=J,X.polyfill=function(){var a;if('undefined'!==typeof global)a=global;else if('undefined'!==typeof self)a=self;else try{a=Function('return this')()}catch(a){throw new Error('polyfill failed because global object is unavailable in this environment')}var b=a.Promise;if(b){var c=null;try{c=Object.prototype.toString.call(b.resolve())}catch(a){}if('[object Promise]'===c&&!b.cast)return}a.Promise=X},X.Promise=X,X});