importScripts('/scripts/idb.js'),self&&!(self.Promise&&self.Promise.all)&&importScripts('/bower_components/es6-promise/es6-promise.auto.min.js'),function(){function a(a,b,c){this.mount=a,this.indexKey=b,this.options=c,this.dbPromise=idb.open(a,1,function(a){a.createObjectStore(this.indexKey,this.options)}.bind(this))}a.prototype={get:function(a,b,c,d){return this.dbPromise.then(function(e){var f=Number.isFinite,g=e.transaction(this.indexKey),h=[],i=g.objectStore(this.indexKey),j=null;return f(a)&&f(b)&&(j=IDBKeyRange.bound(a,b)),i.iterateCursor.call(i,j,d||'next',function(a){!a||h.length>=c||(h.push(a.value),a.continue())}),g.complete.then(function(){var a={};return a[this.mount]=h,a}.bind(this))}.bind(this)).catch(function(a){console.log(a);var b={};return b[this.mount]=[],b})},set:function(a){return this.dbPromise.then(function(b){for(var c=b.transaction(this.indexKey,'readwrite'),d=a.length-1;0<=d;d--)c.objectStore(this.indexKey).put(a[d],a[d][this.indexKey]);return c.complete}.bind(this)).catch(function(a){return console.log(a,a.name),{}})},last:function(a,b,c){return this.get(a,b,c||1,'prev')},first:function(a,b,c){return this.get(a,b,c||1)},range:function(){return new Promise(function(a,b){var c=[null,null];this.first(null,null,1).then(function(d){c[0]=d[this.mount][0][this.indexKey],this.last(null,null,1).then(function(b){c[1]=b[this.mount][0][this.indexKey],a(c)}.bind(this)).catch(b)}.bind(this)).catch(b)}.bind(this))},delete:function(a){return this.dbPromise.then(function(b){for(var c=b.transaction(this.indexKey,'readwrite'),d=a.length-1;0<=d;d--)void 0!==a[d][this.indexKey]&&c.objectStore(this.indexKey).delete(a[d][this.indexKey]);return c.complete}.bind(this)).catch(function(a){return console.log(a,a.name),{}})},clear:function(){return this.dbPromise.then(function(a){var b=a.transaction(this.indexKey,'readwrite');return b.objectStore(this.indexKey).clear(),b.complete}.bind(this)).catch(function(a){return console.log(a),{}})},getAll:function(){return this.dbPromise.then(function(a){var b=a.transaction(this.indexKey),c=b.objectStore(this.indexKey),d={};d[this.mount]=[];var e=[];return c.getAll().then(function(a){e=a}),b.complete.then(function(){return d[this.mount]=e,d}.bind(this))}.bind(this)).catch(function(a){console.log(a);var b={};return b[this.mount]=[],b})},getAllKeys:function(){return this.dbPromise.then(function(a){var b=a.transaction(this.indexKey),c=[],d=b.objectStore(this.indexKey);return(d.iterateKeyCursor||d.iterateCursor).call(d,function(a){a&&(c.push(a.key),a.continue())}),b.complete.then(function(){var a={};return a[this.mount]=c,a}.bind(this))}.bind(this)).catch(function(a){console.log(a);var b={};return b[this.mount]=[],b})}},self?self.ClientDatabase=a:window&&(window.ClientDatabase=a)}();