<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="neon-shared-element-animation-behavior.html">

<dom-module id="neon-shared-animatable">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <content></content>
  </template>

</dom-module>

<script>

  Polymer({

    is: 'neon-shared-animatable',

    behaviors: [
      Polymer.NeonSharedElementAnimationBehavior,
      Polymer.IronResizableBehavior
    ],

    properties: {

      animations: {
        type: Object,
        value: function() {
          return {}
        },
        reflectToAttribute: true,
        observer: 'checkConfig'
      },

      shared: {
        type: Object,
        value: function() {
          return {}
        },
        observer: 'checkShared'
      }
    },

    checkConfig: function() {
      // Those changes should not be notified by this observer (callstack overflow)
      console.log(this.animations);
      for (var alias in this.animations) {
        if (this.animations[alias].id) {
          if (this.animations[alias].fromPage) {
            this.set('animationConfig.'+alias+'.fromPage', this);
          }
          if (this.animations[alias].toPage) {
            this.set('animationConfig.'+alias+'.toPage', this);
          }
        }
      }
    },

    checkShared: function() {
      // Those changes should not be notified by this observer (callstack overflow)
      for (var id in this.shared) {
        this.set('sharedElements.'+id, this.queryEffectiveChildren(this.shared[id]));
      }
    }

  });

</script>
